require.config({paths:{jquery:"../lib/jquery",bootstrap:"../lib/bootstrap.min",app:"../common/app",inp:"../account/inp"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"},inp:{deps:["jquery"],exports:"inp"}}}),require(["jquery","app","inp","bootstrap"],function(e,r,t){function a(e){var r={isTrue:!1,year:null,month:null,day:null,isMale:!1,isFemale:!1};if(!e&&15!=e.length&&18!=e.length)return r.isTrue=!1,r;if(15==e.length){var t=e.substring(6,8),a=e.substring(8,10),i=e.substring(10,12),n=e.substring(14,15),s=new Date(t,parseFloat(a)-1,parseFloat(i));return s.getYear()!=parseFloat(t)||s.getMonth()!=parseFloat(a)-1||s.getDate()!=parseFloat(i)?r.isTrue=!1:(r.isTrue=!0,r.year=s.getFullYear(),r.month=s.getMonth()+1,r.day=s.getDate(),n%2==0?(r.isFemale=!0,r.isMale=!1):(r.isFemale=!1,r.isMale=!0)),r}if(18==e.length){var t=e.substring(6,10),a=e.substring(10,12),i=e.substring(12,14),n=e.substring(14,17),s=new Date(t,parseFloat(a)-1,parseFloat(i));if(s.getFullYear()!=parseFloat(t)||s.getMonth()!=parseFloat(a)-1||s.getDate()!=parseFloat(i))return r.isTrue=!1,r;var o=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1],u=[1,0,10,9,8,7,6,5,4,3,2],l=0,d=e.split("");"x"==d[17].toLowerCase()&&(d[17]=10);for(var p=0;17>p;p++)l+=o[p]*d[p];var p=l%11;return d[17]!=u[p]?(r.isTrue=!1,r):(r.isTrue=!0,r.year=s.getFullYear(),r.month=s.getMonth()+1,r.day=s.getDate(),n%2==0?(r.isFemale=!0,r.isMale=!1):(r.isFemale=!1,r.isMale=!0),r)}return r}function i(e){var r=new RegExp(/^[\u4E00-\u9FA5]+$/i);return r.test(e)}t.init({parentClass:".form-group",onBlur:function(){var r=this,n=e.trim(e("#number").val()),s=e.trim(e("#confirm-number").val());if(0==r.method&&(i(r.val)?r.successShow():r.errorShow()),1==r.method){var o=r.val,u=a(o);if(u.isTrue){var l=(new Date).getTime(),d=new Date(u.year+"-"+u.month+"-"+u.day).getTime(),p=(l-d)/1e3/31558150;18>p?r.errorShow():r.successShow()}else r.errorShow()}if(2==r.method){if(""==s)return void r.hideAllTips();n!==s?r.errorShow():r.successShow()}3==r.method&&(t.regGroup.pwd.test(r.val)?r.successShow():r.errorShow())}}),e("#j-bind-sub").on("click",function(n){n.preventDefault();var s=e("#username").val(),o=e("#number").val(),u=e("#confirm-number").val(),l=e("#password").val(),d=a(o),p={userName:!0,identityCardNo:!0,identityCardNo18:!0,pwd:!0,ckPwd:!0},m={userName:"username",identityCardNo:"number",identityCardNo18:"",ckPwd:"confirm-number",pwd:"password"};if(i(s)||(p.userName=!1),d.isTrue){var c=(new Date).getTime(),g=new Date(d.year+"-"+d.month+"-"+d.day).getTime(),h=(c-g)/1e3/31558150;18>h&&(p.identityCardNo18=!1)}else p.identityCardNo=!1;t.regGroup.pwd.test(l)||(p.pwd=!1),o!=u&&(p.ckPwd=!1),t.checkInp(p,m)&&e.ajax({url:"/account/bind_identity/ajax",type:"post",dataType:"json",data:{realName:s,identityCardNo:o,password:l}}).done(function(t){1e5==t.retCode?(e("#bind-form").remove(),e("#bindcard-suc").fadeIn(),e("#bindName").html(s),e("#bindNumber").html(o)):r.handRetCode(t.retCode,t.retMsg)}).fail(function(){r.onServiceFail()})})});