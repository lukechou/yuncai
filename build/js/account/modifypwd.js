require.config({paths:{jquery:"../lib/jquery",bootstrap:"../lib/bootstrap.min",app:"../common/app"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"}}}),require(["jquery","app","bootstrap"],function(t,e){var i=function(){"use strict";var e={Parent:null,elParent:function(t){return t.parents(".info-list")},init:function(){var e=this;t(".j-tips-inp").on("focus",function(i){e.Parent=e.elParent(t(this)),e.warmingShow()}),t(".j-tips-inp").on("blur",function(i){var s=t(this).attr("data-method"),n=t(this).val(),r=t.trim(t("#newpwd").val()),a=t.trim(t("#checkpwd").val());e.Parent=e.elParent(t(this)),2==s?r!==a?e.errorShow():""!==a?e.successShow():e.hideAllTips():/^[^\s]{6,15}$/.test(n)?e.successShow():e.errorShow()})},checkInp:function(e,i,s){var n=this,r=!0;return/^[^\s]{6,15}$/.test(e)||(r=!1,n.Parent=n.elParent(t("#userpwd")),n.errorShow()),/^[^\s]{6,15}$/.test(i)||(r=!1,n.Parent=n.elParent(t("#newpwd")),n.errorShow()),s!==i&&(r=!1,n.Parent=n.elParent(t("#checkpwd")),n.errorShow()),r},hideAllTips:function(){this.Parent.find(".j-tips-s,.j-tips-e,.j-tips-w").addClass("hide")},successShow:function(){this.hideAllTips(),this.Parent.find(".j-tips-s").removeClass("hide")},errorShow:function(){this.hideAllTips(),this.Parent.find(".j-tips-e").removeClass("hide")},warmingShow:function(){this.hideAllTips(),this.Parent.find(".j-tips-w").removeClass("hide")}};return e}();i.init(),t("#newpwd").on("change",function(e){e.preventDefault();var i=t("#checkpwd"),s=t(this).val(),n=i.val();s===n?(i.parents(".info-list").find(".j-tips-s,.j-tips-e,.j-tips-w").addClass("hide"),i.parents(".info-list").find(".j-tips-s").removeClass("hide")):(i.parents(".info-list").find(".j-tips-s,.j-tips-e,.j-tips-w").addClass("hide"),i.parents(".info-list").find(".j-tips-e").removeClass("hide"))}),t("#j-pwdsave").on("click",function(){var s=t.trim(t("#userpwd").val()),n=t.trim(t("#newpwd").val()),r=t.trim(t("#checkpwd").val());i.checkInp(s,n,r)&&t.ajax({url:"/account/modify_password/ajax",type:"post",dataType:"json",data:{userPwd:s,newPwd:n,checkPwd:r}}).done(function(s){1e5==s.retCode?(i.hideAllTips(),t(".pwd-tips").fadeIn("fast",function(){setTimeout(function(){t(".pwd-tips").fadeOut()},1e3)}),location.href="/account/logout"):e.showTips(s.retMsg)}).fail(function(){e.showTips("服务器繁忙,请稍后再试")})})});