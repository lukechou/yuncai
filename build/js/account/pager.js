var PAGE=function(){"use strict";var t={ajaxUrl:"",config:{pageNum:0},pageElement:null,pageTable:null,pageNext:"j-next-page",pageBack:"j-next-page",pageValue:"j-next-page",pageGo:"j-pages-go",appendTable:function(t){this.pageTable.html(t)},makePageHtml:function(t){return(this.pageElement||!t)&&(t=this.pageElement),this.config.pageNum<=1?void t.html(""):void t.html('<div class="pull-right pages">'+this.config.page+'/<span class="j-days">'+this.config.pageNum+'</span>页<a href="javascript:;" class="back-page" >上一页</a><a href="javascript:;" class="next-page">下一页</a><input type="text" value="'+this.config.page+'" class="govalue j-pages-value"><button class="btn j-pages-go" type="button">Go</button>页</div>')},initAjax:function(t){var a=this;a.config=t,$.ajax({url:a.ajaxUrl,type:"get",dataType:"json",data:a.config}).done(function(t){a.onSuccess(t)}).fail(function(){a.onFail()})},bindPageEvent:function(a){$(".next-page").on("click",function(e){t.config.page=parseInt(t.config.page),t.config.page<t.config.pageNum&&(t.config.page+=1,a(t.config))}),$(".back-page").on("click",function(e){t.config.page=parseInt(t.config.page),t.config.page-=1,t.config.page<=0&&(t.config.page=1),a(t.config)}),$(".j-pages-value").on("change",function(t){var a=$(this).siblings(".j-days").html(),e=parseInt($(this).val());e=isNaN(e)?1:Math.ceil(e),e>a&&(e=a),1>e&&(e=1),$(this).val(e)}),$(".j-pages-go").on("click",function(e){t.config.page=$(this).siblings(".j-pages-value").val()||1,a(t.config)})},onSuccess:null,onFail:function(){APP.showTips("服务器繁忙,请稍后再试!")}};return t}();PAGE.loadDetailRecord=function(t){PAGE.config=t;var a=window.location.pathname+"/ajax";$.ajax({url:a,type:"GET",dataType:"json",data:{type:t.type,tradeType:t.tradeType,days:t.days,page:t.page,pageSize:t.pageSize}}).done(function(a){if(1e5==a.retCode){var e=a.retData.data.length,d="";if(e>0)for(var n=a.retData.data,r=0;r<n.length;r++)switch(dataItem=n[r],parseInt(t.type)){case 0:d+="<tr><td>"+dataItem.tradeTime+"</td><td>"+dataItem.tradeType+"</td><td class='fc-3'>"+dataItem.balanceInMoney+"</td><td class='fc-3'>"+dataItem.balanceOutMoney+"</td><td class='fc-3'>"+dataItem.restMoney+"</td><td>"+dataItem.tradeRemark+"</td></tr>";break;case 3:d+="<tr><td>"+dataItem.tradeTime+"</td><td>"+dataItem.tradeType+"</td><td>"+dataItem.orderNo+"</td><td class='fc-3'>"+dataItem.tradeMoney+"</td><td>"+dataItem.restMoney+"</td><td>"+dataItem.tradeRemark+"</td></tr>";break;case 4:d+="<tr><td>"+dataItem.tradeTime+"</td><td>"+dataItem.tradeType+"</td><td>"+dataItem.orderNo+"</td><td>"+dataItem.tradeMoney+"</td><td>"+dataItem.tradeRemark+"</td></tr>";break;case 5:var o="提款完成";d+="<tr><td>"+dataItem.tradeTime+"</td><td>"+dataItem.orderNo+"</td><td>"+dataItem.tradeMoney+"</td><td>"+o+"</td><td>"+dataItem.tradeRemark+"</td></tr>";break;default:d+="<tr><td>"+dataItem.tradeTime+"</td><td>"+dataItem.tradeType+"</td><td>"+dataItem.orderNo+"</td><td>"+dataItem.tradeMoney+"</td><td>"+dataItem.restMoney+"</td><td>"+dataItem.tradeRemark+"</td></tr>"}else d="<tr><td colspan='6'>没有数据</td></tr>";a.retData.summary&&(t.innerHtmlObj.parents(".tab-pane").find(".j-summary-money").html(a.retData.summary.money),t.innerHtmlObj.parents(".tab-pane").find(".j-summary-times").html(a.retData.summary.times)),PAGE.config.pageNum=Math.ceil(a.retData.totalRecord/t.pageSize),PAGE.makePageHtml(t.innerHtmlObj.parents(".table").siblings(".j-page-box")),PAGE.bindPageEvent(PAGE.loadDetailRecord)}else d="<tr><td colspan='6'>"+a.retMsg+"</td></tr>";t.innerHtmlObj.html(d)})},PAGE.getDrawRecord=function(t){PAGE.config=t;var a="/account/draw/record/ajax";$.ajax({url:a,type:"get",dataType:"json",data:{page:t.page,pageSize:t.pageSize,days:$("#days").val(),status:$("#status").val()}}).done(function(a){var e="";if(1e5==a.retCode){var d=a.retData.data.length;if(d>0)for(var n=a.retData.data,r=0;r<n.length;r++)dataItem=n[r],e+="<tr><td>"+dataItem.time+"</td><td>"+dataItem.drawMoney+'元</td><td class="j-status">'+dataItem.status+"</td>",e+=dataItem.tkCaoZuo?'<td><a href="javascript:;" class="j-cancel" data-id="'+dataItem.tkCaoZuo+'">取消</a></td></tr>':"<td></td></tr>";else e='<td colspan="4">暂无相关记录</td>';PAGE.config.pageNum=Math.ceil(a.retData.totalRecord/t.pageSize),PAGE.makePageHtml(t.innerHtmlObj.parents(".table").siblings(".j-page-box")),PAGE.bindPageEvent(PAGE.getDrawRecord)}else e='<td colspan="4">'+a.retMsg+"</td>";$("#tkRecordList").html(e)}).fail(function(){console.log("error")})};