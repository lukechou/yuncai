require.config({paths:{jquery:"../lib/jquery",bootstrap:"../lib/bootstrap.min",app:"../common/app",inp:"../account/inp"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"},inp:{deps:["jquery"],exports:"inp"}}}),require(["jquery","app","inp","bootstrap"],function(t,e,n){n.init();var a=function(){"use strict";var a={smsControl:!0,nextTime:120,getCaptchaBtn:null,timeOutEvent:null,getOldCaptcha:function(){var n=this;n.smsControl&&t.ajax({url:"/account/bind_mobile/uno-sms/ajax",type:"get",dataType:"json"}).done(function(t){1e5==t.retCode?(n.getCaptchaBtn="j-get-captcha",n.initSmsEvent()):e.handRetCode(t.retCode,t.retMsg)})},clearRun:function(){var t=this;clearInterval(t.timeOutEvent)},checkOldMobile:function(){var a=this,o=t("#old-captcha").val(),i=t("#userpwd").val();return n.regGroup.pwd.test(i)?void t.ajax({url:"/account/bind_mobile/check/ajax",type:"get",dataType:"json",data:{captcha:o,password:i}}).done(function(n){1e5==n.retCode?(t("#j-info-text").remove(),t("#j-info-text2").fadeIn(),a.updateSmSEvent(!1),a.clearRun()):e.handRetCode(n.retCode,n.retMsg)}):void t("#userpwd").parents(".info-list").find(".j-tips-e").removeClass("hide")},getNewCaptcha:function(){var a=this,o=t("#mobile").val();return n.regGroup.mobile.test(o)?void(a.smsControl&&t.ajax({url:"/account/bind_mobile/sms/ajax",type:"get",dataType:"json",data:{mobile:o}}).done(function(t){1e5==t.retCode?(a.getCaptchaBtn="j-get-captcha2",a.initSmsEvent()):e.handRetCode(t.retCode,t.retMsg)})):void t("#mobile").parents(".info-list").find(".j-tips-e").removeClass("hide")},modifyBindMobile:function(){var a=t("#mobile").val(),o=t("#new-captcha").val();return n.regGroup.mobile.test(a)?void t.ajax({url:"/account/bind_mobile/mdf/ajax",type:"get",dataType:"json",data:{mobile:a,captcha:o}}).done(function(n){1e5==n.retCode?(t("#j-info-text2").remove(),t("#bindcard-suc").fadeIn(),t("#bindMobile").html(a)):e.handRetCode(n.retCode,n.retMsg)}):void t("#mobile").parents(".info-list").find(".j-tips-e").removeClass("hide")},updateSmsBtn:function(e){t("#"+this.getCaptchaBtn).html(e)},updateSmSEvent:function(e){var n=this;e?(n.smsControl=0,t("#"+this.getCaptchaBtn).addClass("no-event")):(n.smsControl=1,t("#"+this.getCaptchaBtn).removeClass("no-event"))},initSmsEvent:function(){var t=this;t.reStartTime=+new Date+1e3*t.nextTime,t.updateSmsBtn(t.nextTime+"秒后可重新发送"),t.updateSmSEvent(!0),t.timeOutEvent=setInterval(function(){var e="",n=+new Date,a=((t.reStartTime-n)/1e3).toFixed(0);a>0?(e=a,e+="秒后可重新发送",t.updateSmsBtn(e)):(t.updateSmsBtn("重新发送"),t.updateSmSEvent(!1),t.clearRun())},1e3)}};return a}();t("#j-get-captcha").on("click",function(t){a.getOldCaptcha()}),t("#j-next-step").on("click",function(t){a.checkOldMobile()}),t("#j-get-captcha2").on("click",function(t){a.getNewCaptcha()}),t("#j-bind-new-mobile").on("click",function(t){a.modifyBindMobile()})});