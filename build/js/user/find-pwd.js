require.config({paths:{jquery:"../lib/jquery",lodash:"../lib/lodash.compat.min",bootstrap:"../lib/bootstrap.min",app:"../common/app"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"}}}),require(["jquery","lodash","app","bootstrap"],function(e,a,t){function o(){100>s?e("#j-get-mobile-code").html(" "+s.toString()+"秒后可重新获取"):10>s?e("#j-get-mobile-code").html("  "+s.toString()+"秒后可重新获取"):s>0?e("#j-get-mobile-code").html(s+"秒后可重新获取"):(e("#j-get-mobile-code").html("重新获取验证码"),e("#j-get-mobile-code").attr("disabled",!1))}function i(a){var o=t.filterStr(e.trim(e("#username").val()));e.ajax({url:"/account/send-verify-mail",type:"GET",dataType:"json",data:{username:o}}).done(function(o){1e5==o.retCode?(e("#j-email-way").hide(),e("#j-email-sure").fadeIn(),a&&e(".j-send-rst").html("发送成功")):t.showTips(o.retMsg)}).fail(function(){t.showTips("系统繁忙，请联系客服")})}e("#j-start-find").on("click",function(a){var o=t.filterStr(e.trim(e("#username").val()));e(".j-fd-user").html(o),e.ajax({url:"/account/feedback/get-user-mobile",type:"GET",dataType:"json",data:{username:o}}).done(function(a){120036!=a.retCode?(e("#j-set-user").hide(),e("#j-choose-way").fadeIn(),""!=a.retData.mobile&&(e('#j-choose-way li[data-method="mobile"]').removeClass("disable"),e("#mobile_status_img").removeClass("mobile"),e("#mobile_status_img").addClass("mobile_active"),e("#fd_mobile").html(a.retData.mobile)),""!=a.retData.email.address&&(e('#j-choose-way li[data-method="email"]').removeClass("disable"),e("#email_status_img").removeClass("email"),e("#email_status_img").addClass("email_active"),e("#mail_server").val(a.retData.email.host),e(".j-fd-email").html(a.retData.email.address))):(e("#j-set-tips").fadeIn(),e("#first_tips").html("请输入正确的用户名"))}).fail(function(){t.showTips("系统繁忙，请联系客服")})}),e("#j-choose-way .f-step-ls").on("click","li",function(a){var o=t.filterStr(e(this).attr("data-method"));"customer"!=o&&(e("#j-choose-way").hide(),e("#j-"+o+"-way").fadeIn())});var s=0;e("#j-get-mobile-code").on("click",function(a){a.preventDefault(),e("#j-get-mobile-code").attr("disabled",!0);var i=t.filterStr(e.trim(e("#username").val()));e.ajax({url:"/account/userinfo/ucenter/getPwdCheckUser",type:"GET",dataType:"json",data:{username:i}}).done(function(a){if(1e5==a.retCode){s=120;var i=setInterval(function(){s--,0>=s?(s=0,e("#j-get-mobile-code").html("重新获取验证码"),e("#j-get-mobile-code").attr("disabled",!1),clearInterval(i)):o()},1e3);e("#j-get-mobile-code").attr("disabled",!0)}else t.showTips(a.retMsg),e("#j-get-mobile-code").attr("disabled",!1)}).fail(function(){t.showTips("系统繁忙，请联系客服")})}),e("#j-sub-mobile").on("click",function(a){var o=t.filterStr(e.trim(e("#username").val()));e.ajax({url:"/account/userinfo/ucenter/doPostPwd",type:"GET",dataType:"json",data:{username:o,vf_code:e("#mobile_code").val()}}).done(function(a){1e5==a.retCode?(e("#j-mobile-way").hide(),e("#j-reset-pwd").fadeIn(),e("#way").val(1),e("#vf_code").val(e("#mobile_code").val())):e("#j-mobile-tips").show()}).fail(function(){e("#j-mobile-tips").show()})}),e("#j-login-mail").on("click",function(a){a.preventDefault(),window.open(e("#mail_server").val())}),e("#j-send-email").on("click",function(e){i(!1)}),e("#j-send-mail-again").on("click",function(e){i(!0)}),e("#j-next-email").on("click",function(a){var o=t.filterStr(e.trim(e("#username").val()));e.ajax({url:"/account/check-mail-verify-code",type:"GET",dataType:"json",data:{username:o,vf_code:e("#email_code").val()}}).done(function(a){1e5==a.retCode?(e("#j-email-sure").hide(),e("#j-reset-pwd").fadeIn(),e("#way").val(2),e("#vf_code").val(e("#email_code").val())):e("#j-email-tips").show()}).fail(function(){t.showTips("系统繁忙，请联系客服")})}),e("#j-sub-modify").on("click",function(a){a.preventDefault();var o=e("#new_password").val(),i=e("#ensure_password").val();if(o!=i)return e("#j-modify-tips").html("两次输入的密码不一致！"),void e("#j-password-tips").show();var s=t.filterStr(e.trim(e("#username").val())),l="";switch(parseInt(e("#way").val(),10)){case 1:l="/account/userinfo/ucenter/resetPwd";break;case 2:l="/account/reset-password-by-mail";break;default:return}e.ajax({url:l,type:"GET",dataType:"json",data:{username:s,password:o,vf_code:e("#vf_code").val()}}).done(function(a){1e5==a.retCode?(t.showTips("修改成功"),setTimeout(function(){window.location.href="/account/login"},1500)):(e("#j-modify-tips").html(a.retMsg),e("#j-password-tips").show())}).fail(function(){t.showTips("系统繁忙，请联系客服")})})});