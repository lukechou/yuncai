require.config({paths:{jquery:"../lib/jquery",bootstrap:"../lib/bootstrap.min",app:"../common/app"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"}}}),require(["jquery","app","bootstrap"],function(e,t){"use strict";function r(e){for(var t=0,r=e.length,o=-1,s=0;r>s;s++)o=e.charCodeAt(s),t+=o>=0&&128>=o?1:2;return t}function o(){var e=+new Date,t=document.getElementById("j-check-img");t.src="/tools/captcha?"+e}t.updateHeadUserInfo(),e("#register-form").on("submit",function(o){o.preventDefault();var s=e.trim(e("#username").val()),a=e.trim(e("#password").val()),n=e.trim(e("#repassword").val()),i=e.trim(e("#check_code").val()),c=e("#j-agreen")[0].checked,p=r(s);return c?!s||3>p||p>16?void t.showTips("用户名由长度为3-16个字符，只能由字母，数字，汉字组成"):!a||a.length<6||a.length>16?void t.showTips("密码由长度为6-16个字符，不能使用空格"):n!=a?void t.showTips("两次输入的密码不一致"):void(s&&a&&i?e.ajax({url:"/account/doRegister",type:"get",dataType:"json",data:{username:s,password:a,code:i}}).done(function(r){1e5==r.retCode?(e("#register-form").hide(),e("#reg-success").fadeIn(),e("#showUserName").html(e("#username").val()),t.updateHeadUserInfo()):t.showTips(r.retMsg)}).fail(function(){t.showTips("服务器错误!")}):t.showTips("请先输入完整注册信息!")):void t.showTips("请先阅读并同意《注册协议》后才能继续")}),e("#password").on("change",function(t){t.preventDefault(),e(this).val(e(this).val().replace(/ /g,""))}),e("#repassword").on("change",function(t){t.preventDefault(),e(this).val(e(this).val().replace(/ /g,""))}),e("#j-replace-check").on("click",function(e){o()}),o()});