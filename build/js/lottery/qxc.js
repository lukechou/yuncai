require.config({paths:{jquery:"../lib/jquery",lodash:"../lib/lodash.compat.min",bootstrap:"../lib/bootstrap.min",store:"../lib/store.min",app:"../common/app",core:"../lib/core",QXC:"../lottery/qxc_core"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"}}}),require(["jquery","lodash","store","app","QXC","bootstrap","core"],function(e,t,a,s,i){"use strict";function o(){n.init(),r.init()}var n={lotyName:"",lotyCNName:"七星彩",playName:"",codes:[],zhushu:0,mutiple:1,money:0,qihaoId:0,isManual:!1,qihao:0,partnerBuy:{projectTitle:"七星彩合买方案",projectDescription:"七星彩",shareNum:0,partBuyNum:0,partAegisNum:0,commissionPercent:0,unitPrice:0,shareLevel:1},rowIndex:0,buyType:1,trackData:{issueMutipleMap:{},trackStopMoney:0},proxyBuy:{betNum:2,mutiple:1,issueSize:10},init:function(){this.lotyName=e("#lotyName").val(),this.playName=e("#playName").val(),this.codes=[],this.zhushu=0,this.mutiple=1,this.money=0,this.isManual=!1,this.qihaoId=e("#qihaoId").val(),this.qihao=e("#qihao").val(),this.partnerBuy={projectTitle:"七星彩合买方案",projectDescription:"七星彩",shareNum:0,partBuyNum:0,partAegisNum:0,commissionPercent:0,unitPrice:0,shareLevel:1},this.rowIndex=0,this.proxyBuy={betNum:2,multiple:1,issueSize:10}}},r={codes:[],zhushu:0,money:0,init:function(){this.codes=[],this.zhushu=0,this.money=0}},u={codeKey:-1,codeObj:{}};e(document).ready(function(){function l(){switch(e("#buy_type").find(".icon-y2").removeClass("icon-y2"),e("#buy_type").find(".icon").each(function(t,a){e(this).parents('a[data-toggle="tab"]').attr("data-buytype")==n.buyType&&e(this).addClass("icon-y2")}),e("#buy_type").siblings(".tab-content").find(".tab-pane").each(function(t,a){t==n.buyType-1?e(this).addClass("active"):e(this).removeClass("active")}),n.trackData.issueMutipleMap={},e("#buy_mutiple_span").show(),n.partnerBuy={projectTitle:"排列5合买方案",projectDescription:"排列5"},n.mutiple=1,e("#project_mutiple").val(n.mutiple),n.buyType){case 1:e("#track_desc").addClass("hide"),m();break;case 2:e("#buy_mutiple_span").hide(),e("#track_desc").removeClass("hide"),f(10),m();break;case 3:m(),e("#track_desc").addClass("hide"),e("#share-num").val(n.money),h()}}function c(t,a,s){var o=e("#j-nav li.active a").attr("href");switch(i.navPageType=s,e(o).removeClass("active"),e(t).addClass("active"),a.addClass("active"),a.siblings(".active").removeClass("active"),e("#choose_to_buy").attr("data-add","1"),e("#j_normal_choose_code").find(".j-num-group a").removeClass("active"),e("#sd_number").val(""),n.init(),r.init(),b(),d(),m(),n.proxyBuy.betNum=e("#bet_num_proxy").val(),n.proxyBuy.multiple=e("#mutiple_proxy").val(),n.proxyBuy.issueSize=e("#qihao_num_proxy").val(),e("#buy-submit").attr("disabled","disabled"),s){case 0:n.buyType=1,e("li.j-jx-zhus").show(),e("#j-box-right").show(),e("#j-box-bottom").show(),e("#choose_to_buy").removeClass("active"),e("#choose_to_buy").attr("disabled","disabled"),e("#j-box-left").removeClass("multiphase-box");break;case 1:n.buyType=1,e("li.j-jx-zhus").hide(),e("#j-box-right").show(),e("#j-box-bottom").show(),e("#choose_to_buy").removeClass("active"),e("#choose_to_buy").attr("disabled","disabled"),e("#j-box-left").removeClass("multiphase-box");break;case 2:n.buyType=4,_(),e("li.j-jx-zhus").show(),e("#j-box-right").hide(),e("#j-box-bottom").hide(),e("#j-box-left").addClass("multiphase-box")}l()}function p(t,a,s,i,o,r,u){var l=u*a||0,c=(s+u)*a||0;0===t&&(a=0),n.partnerBuy.shareNum=t,n.partnerBuy.partBuyNum=s,n.partnerBuy.unitPrice=a,n.partnerBuy.commissionPercent=parseInt(e("#commission_percent").val()),n.partnerBuy.partAegisNum=u,e("#share-num").val(t),e(".j-unit-price").html(a),e("#part_buy").val(s),e("#part_buy_percent").html(o),e("#part_aegis_num").val(u),e("#part_aegis_percent").html(r),e("#buy_money_tips").html(s*a),e("#aegis_money_tips").html(l),e("#total_money_tips").html(c)}function h(){var t=n.money,a=e("#share-num").val()||t,s="",i="",o=e("#part_buy").val(),r="",u=1*e("#commission_percent").val()||0,l="",c="",h=parseInt(e("#part_aegis_num").val())||0,d=e("#has_part_aegis")[0].checked||!1;return a=Number(a.replace(/[^0-9]/g,"")),o=Number(o.replace(/[^0-9]/g,"")),n.hemaiTotalMoney!==t&&(n.hemaiTotalMoney=t,a=t),0>=t?void p(0,u,0,0,0,0,0):(t%a===0?s=t/a:(s=1,a=t),0>=o&&(o=1),o>a&&(o=a),u>o/a*100&&(o=Math.ceil(a*u*.01)),i=o*s,e("#has_part_aegis")[0]&&(d=e("#has_part_aegis")[0].checked),d?(e("#part_aegis_num")[0].disabled=!1,l=0===h?.8>o/a?Math.ceil(.2*a):a-o:a>h+o?.2>h/a?Math.ceil(.2*a)+o>a?a-o:Math.ceil(.2*a):h:a-o,c=(l/a*100).toFixed(2)):(e("#part_aegis_num")[0].disabled=!0,l=0,c="0.00"),r=0===t?0:(o/a*100).toFixed(2),void p(a,s,o,u,r,c,l))}function d(){r.zhushu=0,r.money=0;for(var t=0,a=r.codes.length;a>t;t++){var s=r.codes[t][0]||[],o=r.codes[t][1]||[],n=r.codes[t][2]||[],u=r.codes[t][3]||[],l=r.codes[t][4]||[],c=r.codes[t][5]||[],p=r.codes[t][6]||[];if(s.length>0&&o.length>0&&n.length>0&&u.length>0&&l.length>0&&c.length>0&&p.length>0){var h=i.getZhiXuanZhushu(s,o,n,u,l,c,p);r.zhushu+=h,r.money+=2*h}}r.zhushu>0?(e("#choose_to_buy").addClass("active"),e("#choose_to_buy").removeAttr("disabled")):(e("#choose_to_buy").removeClass("active"),e("#choose_to_buy").attr("disabled","disabled")),e("#choose_zhushu").html(r.zhushu),e("#choose_money").html(r.money)}function m(){for(var t=0,a=n.codes.length-1;a>=0;a--)t+=i.getZhiXuanZhushu(n.codes[a].value[0],n.codes[a].value[1],n.codes[a].value[2],n.codes[a].value[3],n.codes[a].value[4],n.codes[a].value[5],n.codes[a].value[6]);if(n.zhushu=t,n.money=2*t*n.mutiple,e("#buy_zhushu").html(n.zhushu),e("#project_price").html(n.money),e("#track_issue_num").html(0),e("#track_money").html(0),Object.size(n.trackData.issueMutipleMap)>0){var s=0;n.money=0;for(var o in n.trackData.issueMutipleMap){s++;var r=2*t*n.trackData.issueMutipleMap[o].mutiple;n.money+=r,e(".br-details").find("tbody .br-zhui-c").each(function(t,a){return e(this).attr("data-qihaoid")==o?void e(this).parents("tr").find(".j-money").html(r):void 0})}e("#track_issue_num").html(s),e("#track_money").html(n.money)}n.money>0?e("#buy-submit").removeAttr("disabled"):e("#buy-submit").attr("disabled","disabled")}function y(t){var a=t,o="";if(n.codes.length+r.codes.length>i.maxBuyCodeLength)return void s.showTips("您的投注号码多于"+i.maxBuyCodeLength+"行，请返回重新选择");for(var u=0;u<a.length;u++){n.rowIndex++,o+='<div class="br-zhu-item clearfix" dataBit='+n.rowIndex+'><b>[常规投注]</b><div class="list">';for(var l=0;l<a[u].length;l++)o+='<span data-c="0">'+a[u][l].join("")+"</span>";var c=2*i.getZhiXuanZhushu(a[u][0],a[u][1],a[u][2],a[u][3],a[u][4],a[u][5],a[u][6]);if(c>i.maxOneBetMoney)return s.showTips("您好，单个投注的金额应小于"+i.maxOneBetMoney+"元，请返回重新选择"),!1;var p=n.isManual?"":'<a href="javascript:;" class="br-zhu-set">修改</a>';o+='</div><div class="pull-right"><b><i class="money" data-m="1">'+c+"</i>元</b>"+p+'<a href="javascript:;" class="br-zhu-del">删除</a></div></div>',n.codes.push({key:n.rowIndex,value:a[u]})}return e("#code_list").append(o),!0}function v(t){e("#j_normal_choose_code").find(".j-num-group a").removeClass("active");var a={};for(var s in n.codes)if(n.codes[s].key==t){a=n.codes[s].value.concat();break}r.init(),r.codes[0]=a;for(var o=e("#j_normal_choose_code").find(".j-row-code"),u=0;u<i.ZhiXuanNormal.oneBetCodeNum;u++){var l=a[u],c=l.length;o.each(function(t,a){if(t==u)for(var s=0;c>s;s++)e(this).find(".j-num-group a").each(function(t){parseInt(e(this).html())==l[s]&&e(this).addClass("active")})})}d()}function b(){e(".br-zhu-l").html(""),e("#sd-list").html(""),n.init(),m(),h()}function f(t){var a="";e(".br-details thead .br-zhui-bei").val(1),e.ajax({url:"/lottery/digital/query-track-issue/"+n.lotyName+"?num="+t,type:"GET",dataType:"json"}).done(function(t){if(1e5==t.retCode)for(var s=0;s<t.retData.length;s++){var i=s+1,o=2*n.zhushu;n.trackData.issueMutipleMap[t.retData[s].id]={qihao:t.retData[s].qihao,mutiple:1},a+="<tr><td>"+i+'</td><td><input type="checkbox" class="br-zhui-c" data-qihaoid="'+t.retData[s].id+'"data-qi="'+t.retData[s].qihao+'" checked="">'+t.retData[s].qihao+'期</td><td><input type="text" class="br-input br-zhui-bei" value="1">倍</td><td><span class="j-money">'+o+"</span>元</td><td>"+t.retData[s].awardTime.slice(0,10)+'<span class="ml15">'+t.retData[s].awardTime.slice(10)+"</span></td></tr>"}else a='<tr><td colspan="5">系统繁忙， 请稍候再试</td></tr>';e("#track_issue_list").html(a),m()}).fail(function(){a='<tr><td colspan="5">系统繁忙， 请稍候再试</td></tr>',e("#track_issue_list").html(a)})}function _(){e("#buy_bet_num_proxy").html(n.proxyBuy.betNum),e("#buy_multiple_proxy").html(n.proxyBuy.multiple),e("#buy_issue_num_proxy").html(n.proxyBuy.issueSize),n.money=2*n.proxyBuy.betNum*n.proxyBuy.multiple*n.proxyBuy.issueSize,n.mutiple=n.proxyBuy.multiple,e("#buy_money_proxy").html(n.money),n.money>0?e("#buy_button_proxy").removeAttr("disabled"):e("#buy_button_proxy").attr("disabled","disabled")}function g(e,t,a,s,i,o,n,r,u,l,c){var p='<div class="frbox"><img src="'+staticHostURI+'/front_images/fail.png" alt="success" class="icon"><div class="text">';switch(e){case 1:p+="<p>"+t+" 第<span>"+a+"</span>期</p>                <p>共<span>"+s+"</span>注, 投注<span>"+i+'</span>倍</p>                <p>本次需支付<span class="fc-3">'+o.toFixed(2)+"</span>元</p>";break;case 2:p+="<p>追号<span>"+u+'</span>期</p>                <p>本次需支付<span class="fc-3">'+l+"</span>元</p>";case 4:break;case 3:p+=r>0?"<p>"+t+" 第<span>"+a+'</span>期</p>                  <p>方案总金额<span class="fc-3">'+o.toFixed(2)+"</span>元</p>                  <p>您认购<span>"+n+"</span>份, 保底<span>"+r+'</span>份</p>                  <p>共需支付<span class="fc-3">'+c.toFixed(2)+"</span>元</p>":"<p>"+t+" 第<span>"+a+'</span>期</p>                  <p>方案总金额<span class="fc-3">'+o.toFixed(2)+"</span>元</p>                  <p>您认购<span>"+n+'</span>份</p>                  <p>共需支付<span class="fc-3">'+c.toFixed(2)+"</span>元</p>"}return p+='<div class="btns"><button class="btn btn-danger" id="buyConfirm">确定</button><button class="btn btn-gray" data-dismiss="modal">取消</button></div></div></div>'}function x(e,t,i,o,n,r,u){1e5==e?(a.set("lotyName",r),a.set("lotyCNName",u),a.set("payMoney",n),a.set("projectNo",i),a.set("trackId",o),window.location.href="/html/lottery/trade/success.html"):s.handRetCode(e,t)}function j(e,t){a.set("lotyName",e),a.set("lotyCNName",t),window.location.href="/html/lottery/trade/fail.html"}o(),1==e("#saleStatus").val()&&(s.showStopSellModal("七星彩"),e("#buy-submit,#buy_button_proxy").html("暂停销售").removeClass("btn-red").addClass("btn-stop").attr("id","")),e(".j-num-group").on("click","a",function(a){a.preventDefault();var s=parseInt(e(this).parents(".j-row-code").attr("data-bit")),i=null,o=e(this).html();"undefined"==typeof r.codes[0]&&(r.codes[0]=[]),"undefined"==typeof r.codes[0][s]&&(r.codes[0][s]=[]),i=r.codes[0][s].concat(),e(this).hasClass("active")?t.remove(i,function(e){return e==o}):i.push(o),r.codes[0][s]=i,r.codes[0][s].sort(),e(this).toggleClass("active"),d()}),e(".j-quick-method").on("click","span",function(t){t.preventDefault(),e(this).toggleClass("active");var a=parseInt(e(this).parents(".j-row-code").attr("data-bit"));switch("undefined"==typeof r.codes[0]&&(r.codes[0]=[]),r.codes[0][a]=[],e(this).attr("data-type")){case"odd":e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).removeClass("active"),t%2!=0&&(e(this).toggleClass("active"),r.codes[0][a].push(parseInt(e(this).html())))});break;case"even":e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).removeClass("active"),t%2==0&&(e(this).toggleClass("active"),r.codes[0][a].push(parseInt(e(this).html())))});break;case"big":e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).removeClass("active"),t>=5&&(e(this).toggleClass("active"),r.codes[0][a].push(parseInt(e(this).html())))});break;case"small":e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).removeClass("active"),4>=t&&(e(this).toggleClass("active"),r.codes[0][a].push(parseInt(e(this).html())))});break;case"all":e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).addClass("active"),r.codes[0][a].push(parseInt(e(this).html()))});break;case"clean":r.codes[0][a].length=0,e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).removeClass("active")})}d()}),e("#choose_to_buy").on("click",function(a){if(e(this).hasClass("active")){var o=!1;switch(parseInt(e("#choose_to_buy").attr("data-add"))){case 0:var l=r.codes[0][0]||[],c=r.codes[0][1]||[],p=r.codes[0][2]||[],d=r.codes[0][3]||[],v=r.codes[0][4]||[],b=r.codes[0][5]||[],f=r.codes[0][6]||[];if(!(l.length>0&&c.length>0&&p.length>0&&d.length>0&&v.length>0&&b.length>0&&f.length>0))return;if(r.money>i.maxOneBetMoney)return s.showTips("您好，单个投注的金额应小于"+i.maxOneBetMoney+"元，请返回重新选择"),!1;for(var _ in n.codes)n.codes[_].key==u.codeKey&&(n.codes[_].value=r.codes[0]);var g='<div class="br-zhu-item clearfix" databit="'+u.codeKey+'"><b>[常规投注]</b><div class="list"><span data-c="0">'+r.codes[0][0].join("")+'</span><span data-c="0">'+r.codes[0][1].join("")+'</span><span data-c="0">'+r.codes[0][2].join("")+'</span><span data-c="0">'+r.codes[0][3].join("")+'</span><span data-c="0">'+r.codes[0][4].join("")+'</span><span data-c="0">'+r.codes[0][5].join("")+'</span><span data-c="0">'+r.codes[0][6].join("")+'</span></div><div class="pull-right"><b><i class="money" data-m="1">'+r.money+'</i>元</b><a href="javascript:;" class="br-zhu-set">修改</a><a href="javascript:;" class="br-zhu-del">删除</a></div></div>';u.codeObj.replaceWith(g),o=!0;break;case 1:if(1===i.navPageType){var x=t.compact(e("#sd_number").val().replace(/，/gi,",").split("\n"));if(x.length>i.maxBuyCodeLength)return void s.showTips("您的投注号码多于"+i.maxBuyCodeLength+"行，请返回重新选择");r.init();for(var j=0;j<x.length;j++){var k=i.isIllegalCode(x[j],function(e,t){r.codes.push(e),r.zhushu+=t,r.money+=2*t});if(!k)return void s.showTips(i.getLastErrorMsg())}}for(var j=r.codes.length-1;j>=0;j--)if(!(r.codes[j][0].length>0&&r.codes[j][1].length>0&&r.codes[j][2].length>0&&r.codes[j][3].length>0&&r.codes[j][4].length>0))return;o=y(r.codes)}o&&(m(),h(),e("#choose_zhushu").html(0),e("#choose_money").html(0),e("#sd_number").val(""),e("#j_normal_choose_code").find(".j-num-group a").removeClass("active"),r.init(),e("#choose_to_buy_tip").html("添加到投注列表"),e("#choose_to_buy").attr("data-add",1),e("#choose_to_buy").removeClass("active"),e("#choose_to_buy").attr("disabled","disabled"))}}),e("#j-touzhu-tips").on("click",function(t){e(this).toggleClass("active"),e("#j-touzhu-tipstext").toggle()}),e(".j-zhu-adds").on("click",function(t){t.preventDefault();var a=parseInt(e(this).attr("data-zhu"));if(n.codes.length+a>i.maxBuyCodeLength)return void s.showTips("您的投注号码多于"+i.maxBuyCodeLength+"行，请返回重新选择");for(var o=a-1;o>=0;o--)i.produceCode(function(e){y([e])});m(),h()}),e(".br-zhu-l").on("click",".br-zhu-item",function(t){t.preventDefault(),n.isManual||"A"!=t.target.tagName&&(v(e(this).attr("databit")),e("#choose_to_buy").addClass("active"))}),e(".br-zhu-l").on("click",".br-zhu-del",function(a){e(this).parents(".br-zhu-item")[0]==u.codeObj[0]&&(e("#choose_to_buy").attr("data-add",1),e("#choose_to_buy_tip").html("添加到投注列表"));var s=e(this).parents(".br-zhu-item").attr("dataBit");t.remove(n.codes,function(e){return e.key==s}),e(this).parents(".br-zhu-item").remove(),m(),h()}),e(".br-zhu-l").on("click",".br-zhu-set",function(t){var a=e(this).parents(".br-zhu-item").attr("databit");v(a),e("#choose_to_buy").addClass("active"),e("#choose_to_buy").attr("data-add",0),e("#choose_to_buy_tip").html("修改投注号码"),u={codeKey:a,codeObj:e(this).parents(".br-zhu-item")}}),e("#clean_buy_code").on("click",function(a){var s=n.buyType;e("#code_list").html(""),n.init(),m(),n.mutiple=Number(t.escape(e("#project_mutiple").val()))||1,n.buyType=s,h()}),e("#decrease_mutiple").on("click",function(t){t.preventDefault();var a=e("#project_mutiple"),s=parseInt(a.val());s--,n.mutiple=s<i.minMultiple?i.minMultiple:s>i.maxMultiple?i.maxMultiple:s,a.val(n.mutiple),m(),h()}),e("#project_mutiple").on("change",function(t){t.preventDefault();var a=parseInt(e(this).val())||0;n.mutiple=a<i.minMultiple?i.minMultiple:a>i.maxMultiple?i.maxMultiple:a,e(this).val(n.mutiple),m(),h()}),e("#increase_mutiple").on("click",function(t){t.preventDefault();var a=e("#project_mutiple"),s=parseInt(a.val());s++,n.mutiple=s<i.minMultiple?i.minMultiple:s>i.maxMultiple?i.maxMultiple:s,a.val(n.mutiple),m(),h()}),e("#buy-submit").on("click",function(t){return t.preventDefault(),e(this).parents(".br-tou").find(".j-sub-agreed")[0].checked===!1?void s.showTips("请先阅读并同意《委托投注规则》后才能继续"):void k()}),e("#buy_button_proxy").on("click",function(t){return t.preventDefault(),e(this).parents(".br-tou").find(".j-sub-agreed")[0].checked===!1?void s.showTips("请先阅读并同意《委托投注规则》后才能继续"):void k()}),e("#buy_type").on("click","a",function(t){t.preventDefault(),n.buyType=parseInt(e(this).attr("data-buytype")),l()}),e("#issue_size").on("change",function(t){t.preventDefault(),n.trackData.issueMutipleMap={},f(e(this).val())}),e(".br-details thead .br-zhui-c").on("change",function(t){var a=e(this)[0].checked;e(this).parents(".br-details").find("tbody .br-zhui-c").each(function(e,t){t.checked=a}),n.trackData.issueMutipleMap={},e(this).parents(".br-details").find("tbody .br-zhui-c").each(function(t,a){a.checked&&(n.trackData.issueMutipleMap[e(this).attr("data-qihaoid")]={qihao:e(this).attr("data-qi"),mutiple:e(this).parents("tr").find(".br-zhui-bei").val()})}),m()}),e(".br-details").on("change","tbody .br-zhui-c",function(t){t.preventDefault(),n.trackData.issueMutipleMap={},e(this).parents(".br-details").find("tbody .br-zhui-c").each(function(t,a){a.checked&&(n.trackData.issueMutipleMap[e(this).attr("data-qihaoid")]={qihao:e(this).attr("data-qi"),mutiple:e(this).parents("tr").find(".br-zhui-bei").val()})}),m()}),e(".br-details thead .br-zhui-bei").on("change",function(t){var a=parseInt(e(this).val())||1;isNaN(a)||1>a?a=1:(a=Math.ceil(a),a>9999&&(a=9999)),e(this).val(a);var s=e(this).parents(".br-details");s.find("tbody .br-zhui-bei").val(a),s.find("tbody .br-zhui-c").each(function(t,a){a.checked="checked",n.trackData.issueMutipleMap[e(this).attr("data-qihaoid")]={qihao:e(this).attr("data-qi"),mutiple:e(this).parents("tr").find(".br-zhui-bei").val()}}),m()}),e(".br-details tbody").on("change",".br-zhui-bei",function(t){var a=parseInt(e(this).val())||1;isNaN(a)||1>a?a=1:(a=Math.ceil(a),a>9999&&(a=9999)),e(this).val(a);var s=e(this).parents("tr"),i=s.find(".br-zhui-c");i.attr("checked","checked"),n.trackData.issueMutipleMap[i.attr("data-qihaoid")]={qihao:i.attr("data-qi"),mutiple:s.find(".br-zhui-bei").val()},m()}),e("#share-num").on("change",function(e){e.preventDefault(),h()}),e("#part_buy").on("change",function(e){e.preventDefault(),h()}),e("#commission_percent").on("change",function(t){t.preventDefault();var a=parseInt(e(this).val())||0,s=Math.floor(e("#part_buy_percent").html());a>s&&(e("#part_buy").val(Math.ceil(e("#commission_percent").val()/100*(e("#share-num").val()||0))),h()),n.partnerBuy.commissionPercent=a}),e("#has_part_aegis").on("change",function(e){e.preventDefault(),h()}),e("#part_aegis_num").on("change",function(e){e.preventDefault(),h()}),e(".br-set-group").on("click","a",function(t){switch(t.preventDefault(),e(this).parents(".br-set-group").find("a").removeClass("active"),e(this).toggleClass("active"),e(this).html()){case"截止后公开":n.partnerBuy.shareLevel=1;break;case"立即公开":n.partnerBuy.shareLevel=0;break;case"截止前对跟单人公开":n.partnerBuy.shareLevel=2}}),e("#title").on("change",function(t){t.preventDefault();var a=e(this).val(),s=a.length;n.partnerBuy.projectTitle=a;var i=20;s>=i&&(projectDescLength=i,n.partnerBuy.projectTitle=a.substring(0,i),e(this).val(n.partnerBuy.projectTitle)),e("#title_font_size").html(s)}),e("#title").on("keyup",function(t){t.preventDefault();var a=e(this).val(),s=a.length;n.partnerBuy.projectTitle=a;var i=20;s>=i&&(projectDescLength=i,n.partnerBuy.projectTitle=a.substring(0,i),e(this).val(n.partnerBuy.projectTitle)),e("#title_font_size").html(s)}),e("#desc").on("change",function(t){t.preventDefault();var a=e(this).val(),s=a.length;n.partnerBuy.projectDescription=a;var i=200;s>=i&&(s=i,n.partnerBuy.projectDescription=a.substring(0,i),e(this).val(n.partnerBuy.projectDescription)),e("#desc_font_size").html(s)}),e("#desc").on("keyup",function(t){t.preventDefault();var a=e(this).val(),s=a.length;n.partnerBuy.projectDescription=a;var i=200;s>=i&&(s=i,n.partnerBuy.projectDescription=a.substring(0,i),e(this).val(n.partnerBuy.projectDescription)),e("#desc_font_size").html(s)}),e('#buy_type a[data-toggle="tab"]').on("click",function(t){e(this).parents("#buy_type").find(".icon-y2").removeClass("icon-y2"),e(this).find(".icon").addClass("icon-y2")}),e("#is_end_zhongjiang").on("change",function(t){t.preventDefault(),e(this)[0].checked?e("#track_stop_money").removeAttr("disabled"):(e("#track_stop_money").attr("disabled","disabled"),e("#part_aegis_num").val(0))}),e("#track_stop_money").on("change",function(){event.preventDefault();var t=parseInt(e(this).val())||3e3;e(this).val(t)}),e("#j-textarea-mask").on("click",function(t){e(this).hide(),e("#sd_number").addClass("focus"),e("#sd_number")[0].focus()}),e("#sd_number").on("blur",function(t){t.preventDefault();var a=e.trim(e(this).val());""===a&&(e("#j-textarea-mask").show(),e("#choose_to_buy").removeClass("active"))}),e("#sd_number").on("keyup blur",function(a){var s=t.compact(e(this).val().replace(/，/gi,",").split("\n"));e("#choose_zhushu").html(s.length),e("#choose_money").html(2*s.length),s.length?(e("#choose_to_buy").addClass("active"),e("#choose_to_buy").removeAttr("disabled"),n.isManual=!0):(e("#choose_to_buy").removeClass("active"),e("#choose_to_buy").attr("disabled","disabled"))}),e("#j-nav").on("click","a",function(t){t.preventDefault();var a=e(this),i=Number(a.attr("data-pagetype")),o=e(this).attr("href"),r=a.parents("li");n.codes.length>=1?s.showTips({title:"友情提示",text:"切换玩法将会清空您的号码",type:2,onConfirm:function(){e("#myModal").modal("hide"),e(".br-details").find("tbody .br-zhui-c").each(function(e,t){a.parents("tr").find(".j-money").html(0)}),c(o,r,i),e("#choose_to_buy_tip").html("添加到投注列表"),e("#choose_to_buy").attr("data-add",1)}}):c(o,r,i)}),e("#decrease_bet_num_proxy").on("click",function(t){t.preventDefault();var a=e("#bet_num_proxy"),s=parseInt(a.val());s--,n.proxyBuy.betNum=s<i.minBetNum?i.minBetNum:s>i.maxBetNum?i.maxBetNum:s,a.val(n.proxyBuy.betNum),_()}),e("#bet_num_proxy").on("change",function(){var t=parseInt(e(this).val())||0;n.proxyBuy.betNum=t<i.minBetNum?i.minBetNum:t>i.maxBetNum?i.maxBetNum:t,e(this).val(n.proxyBuy.betNum),_()}),e("#increase_bet_num_proxy").on("click",function(t){t.preventDefault();var a=e("#bet_num_proxy"),s=parseInt(a.val());s++,n.proxyBuy.betNum=s<i.minBetNum?i.minBetNum:s>i.maxBetNum?i.maxBetNum:s,a.val(n.proxyBuy.betNum),_()}),e("#decrease_mutiple_proxy").on("click",function(t){t.preventDefault();var a=e("#mutiple_proxy"),s=parseInt(a.val());s--,n.proxyBuy.multiple=s<i.minMultiple?i.minMultiple:s>i.maxMultiple?i.maxMultiple:s,a.val(n.proxyBuy.multiple),_()}),e("#mutiple_proxy").on("change",function(){var t=parseInt(e(this).val())||0;n.proxyBuy.multiple=t<i.minMultiple?i.minMultiple:t>i.maxMultiple?i.maxMultiple:t,e(this).val(n.proxyBuy.multiple),_()}),e("#increase_mutiple_proxy").on("click",function(t){t.preventDefault();var a=e("#mutiple_proxy"),s=parseInt(a.val());s++,n.proxyBuy.multiple=s<i.minMultiple?i.minMultiple:s>i.maxMultiple?i.maxMultiple:s,a.val(n.proxyBuy.multiple),_()}),e("#decrease_qihao_num_proxy").on("click",function(t){t.preventDefault();var a=e("#qihao_num_proxy"),s=parseInt(a.val());s--,n.proxyBuy.issueSize=s<i.minIssueNum?i.minIssueNum:s>i.maxIssueNum?i.maxIssueNum:s,a.val(n.proxyBuy.issueSize),_()}),e("#qihao_num_proxy").on("change",function(){var t=parseInt(e(this).val())||0;n.proxyBuy.issueSize=t<i.minIssueNum?i.minIssueNum:t>i.maxIssueNum?i.maxIssueNum:t,e(this).val(n.proxyBuy.issueSize),_()}),e("#increase_qihao_num_proxy").on("click",function(t){t.preventDefault();var a=e("#qihao_num_proxy"),s=parseInt(a.val());s++,n.proxyBuy.issueSize=s<i.minIssueNum?i.minIssueNum:s>i.maxIssueNum?i.maxIssueNum:s,a.val(n.proxyBuy.issueSize),_()}),n.hemaiTotalMoney=0;var k=function(){for(var t="",a=[],i=0;i<n.codes.length;i++){for(var o=[],r=0;r<n.codes[i].value.length;r++)o.push(n.codes[i].value[r].join(""));a.push(o.join(","))}var u={zhushu:n.zhushu,beishu:n.mutiple,codes:a.join("$"),unikey:(new Date).valueOf()},l="",c=0;switch(n.buyType){case 1:t="/lottery/digital/buy-self/"+n.lotyName+"/"+n.playName,u.qihaoId=n.qihaoId,u.qihao=n.qihao,c=n.money,l=g(1,n.lotyCNName,u.qihao,n.zhushu,n.mutiple,n.money,0,0,0,0);break;case 2:t="/lottery/digital/buy-track/"+n.lotyName+"/"+n.playName;var p=[];for(var h in n.trackData.issueMutipleMap)p.push(h+"|"+n.trackData.issueMutipleMap[h].qihao+"|"+n.trackData.issueMutipleMap[h].mutiple);if(p.length<1)return void s.showTips("追号最少购买一期");e("#is_end_zhongjiang")[0].checked&&(n.trackData.trackStopMoney=e("#track_stop_money").val()),u.endminmoney=n.trackData.trackStopMoney,u.zhuihaoqihao=p,c=n.money,l=g(2,n.lotyCNName,0,0,0,0,0,0,p.length,n.money);break;case 3:if(t="/lottery/digital/buy-together/"+n.lotyName+"/"+n.playName,u.qihaoId=n.qihaoId,u.qihao=n.qihao,u.title=n.partnerBuy.projectTitle,u.textarea=n.partnerBuy.projectDescription,u.shareNum=n.partnerBuy.shareNum,u.buyNum=n.partnerBuy.partBuyNum,u.aegisNum=n.partnerBuy.partAegisNum,u.extraPercent=n.partnerBuy.commissionPercent,u.set="undefined"==typeof n.partnerBuy.shareLevel?1:n.partnerBuy.shareLevel,u.rengouMoney<1)return void s.showTips("合买至少认购一元");var d=n.partnerBuy.unitPrice*u.buyNum,m=n.partnerBuy.unitPrice*u.aegisNum;c=d+m,l=g(3,n.lotyCNName,u.qihao,u.zhushu,u.beishu,n.money,u.buyNum,u.aegisNum,0,0,c);break;case 4:t="/lottery/digital/buy-rank/"+n.lotyName+"/"+n.playName,u.zhushu=n.proxyBuy.betNum,u.beishu=n.proxyBuy.multiple,u.qishu=n.proxyBuy.issueSize,c=n.money,l=g(2,n.lotyCNName,0,0,0,0,0,0,u.qishu,n.money)}var y="";switch(n.buyType){case 1:y+="<p>"+n.lotyCNName+' 第<span class="fc-3 mlr5">'+u.qihao+"</span>期</p>",y+='<p>共<span class="fc-3 mlr5">'+u.zhushu+'</span>注, 投注<span class="fc-3 mlr5">'+u.beishu+"</span>倍</p>";break;case 2:y+='<p>追号<span class="fc-3 mlr5">'+p.length+"</span>期</p>";break;case 3:y+="<p>"+n.lotyCNName+' 第<span class="fc-3 mlr5">'+u.qihao+"</span>期</p>",y+='<p>方案总金额<span class="fc-3 mlr5">'+n.money+".00</span>元</p>",y+='<p>您认购<span class="fc-3 mlr5">'+u.buyNum+'</span>份, 保底<span class="fc-3 mlr5">'+u.aegisNum+"</span>份</p>";break;case 4:y+='<p>多期投注：共<span class="fc-3 mlr5">'+u.zhushu+'</span>注，<span class="fc-3 mlr5">'+u.beishu+'</span>倍，<span class="fc-3 mlr5">'+u.qishu+"</span>期</p>"}y+='<p>本次需支付：<span class="fc-3 mlr5">'+c+".00</span>元",s.checkLogin(c,{enoughMoney:function(){s.showTips({html:l,title:"投注确认"}),e("#buyConfirm").one("click",function(a){e.ajax({url:t,type:"POST",dataType:"json",data:u}).done(function(e){return 1e5!==e.retCode?void s.showTips(e.retMsg):void x(e.retCode,e.retMsg,e.retData.projectNo,e.retData.trackId,c,n.lotyName,n.lotyCNName)}).fail(function(){j(n.lotyName,n.lotyCNName)})})},lessMoneyTips:y})}})});