require.config({paths:{jquery:"../lib/jquery",lodash:"../lib/lodash.compat.min",bootstrap:"../lib/bootstrap.min",store:"../lib/store.min",app:"../common/app",core:"../lib/core",QLC:"../lottery/qlc_core"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"}}}),require(["jquery","lodash","store","app","QLC","bootstrap","core"],function(e,t,a,i,s){"use strict";function o(){n.init(),r.init()}var n={lotyName:"",lotyCNName:"七乐彩",playName:"",codes:[],zhushu:0,mutiple:1,money:0,qihaoId:0,isManual:!1,qihao:0,partnerBuy:{projectTitle:"七乐彩合买方案",projectDescription:"七乐彩",shareNum:0,partBuyNum:0,partAegisNum:0,commissionPercent:0,unitPrice:0,shareLevel:1},rowIndex:0,buyType:1,trackData:{issueMutipleMap:{},trackStopMoney:0},proxyBuy:{betNum:2,mutiple:1,issueSize:10},init:function(){this.lotyName=e("#lotyName").val(),this.playName=e("#playName").val(),this.codes=[],this.zhushu=0,this.mutiple=1,this.money=0,this.isManual=!1,this.qihaoId=e("#qihaoId").val(),this.qihao=e("#qihao").val(),this.partnerBuy={projectTitle:"七乐彩合买方案",projectDescription:"七乐彩",shareNum:0,partBuyNum:0,partAegisNum:0,commissionPercent:0,unitPrice:0,shareLevel:1},this.rowIndex=0,this.proxyBuy={betNum:2,multiple:1,issueSize:10}}},r={codes:[],zhushu:0,money:0,init:function(){this.codes=[],this.zhushu=0,this.money=0}},u={codeKey:-1,codeObj:{}};e(document).ready(function(){function l(){switch(e("#buy_type").find(".icon-y2").removeClass("icon-y2"),e("#buy_type").find(".icon").each(function(t,a){e(this).parents('a[data-toggle="tab"]').attr("data-buytype")==n.buyType&&e(this).addClass("icon-y2")}),e("#buy_type").siblings(".tab-content").find(".tab-pane").each(function(t,a){t==n.buyType-1?e(this).addClass("active"):e(this).removeClass("active")}),n.trackData.issueMutipleMap={},e("#buy_mutiple_span").show(),n.partnerBuy={projectTitle:"七乐彩合买方案",projectDescription:"七乐彩"},n.mutiple=1,e("#project_mutiple").val(n.mutiple),n.buyType){case 1:e("#track_desc").addClass("hide"),d();break;case 2:e("#buy_mutiple_span").hide(),e("#track_desc").removeClass("hide"),_(10),d();break;case 3:d(),e("#track_desc").addClass("hide"),e("#share-num").val(n.money),h()}}function c(t,a,i){var o=e("#j-nav li.active a").attr("href");switch(s.navPageType=i,e(o).removeClass("active"),e(t).addClass("active"),a.addClass("active"),a.siblings(".active").removeClass("active"),e("#choose_to_buy").attr("data-add","1"),e("#j_normal_choose_code").find(".j-num-group a").removeClass("active"),e("#sd_number").val(""),n.init(),r.init(),v(),m(),d(),n.proxyBuy.betNum=e("#bet_num_proxy").val(),n.proxyBuy.multiple=e("#mutiple_proxy").val(),n.proxyBuy.issueSize=e("#qihao_num_proxy").val(),e("#buy-submit").attr("disabled","disabled"),i){case 0:n.buyType=1,e("li.j-jx-zhus").show(),e("#j-box-right").show(),e("#j-box-bottom").show(),e("#choose_to_buy").removeClass("active"),e("#choose_to_buy").attr("disabled","disabled"),e("#j-box-left").removeClass("multiphase-box");break;case 1:n.buyType=1,e("li.j-jx-zhus").hide(),e("#j-box-right").show(),e("#j-box-bottom").show(),e("#choose_to_buy").removeClass("active"),e("#choose_to_buy").attr("disabled","disabled"),e("#j-box-left").removeClass("multiphase-box");break;case 2:n.buyType=4,f(),e("li.j-jx-zhus").show(),e("#j-box-right").hide(),e("#j-box-bottom").hide(),e("#j-box-left").addClass("multiphase-box")}l()}function p(t,a,i,s,o,r,u){var l=u*a||0,c=(i+u)*a||0;0===t&&(a=0),n.partnerBuy.shareNum=t,n.partnerBuy.partBuyNum=i,n.partnerBuy.unitPrice=a,n.partnerBuy.commissionPercent=parseInt(e("#commission_percent").val()),n.partnerBuy.partAegisNum=u,e("#share-num").val(t),e(".j-unit-price").html(a),e("#part_buy").val(i),e("#part_buy_percent").html(o),e("#part_aegis_num").val(u),e("#part_aegis_percent").html(r),e("#buy_money_tips").html(i*a),e("#aegis_money_tips").html(l),e("#total_money_tips").html(c)}function h(){var t=n.money,a=e("#share-num").val()||t,i="",s="",o=e("#part_buy").val(),r="",u=1*e("#commission_percent").val()||0,l="",c="",h=parseInt(e("#part_aegis_num").val())||0,m=e("#has_part_aegis")[0].checked||!1;return a=Number(a.replace(/[^0-9]/g,"")),o=Number(o.replace(/[^0-9]/g,"")),n.hemaiTotalMoney!==t&&(n.hemaiTotalMoney=t,a=t),0>=t?void p(0,u,0,0,0,0,0):(t%a===0?i=t/a:(i=1,a=t),0>=o&&(o=1),o>a&&(o=a),u>o/a*100&&(o=Math.ceil(a*u*.01)),s=o*i,e("#has_part_aegis")[0]&&(m=e("#has_part_aegis")[0].checked),m?(e("#part_aegis_num")[0].disabled=!1,l=0===h?.8>o/a?Math.ceil(.2*a):a-o:a>h+o?.2>h/a?Math.ceil(.2*a)+o>a?a-o:Math.ceil(.2*a):h:a-o,c=(l/a*100).toFixed(2)):(e("#part_aegis_num")[0].disabled=!0,l=0,c="0.00"),r=0===t?0:(o/a*100).toFixed(2),void p(a,i,o,u,r,c,l))}function m(){r.zhushu=0,r.money=0;for(var t=0,a=r.codes.length;a>t;t++){var i=s.getNormalZhushu(r.codes[t]);r.zhushu+=i,r.money+=2*i}r.zhushu>0?(e("#choose_to_buy").addClass("active"),e("#choose_to_buy").removeAttr("disabled")):(e("#choose_to_buy").removeClass("active"),e("#choose_to_buy").attr("disabled","disabled")),e("#choose_zhushu").html(r.zhushu),e("#choose_money").html(r.money)}function d(){for(var t=0,a=n.codes.length-1;a>=0;a--)t+=s.getNormalZhushu(n.codes[a].value);if(n.zhushu=t,n.money=2*t*n.mutiple,e("#buy_zhushu").html(n.zhushu),e("#project_price").html(n.money),e("#track_issue_num").html(0),e("#track_money").html(0),Object.size(n.trackData.issueMutipleMap)>0){var i=0;n.money=0;for(var o in n.trackData.issueMutipleMap){i++;var r=2*t*n.trackData.issueMutipleMap[o].mutiple;n.money+=r,e(".br-details").find("tbody .br-zhui-c").each(function(t,a){return e(this).attr("data-qihaoid")==o?void e(this).parents("tr").find(".j-money").html(r):void 0})}e("#track_issue_num").html(i),e("#track_money").html(n.money)}n.money>0?e("#buy-submit").removeAttr("disabled"):e("#buy-submit").attr("disabled","disabled")}function y(t){var a=t,o="";if(n.codes.length+r.codes.length>s.maxBuyCodeLength)return void i.showTips("您的投注号码多于"+s.maxBuyCodeLength+"行，请返回重新选择");for(var u=0;u<a.length;u++){n.rowIndex++,o+='<div class="br-zhu-item clearfix" dataBit='+n.rowIndex+'><b>[常规投注]</b><div class="list">';for(var l=0;l<a[u].length;l++)o+='<span data-c="0">'+a[u][l]+"</span>";var c=2*s.getNormalZhushu(a[u]);if(c>s.maxOneBetMoney)return i.showTips("您好，单个投注的金额应小于"+s.maxOneBetMoney+"元，请返回重新选择"),!1;var p=n.isManual?"":'<a href="javascript:;" class="br-zhu-set">修改</a>';o+='</div><div class="pull-right"><b><i class="money" data-m="1">'+c+"</i>元</b>"+p+'<a href="javascript:;" class="br-zhu-del">删除</a></div></div>',n.codes.push({key:n.rowIndex,value:a[u]})}return e("#code_list").append(o),!0}function b(t){e("#home").find(".j-num-group a").removeClass("active");var a={};for(var i in n.codes)if(n.codes[i].key==t){a=n.codes[i].value.concat();break}r.init(),r.codes[0]=a;for(var s=0;s<a.length;s++)e("#home").find(".j-num-group a").each(function(t){parseInt(e(this).html())==a[s]&&e(this).addClass("active")});m()}function v(){e(".br-zhu-l").html(""),e("#sd-list").html(""),n.init(),d(),h()}function _(t){var a="";e(".br-details thead .br-zhui-bei").val(1),e.ajax({url:"/lottery/digital/query-track-issue/"+n.lotyName+"?num="+t,type:"GET",dataType:"json"}).done(function(t){if(1e5==t.retCode)for(var i=0;i<t.retData.length;i++){var s=i+1,o=2*n.zhushu;n.trackData.issueMutipleMap[t.retData[i].id]={qihao:t.retData[i].qihao,mutiple:1},a+="<tr><td>"+s+'</td><td><input type="checkbox" class="br-zhui-c" data-qihaoid="'+t.retData[i].id+'"data-qi="'+t.retData[i].qihao+'" checked="">'+t.retData[i].qihao+'期</td><td><input type="text" class="br-input br-zhui-bei" value="1">倍</td><td><span class="j-money">'+o+"</span>元</td><td>"+t.retData[i].awardTime.slice(0,10)+'<span class="ml15">'+t.retData[i].awardTime.slice(10)+"</span></td></tr>"}else a='<tr><td colspan="5">系统繁忙， 请稍候再试</td></tr>';e("#track_issue_list").html(a),d()}).fail(function(){a='<tr><td colspan="5">系统繁忙， 请稍候再试</td></tr>',e("#track_issue_list").html(a)})}function f(){e("#buy_bet_num_proxy").html(n.proxyBuy.betNum),e("#buy_multiple_proxy").html(n.proxyBuy.multiple),e("#buy_issue_num_proxy").html(n.proxyBuy.issueSize),n.money=2*n.proxyBuy.betNum*n.proxyBuy.multiple*n.proxyBuy.issueSize,n.mutiple=n.proxyBuy.multiple,e("#buy_money_proxy").html(n.money),n.money>0?e("#buy_button_proxy").removeAttr("disabled"):e("#buy_button_proxy").attr("disabled","disabled")}function g(e,t,a,i,s,o,n,r,u,l,c){var p='<div class="frbox"><img src="'+staticHostURI+'/front_images/fail.png" alt="success" class="icon"><div class="text">';switch(e){case 1:p+="<p>"+t+" 第<span>"+a+"</span>期</p>                <p>共<span>"+i+"</span>注, 投注<span>"+s+'</span>倍</p>                <p>本次需支付<span class="fc-3">'+o.toFixed(2)+"</span>元</p>";break;case 2:p+="<p>追号<span>"+u+'</span>期</p>                <p>本次需支付<span class="fc-3">'+l+"</span>元</p>";case 4:break;case 3:p+=r>0?"<p>"+t+" 第<span>"+a+'</span>期</p>                  <p>方案总金额<span class="fc-3">'+o.toFixed(2)+"</span>元</p>                  <p>您认购<span>"+n+"</span>份, 保底<span>"+r+'</span>份</p>                  <p>共需支付<span class="fc-3">'+c.toFixed(2)+"</span>元</p>":"<p>"+t+" 第<span>"+a+'</span>期</p>                  <p>方案总金额<span class="fc-3">'+o.toFixed(2)+"</span>元</p>                  <p>您认购<span>"+n+'</span>份</p>                  <p>共需支付<span class="fc-3">'+c.toFixed(2)+"</span>元</p>"}return p+='<div class="btns"><button class="btn btn-danger" id="buyConfirm">确定</button><button class="btn btn-gray" data-dismiss="modal">取消</button></div></div></div>'}function x(e,t,s,o,n,r,u){1e5==e?(a.set("lotyName",r),a.set("lotyCNName",u),a.set("payMoney",n),a.set("projectNo",s),a.set("trackId",o),window.location.href="/html/lottery/trade/success.html"):i.handRetCode(e,t)}function N(e,t){a.set("lotyName",e),a.set("lotyCNName",t),window.location.href="/html/lottery/trade/fail.html"}o(),e("#j-touzhu-tips").on("click",function(t){e(this).toggleClass("active"),e("#j-touzhu-tipstext").toggle()}),1==e("#saleStatus").val()&&(i.showStopSellModal("七乐彩"),e("#buy-submit,#buy_button_proxy").html("暂停销售").removeClass("btn-red").addClass("btn-stop").attr("id","")),e(".j-num-group").on("click","a",function(a){a.preventDefault();var i=null,s=e(this).html();"undefined"==typeof r.codes[0]&&(r.codes[0]=[]),i=r.codes[0].concat(),e(this).hasClass("active")?t.remove(i,function(e){return e==s}):i.push(s),r.codes[0]=i,r.codes[0].sort(),e(this).toggleClass("active"),m()}),e(".jxredball").on("click",function(t){t.preventDefault(),r.codes[0]=[];var a=s.produceCodes(e("#codeNum").val());e(this).parents("#home").find(".j-num-group a").removeClass("active");for(var i=0,o=a.length;o>i;i++)e(this).parents("#home").find(".j-num-group a").each(function(t){return e(this).html()==a[i]?(e(this).addClass("active"),void r.codes[0].push(e(this).html())):void 0});m()}),e(".clearredball").on("click",function(t){r.codes[0]=[],t.preventDefault(),e("#j_normal_choose_code").find(".j-num-group a").removeClass("active"),m()}),e("#choose_to_buy").on("click",function(a){if(e(this).hasClass("active")){var o=!1;switch(parseInt(e("#choose_to_buy").attr("data-add"))){case 0:var l=r.codes[0][0]||[],c=r.codes[0][1]||[],p=r.codes[0][2]||[],m=r.codes[0][3]||[],b=r.codes[0][4]||[];if(!(l.length>0&&c.length>0&&p.length>0&&m.length>0&&b.length>0))return;if(r.money>s.maxOneBetMoney)return i.showTips("您好，单个投注的金额应小于"+s.maxOneBetMoney+"元，请返回重新选择"),!1;for(var v in n.codes)n.codes[v].key==u.codeKey&&(n.codes[v].value=r.codes[0]);for(var _='<div class="br-zhu-item clearfix" databit="'+u.codeKey+'"><b>[常规投注]</b><div class="list">',f=0;f<r.codes[0].length;f++)_+='<span data-c="0">'+r.codes[0][f]+"</span>";_+='</div><div class="pull-right"><b><i class="money" data-m="1">'+r.money+'</i>元</b><a href="javascript:;" class="br-zhu-set">修改</a><a href="javascript:;" class="br-zhu-del">删除</a></div></div>',u.codeObj.replaceWith(_),o=!0;break;case 1:if(1===s.navPageType){var g=t.compact(e("#sd_number").val().replace(/，/gi,",").split("\n"));if(g.length>s.maxBuyCodeLength)return void i.showTips("您的投注号码多于"+s.maxBuyCodeLength+"行，请返回重新选择");r.init();for(var x=0;x<g.length;x++){var N=s.isIllegalCode(g[x],function(e,t){e.sort(),r.codes.push(e),r.zhushu+=t,r.money+=2*t});if(!N)return void i.showTips(s.getLastErrorMsg())}}for(var x=r.codes.length-1;x>=0;x--)if(!(r.codes[x][0].length>0&&r.codes[x][1].length>0&&r.codes[x][2].length>0&&r.codes[x][3].length>0&&r.codes[x][4].length>0))return;o=y(r.codes)}o&&(d(),h(),e("#choose_zhushu").html(0),e("#choose_money").html(0),e("#sd_number").val(""),e("#j_normal_choose_code").find(".j-num-group a").removeClass("active"),r.init(),e("#choose_to_buy_tip").html("添加到投注列表"),e("#choose_to_buy").attr("data-add",1),e("#choose_to_buy").removeClass("active"),e("#choose_to_buy").attr("disabled","disabled"))}}),e(".j-zhu-adds").on("click",function(t){t.preventDefault();var a=parseInt(e(this).attr("data-zhu"));if(n.codes.length+a>s.maxBuyCodeLength)return void i.showTips("您的投注号码多于"+s.maxBuyCodeLength+"行，请返回重新选择");for(var o=a-1;o>=0;o--){var r=s.produceOneBetCode();y([r])}d(),h()}),e(".br-zhu-l").on("click",".br-zhu-item",function(t){t.preventDefault(),n.isManual||"A"!=t.target.tagName&&(b(e(this).attr("databit")),e("#choose_to_buy").addClass("active"))}),e(".br-zhu-l").on("click",".br-zhu-del",function(a){e(this).parents(".br-zhu-item")[0]==u.codeObj[0]&&(e("#choose_to_buy").attr("data-add",1),e("#choose_to_buy_tip").html("添加到投注列表"));var i=e(this).parents(".br-zhu-item").attr("dataBit");t.remove(n.codes,function(e){return e.key==i}),e(this).parents(".br-zhu-item").remove(),d(),h()}),e(".br-zhu-l").on("click",".br-zhu-set",function(t){var a=e(this).parents(".br-zhu-item").attr("databit");b(a),e("#choose_to_buy").addClass("active"),e("#choose_to_buy").attr("data-add",0),e("#choose_to_buy_tip").html("修改投注号码"),u={codeKey:a,codeObj:e(this).parents(".br-zhu-item")}}),e("#clean_buy_code").on("click",function(a){var i=n.buyType;e("#code_list").html(""),n.init(),d(),n.mutiple=Number(t.escape(e("#project_mutiple").val()))||1,n.buyType=i,h()}),e("#decrease_mutiple").on("click",function(t){t.preventDefault();var a=e("#project_mutiple"),i=parseInt(a.val());i--,n.mutiple=i<s.minMultiple?s.minMultiple:i>s.maxMultiple?s.maxMultiple:i,a.val(n.mutiple),d(),h()}),e("#project_mutiple").on("change",function(t){t.preventDefault();var a=parseInt(e(this).val())||0;n.mutiple=a<s.minMultiple?s.minMultiple:a>s.maxMultiple?s.maxMultiple:a,e(this).val(n.mutiple),d(),h()}),e("#increase_mutiple").on("click",function(t){t.preventDefault();var a=e("#project_mutiple"),i=parseInt(a.val());i++,n.mutiple=i<s.minMultiple?s.minMultiple:i>s.maxMultiple?s.maxMultiple:i,a.val(n.mutiple),d(),h()}),e("#buy-submit").on("click",function(t){return t.preventDefault(),e(this).parents(".br-tou").find(".j-sub-agreed")[0].checked===!1?void i.showTips("请先阅读并同意《委托投注规则》后才能继续"):void k()}),e("#buy_button_proxy").on("click",function(t){return t.preventDefault(),e(this).parents(".br-tou").find(".j-sub-agreed")[0].checked===!1?void i.showTips("请先阅读并同意《委托投注规则》后才能继续"):void k()}),e("#buy_type").on("click","a",function(t){t.preventDefault(),n.buyType=parseInt(e(this).attr("data-buytype")),l()}),e("#issue_size").on("change",function(t){t.preventDefault(),n.trackData.issueMutipleMap={},_(e(this).val())}),e(".br-details thead .br-zhui-c").on("change",function(t){var a=e(this)[0].checked;e(this).parents(".br-details").find("tbody .br-zhui-c").each(function(e,t){t.checked=a}),n.trackData.issueMutipleMap={},e(this).parents(".br-details").find("tbody .br-zhui-c").each(function(t,a){a.checked&&(n.trackData.issueMutipleMap[e(this).attr("data-qihaoid")]={qihao:e(this).attr("data-qi"),mutiple:e(this).parents("tr").find(".br-zhui-bei").val()})}),d()}),e(".br-details").on("change","tbody .br-zhui-c",function(t){t.preventDefault(),n.trackData.issueMutipleMap={},e(this).parents(".br-details").find("tbody .br-zhui-c").each(function(t,a){a.checked&&(n.trackData.issueMutipleMap[e(this).attr("data-qihaoid")]={qihao:e(this).attr("data-qi"),mutiple:e(this).parents("tr").find(".br-zhui-bei").val()})}),d()}),e(".br-details thead .br-zhui-bei").on("change",function(t){var a=parseInt(e(this).val())||1;isNaN(a)||1>a?a=1:(a=Math.ceil(a),a>9999&&(a=9999)),e(this).val(a);var i=e(this).parents(".br-details");i.find("tbody .br-zhui-bei").val(a),i.find("tbody .br-zhui-c").each(function(t,a){a.checked="checked",n.trackData.issueMutipleMap[e(this).attr("data-qihaoid")]={qihao:e(this).attr("data-qi"),mutiple:e(this).parents("tr").find(".br-zhui-bei").val()}}),d()}),e(".br-details tbody").on("change",".br-zhui-bei",function(t){var a=parseInt(e(this).val())||1;isNaN(a)||1>a?a=1:(a=Math.ceil(a),a>9999&&(a=9999)),e(this).val(a);var i=e(this).parents("tr"),s=i.find(".br-zhui-c");s.attr("checked","checked"),n.trackData.issueMutipleMap[s.attr("data-qihaoid")]={qihao:s.attr("data-qi"),mutiple:i.find(".br-zhui-bei").val()},d()}),e("#share-num").on("change",function(e){e.preventDefault(),h()}),e("#part_buy").on("change",function(e){e.preventDefault(),h()}),e("#commission_percent").on("change",function(t){t.preventDefault();var a=parseInt(e(this).val())||0,i=Math.floor(e("#part_buy_percent").html());a>i&&(e("#part_buy").val(Math.ceil(e("#commission_percent").val()/100*(e("#share-num").val()||0))),h()),n.partnerBuy.commissionPercent=a}),e("#has_part_aegis").on("change",function(e){e.preventDefault(),h()}),e("#part_aegis_num").on("change",function(e){e.preventDefault(),h()}),e(".br-set-group").on("click","a",function(t){switch(t.preventDefault(),e(this).parents(".br-set-group").find("a").removeClass("active"),e(this).toggleClass("active"),e(this).html()){case"截止后公开":n.partnerBuy.shareLevel=1;break;case"立即公开":n.partnerBuy.shareLevel=0;break;case"截止前对跟单人公开":n.partnerBuy.shareLevel=2}}),e("#title").on("change",function(t){t.preventDefault();var a=e(this).val(),i=a.length;n.partnerBuy.projectTitle=a;var s=20;i>=s&&(projectDescLength=s,n.partnerBuy.projectTitle=a.substring(0,s),e(this).val(n.partnerBuy.projectTitle)),e("#title_font_size").html(i)}),e("#title").on("keyup",function(t){t.preventDefault();var a=e(this).val(),i=a.length;n.partnerBuy.projectTitle=a;var s=20;i>=s&&(projectDescLength=s,n.partnerBuy.projectTitle=a.substring(0,s),e(this).val(n.partnerBuy.projectTitle)),e("#title_font_size").html(i)}),e("#desc").on("change",function(t){t.preventDefault();var a=e(this).val(),i=a.length;n.partnerBuy.projectDescription=a;var s=200;i>=s&&(i=s,n.partnerBuy.projectDescription=a.substring(0,s),e(this).val(n.partnerBuy.projectDescription)),e("#desc_font_size").html(i)}),e("#desc").on("keyup",function(t){t.preventDefault();var a=e(this).val(),i=a.length;n.partnerBuy.projectDescription=a;var s=200;i>=s&&(i=s,n.partnerBuy.projectDescription=a.substring(0,s),e(this).val(n.partnerBuy.projectDescription)),e("#desc_font_size").html(i)}),e('#buy_type a[data-toggle="tab"]').on("click",function(t){e(this).parents("#buy_type").find(".icon-y2").removeClass("icon-y2"),e(this).find(".icon").addClass("icon-y2")}),e("#is_end_zhongjiang").on("change",function(t){t.preventDefault(),e(this)[0].checked?e("#track_stop_money").removeAttr("disabled"):(e("#track_stop_money").attr("disabled","disabled"),e("#part_aegis_num").val(0))}),e("#track_stop_money").on("change",function(){event.preventDefault();var t=parseInt(e(this).val())||3e3;e(this).val(t)}),e("#j-textarea-mask").on("click",function(t){e(this).hide(),e("#sd_number").addClass("focus"),e("#sd_number")[0].focus()}),e("#sd_number").on("blur",function(t){t.preventDefault();var a=e.trim(e(this).val());""===a&&(e("#j-textarea-mask").show(),e("#choose_to_buy").removeClass("active"))}),e("#sd_number").on("keyup blur",function(a){var i=t.compact(e(this).val().replace(/，/gi,",").split("\n"));e("#choose_zhushu").html(i.length),e("#choose_money").html(2*i.length),i.length?(e("#choose_to_buy").addClass("active"),e("#choose_to_buy").removeAttr("disabled"),n.isManual=!0):(e("#choose_to_buy").removeClass("active"),e("#choose_to_buy").attr("disabled","disabled"))}),e("#j-nav").on("click","a",function(t){t.preventDefault();var a=e(this),s=Number(a.attr("data-pagetype")),o=e(this).attr("href"),r=a.parents("li");n.codes.length>=1?i.showTips({title:"友情提示",text:"切换玩法将会清空您的号码",type:2,onConfirm:function(){e("#myModal").modal("hide"),e(".br-details").find("tbody .br-zhui-c").each(function(e,t){a.parents("tr").find(".j-money").html(0)}),c(o,r,s),e("#choose_to_buy_tip").html("添加到投注列表"),e("#choose_to_buy").attr("data-add",1)}}):c(o,r,s)}),e("#decrease_bet_num_proxy").on("click",function(t){t.preventDefault();var a=e("#bet_num_proxy"),i=parseInt(a.val());i--,n.proxyBuy.betNum=i<s.minBetNum?s.minBetNum:i>s.maxBetNum?s.maxBetNum:i,a.val(n.proxyBuy.betNum),f()}),e("#bet_num_proxy").on("change",function(){var t=parseInt(e(this).val())||0;n.proxyBuy.betNum=t<s.minBetNum?s.minBetNum:t>s.maxBetNum?s.maxBetNum:t,e(this).val(n.proxyBuy.betNum),f()}),e("#increase_bet_num_proxy").on("click",function(t){t.preventDefault();var a=e("#bet_num_proxy"),i=parseInt(a.val());i++,n.proxyBuy.betNum=i<s.minBetNum?s.minBetNum:i>s.maxBetNum?s.maxBetNum:i,a.val(n.proxyBuy.betNum),f()}),e("#decrease_mutiple_proxy").on("click",function(t){t.preventDefault();var a=e("#mutiple_proxy"),i=parseInt(a.val());i--,n.proxyBuy.multiple=i<s.minMultiple?s.minMultiple:i>s.maxMultiple?s.maxMultiple:i,a.val(n.proxyBuy.multiple),f()}),e("#mutiple_proxy").on("change",function(){var t=parseInt(e(this).val())||0;n.proxyBuy.multiple=t<s.minMultiple?s.minMultiple:t>s.maxMultiple?s.maxMultiple:t,e(this).val(n.proxyBuy.multiple),f()}),e("#increase_mutiple_proxy").on("click",function(t){t.preventDefault();var a=e("#mutiple_proxy"),i=parseInt(a.val());i++,n.proxyBuy.multiple=i<s.minMultiple?s.minMultiple:i>s.maxMultiple?s.maxMultiple:i,a.val(n.proxyBuy.multiple),f()}),e("#decrease_qihao_num_proxy").on("click",function(t){t.preventDefault();var a=e("#qihao_num_proxy"),i=parseInt(a.val());i--,n.proxyBuy.issueSize=i<s.minIssueNum?s.minIssueNum:i>s.maxIssueNum?s.maxIssueNum:i,a.val(n.proxyBuy.issueSize),f()}),e("#qihao_num_proxy").on("change",function(){var t=parseInt(e(this).val())||0;n.proxyBuy.issueSize=t<s.minIssueNum?s.minIssueNum:t>s.maxIssueNum?s.maxIssueNum:t,e(this).val(n.proxyBuy.issueSize),f()}),e("#increase_qihao_num_proxy").on("click",function(t){t.preventDefault();var a=e("#qihao_num_proxy"),i=parseInt(a.val());i++,n.proxyBuy.issueSize=i<s.minIssueNum?s.minIssueNum:i>s.maxIssueNum?s.maxIssueNum:i,a.val(n.proxyBuy.issueSize),f()}),n.hemaiTotalMoney=0;var k=function(){for(var t="",a=[],s=0;s<n.codes.length;s++)a.push(n.codes[s].value.join(","));var o={zhushu:n.zhushu,beishu:n.mutiple,codes:a.join("$"),unikey:(new Date).valueOf()},r="",u=0;switch(n.buyType){case 1:t="/lottery/digital/buy-self/"+n.lotyName+"/"+n.playName,o.qihaoId=n.qihaoId,o.qihao=n.qihao,u=n.money,r=g(1,n.lotyCNName,o.qihao,n.zhushu,n.mutiple,n.money,0,0,0,0);break;case 2:t="/lottery/digital/buy-track/"+n.lotyName+"/"+n.playName;var l=[];for(var c in n.trackData.issueMutipleMap)l.push(c+"|"+n.trackData.issueMutipleMap[c].qihao+"|"+n.trackData.issueMutipleMap[c].mutiple);if(l.length<1)return void i.showTips("追号最少购买一期");e("#is_end_zhongjiang")[0].checked&&(n.trackData.trackStopMoney=e("#track_stop_money").val()),o.endminmoney=n.trackData.trackStopMoney,o.zhuihaoqihao=l,u=n.money,r=g(2,n.lotyCNName,0,0,0,0,0,0,l.length,n.money);break;case 3:if(t="/lottery/digital/buy-together/"+n.lotyName+"/"+n.playName,o.qihaoId=n.qihaoId,o.qihao=n.qihao,o.title=n.partnerBuy.projectTitle,o.textarea=n.partnerBuy.projectDescription,o.shareNum=n.partnerBuy.shareNum,o.buyNum=n.partnerBuy.partBuyNum,o.aegisNum=n.partnerBuy.partAegisNum,o.extraPercent=n.partnerBuy.commissionPercent,o.set="undefined"==typeof n.partnerBuy.shareLevel?1:n.partnerBuy.shareLevel,o.rengouMoney<1)return void i.showTips("合买至少认购一元");var p=n.partnerBuy.unitPrice*o.buyNum,h=n.partnerBuy.unitPrice*o.aegisNum;u=p+h,r=g(3,n.lotyCNName,o.qihao,o.zhushu,o.beishu,n.money,o.buyNum,o.aegisNum,0,0,u);break;case 4:t="/lottery/digital/buy-rank/"+n.lotyName+"/"+n.playName,o.zhushu=n.proxyBuy.betNum,o.beishu=n.proxyBuy.multiple,o.qishu=n.proxyBuy.issueSize,u=n.money,r=g(2,n.lotyCNName,0,0,0,0,0,0,o.qishu,n.money)}var m="";switch(n.buyType){case 1:m+="<p>"+n.lotyCNName+' 第<span class="fc-3 mlr5">'+o.qihao+"</span>期</p>",m+='<p>共<span class="fc-3 mlr5">'+o.zhushu+'</span>注, 投注<span class="fc-3 mlr5">'+o.beishu+"</span>倍</p>";break;case 2:m+='<p>追号<span class="fc-3 mlr5">'+l.length+"</span>期</p>";break;case 3:m+="<p>"+n.lotyCNName+' 第<span class="fc-3 mlr5">'+o.qihao+"</span>期</p>",m+='<p>方案总金额<span class="fc-3 mlr5">'+n.money+".00</span>元</p>",m+='<p>您认购<span class="fc-3 mlr5">'+o.buyNum+'</span>份, 保底<span class="fc-3 mlr5">'+o.aegisNum+"</span>份</p>";break;case 4:m+='<p>多期投注：共<span class="fc-3 mlr5">'+o.zhushu+'</span>注，<span class="fc-3 mlr5">'+o.beishu+'</span>倍，<span class="fc-3 mlr5">'+o.qishu+"</span>期</p>"}m+='<p>本次需支付：<span class="fc-3 mlr5">'+u+".00</span>元",i.checkLogin(u,{enoughMoney:function(){i.showTips({html:r,title:"投注确认"}),e("#buyConfirm").one("click",function(a){e.ajax({url:t,type:"POST",dataType:"json",data:o}).done(function(e){return 1e5!==e.retCode?void i.showTips(e.retMsg):void x(e.retCode,e.retMsg,e.retData.projectNo,e.retData.trackId,u,n.lotyName,n.lotyCNName)}).fail(function(){N(n.lotyName,n.lotyCNName)})})},lessMoneyTips:m})}})});