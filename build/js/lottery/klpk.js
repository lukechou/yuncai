require.config({paths:{jquery:"../lib/jquery",lodash:"../lib/lodash.compat.min",bootstrap:"../lib/bootstrap.min",store:"../lib/store.min",app:"../common/app",scroll:"../lib/jquery.mCustomScrollbar.concat.min"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"},scroll:{deps:["jquery"],exports:"jquery"}}}),require(["jquery","lodash","store","app","bootstrap","scroll"],function(t,a,e,s){"use strict";function n(t){var a=t?t:1;return isNaN(t)||1>t?a=1:(t=Math.ceil(t),t>9999&&(a=9999)),a}function i(a){t.trim(a.val())==a.attr("data-text")&&(a.parents("p").find(".j-btext-total").html(0),a.val(""))}function o(a){var e=a.attr("data-text");""==t.trim(a.val())&&(a.val(e),a.parents("p").find(".j-btext-total").html(e.length))}function r(t){var a=t.val().length,e=parseInt(t.attr("data-size"));e>=a?t.parents("p").find(".j-btext-total").html(a):(t.val(t.val().slice(0,e-1)),t.parents("p").find(".j-btext-total").html(e))}function l(){var a=w.getBuyArrTotalMoney(),e=t("#share-num").val()||a,s="",n="",i=t("#part_buy").val(),o="",r=1*t("#commission_percent").val()||0,l="",c="",p=parseInt(t("#part_aegis_num").val())||0,h=t("#has_part_aegis")[0].checked||!1;return e=Number(e.replace(/[^0-9]/g,"")),i=Number(i.replace(/[^0-9]/g,"")),0>=a?void u(0,r,0,0,0,0,0):(a%e===0?s=a/e:(s=1,e=a),0>=i&&(i=1),i>e&&(i=e),r>i/e*100&&(i=Math.ceil(e*r*.01)),n=i*s,t("#has_part_aegis")[0]&&(h=t("#has_part_aegis")[0].checked),h?(t("#part_aegis_num")[0].disabled=!1,l=0===p?.8>i/e?Math.ceil(.2*e):e-i:e>p+i?.2>p/e?Math.ceil(.2*e)+i>e?e-i:Math.ceil(.2*e):p:e-i,c=(l/e*100).toFixed(2)):(t("#part_aegis_num")[0].disabled=!0,l=0,c="0.00"),o=0===a?0:(i/e*100).toFixed(2),void u(e,s,i,r,o,c,l))}function u(a,e,s,n,i,o,r){var l={},u=r*e||0,c=(s+r)*e||0;0===a&&(e=0),l.shareNum=a,l.partBuyNum=s,l.unitPrice=e,l.commissionPercent=parseInt(t("#commission_percent").val()),l.partAegisNum=r,t("#share-num").val(a),t(".j-unit-price").html(e),t("#part_buy").val(s),t("#part_buy_percent").html(i),t("#part_aegis_num").val(r),t("#part_aegis_percent").html(o),t("#buy_money_tips").html(s*e),t("#aegis_money_tips").html(u),t("#total_money_tips").html(c)}function c(){t("#j-award-more b").html("收起"),t("#j-todaynum-table").removeClass("hide")}function p(){t("#j-award-more b").html("展开"),t("#j-todaynum-table").addClass("hide")}function h(){var t=10;d(),m(),v(),y(),w.statu=1,setInterval(function(){d(),m(),v()},1e3*t)}function d(){var a="/lottery/award/kuaipin/"+w.lotyName,e=t("#j-todaynum-table tbody"),s=e.attr("data-qihao");s&&s===w.qihao||t.ajax({url:a,type:"GET",dataType:"json",data:{t:"ajx"}}).done(function(a){for(var s=w.qihao.slice(0,w.qihao.length-2),n=(~~t("#j-maxqishu").val(),84),i=21,o=[],r="",l=null,u="",c="",p=0;i>p;p++)o.push([]);for(var p=1;n>=p;p++)l=null,r=10>p?"0"+p:p,a[s+r]?(l=a[s+r],l.index=r):l={index:r},o[p%i]?o[p%i].push(l):(o[p%i]=[],o[p%i].push(l));o[o.length]=o[0];for(var p=1,h=o.length;h>p;p++){u+="<tr>";for(var r=0;r<o[p].length;r++)c=o[p][r],u+='<td class="period">'+c.index+"</td>",u+=c.code_str?'<td class="awardTd">'+c.code_str+"</td>":"<td>- -</td>",u+=c.hz_val?"<td>"+c.hz_val+"</td>":"<td></td>",u+=c.shape?"<td>"+c.shape+"</td>":"<td></td>";u+="</tr>"}e.html(u),e.attr("data-qihao",w.qihao)})}function m(){t.ajax({url:"/lottery/issue/get-last-award-info",type:"GET",dataType:"json",data:{lotteryId:w.lotyId}}).done(function(a){if(1e5===a.retCode){for(var e="",s=0;s<a.retData.length&&!(s>5);s++)e+="<tr>",e+="<td>"+a.retData[s].username+"</td>",e+="<td>"+a.retData[s].bonus_before_tax+"</td>",e+="</tr>";t("#j-new-bonus-list").html(""==e?'<tr><td colspan="2">暂无相关中奖纪录</td></tr>':e)}else t("#j-new-bonus-list").html('<tr><td colspan="2">系统繁忙</td></tr>')})}function y(){var a=t("#issue_size").val();t.ajax({url:"/lottery/issue/get-cur-issue",type:"GET",dataType:"json",data:{lottery_id:w.lotyId}}).done(function(e){var n=e.retData[0],i="",o="",r=~~t("#j-maxqishu").val()||100,l="";if(1e5===e.retCode){if(o=0===parseInt(n.sell_status,10))return w.showStopControl&&(s.showStopSellModal(w.lotyCnName),t("#buy-submit").html("暂停销售").removeClass("btn-red").addClass("btn-stop").attr("disabled",!0),t("#j-less-seconds").html('<i class="icon icon-k302">--</i><i class="icon icon-k302">--</i>'),w.showStopControl=!1),void C(10);w.showStopControl=!0,t("#buy-submit").html("立即投注").addClass("btn-red").removeClass("btn-stop").removeAttr("disabled"),i=Math.floor(n.company_sell_etime-n.sys_time),w.qihao=n.issue_num,w.qihaoId=n.id,l=~~w.qihao.slice(w.qihao.length-2)-1,t("#j-sell-qi").html(l),t("#j-less-qi").html(r-l),0>i?(t("#j-second-hd").addClass("out"),t("#j-less-seconds").html("<h6>等待开售中..</h6>"),w.waitSell=!0,v(),C(10)):(_(i),w.waitSell=!1,t("#j-second-hd").removeClass("out"),t("#j-dq-qihao").html(w.qihao),t(".br-details thead .br-zhui-c")[0].checked=!0,x(a))}}).fail(function(){C(10)})}function b(t,a){var e="";if((a||0==a)&&(e="m-card-"+a),t&&3===t.length){var s='<span class="m-card '+e+" card-"+t.slice(0,1)+'"><i class="iconfont icon-h'+t.slice(0,1)+' m-card-flow"></i><i class="iconfont icon-n'+t.slice(1)+' m-card-num"></i></span>';return s}return""}function f(t){var e="";if(a.isArray(t))for(var s=0;s<t.length;s++)e+=b(t[s],s);else e=b(t);return e}function v(){t.ajax({url:"/lottery/issue/kuaipin/last-issue-n",type:"GET",dataType:"json",data:{loty_name:w.lotyName,issue_num:10}}).done(function(a){var e=a.retData,s="",n="",i="",o="等待开奖",r="",l=e[0],u=0,c="",p=[];if(1e5==a.retCode){for(var h=0,d=e.length;d>h;h++)""===e[h].kjhm?(i="等待开奖",c=""):(p=e[h].kjhm.split(" "),i=f(p),c=z(p)),s+='<tr><td class="ctr1">'+e[h].no+"</td><td>"+i+'</td><td class="ctr2">'+c+"</td></tr>";t("#j-last-issue-n").html(s),""!=l.kjhm?(o="",r=l.kjhm.split(" "),o+=f(r),n="<p>"+w.lotyCnName+' 第<span class="fc-3 mlr5">'+l.no+'</span>期<span>开奖</span></p><p class="sub-content-num">'+o+"</p>"):n="<p>"+w.lotyCnName+' 第<span class="fc-3 mlr5">'+l.no+'</span>期<span>开奖</span></p><p class="sub-content-num">'+o+"</p>",t("#j-sub-content").html(n),l.kj_time<=l.server_time?(w.currentKjStatus=r?1:2,w.waitSell&&(w.currentKjStatus=4)):(w.currentKjStatus=3,u=l.kj_time-l.server_time),(w.kjStatus!==w.currentKjStatus||4===w.currentKjStatus)&&(j({nums:r,no:l.no,lessTime:u,item:e}),w.kjStatus=w.currentKjStatus)}})}function j(e){var s={},n="",i="",o="",r=null,l="";if(e){if(w.currentKjStatus||(w.currentKjStatus=1),n=z(e.nums),s={qihao:e.no,nums:e.nums,xt:n},1===w.currentKjStatus)return a.isArray(n)&&(l=n.join(" ")),i=a.template('<p class="third-hd"><b>第<span class="mlr5 fc-3"><%= qihao%></span>开奖牌<span class="ml-10">牌型：<span class="fc-3 mlr5">'+l+'</span></b></p><div class="third-box clearfix card-big-group">'+f(s.nums)+"</div>"),void t("#j-kj-box").html(i(s));if(2===w.currentKjStatus){var u='<div class="num-group"><span class="card"></span></div>';return i=a.template('<p class="third-hd"><b>第<span class="mlr5 fc-3"><%= qihao%></span>开奖中：</b><% _.forEach(nums, function(num) { %><span class="fc-3 mlr5"><%- num %></span><% }); %></p><div class="third-box clearfix"><ul class="pull-left third-hisnum" id="j-kjing-num"><li class="kj-num-first">'+u+"</li><li>"+u+"</li><li>"+u+"</li></ul></div>"),void t("#j-kj-box").html(i(s))}if(3===w.currentKjStatus)return r=e.item[1],e.nums=r.kjhm,n=z(e.nums),s.xt=n,s.nums=e.nums,o=e.nums?f(s.nums.split(" ")):"<b>等待开奖</b>",s.time=k(e.lessTime).join(":"),i=a.template('<p class="third-hd fs-12">第<span class="mlr5">'+r.no+"</span>期开奖号码："+o+'</p><div class="third-timer"><h5>第<b class="mlr5 fc-3"><%= qihao%></b>期等待开奖：</h5><p class="thired-timer-sp"><i class="icon icon-k303"></i><span id="j-wait-time"><%= time%></span></p></div>'),w.waitEndTime=e.lessTime,w.waitStartTime=e.lessTime,g(),void t("#j-kj-box").html(i(s));if(4===w.currentKjStatus){r=e.item[1],e.nums=r.kjhm,n=z(e.nums),s.xt=n,s.nums=e.nums,o=e.nums?"<br>形态: "+s.xt:'<b class="fc-3">等待开奖</b>';var c="",p=e.item[0].kjhm.split(" ");if(e.item[0].kjhm)for(var h=0;h<p.length;h++)c+='<i class="mlr2 icon icon-k3num'+p[h]+'"></i>';else c="等待开奖中..";return i=a.template('<p class="third-hd fs-12">第<span class="mlr5">'+r.no+"</span>期开奖号码："+f(s.nums.split(" "))+" "+o+'</p><div class="third-box clearfix"><p class="wait-p1">第<span class="fc-3 mlr5"><%= qihao%></span>期</p><p class="wait-p2 fs-yh">'+c+"</p></div>"),void t("#j-kj-box").html(i(s))}}}function g(){w.runWaitTimer=setInterval(function(){w.waitEndTime--,w.waitEndTime>0?t("#j-wait-time").html(k(w.waitEndTime).join(":")):(clearInterval(w.runWaitTimer),v())},1e3)}function k(t){var a=[],e=~~(t/60/60),s=~~(t/60%60),n=t%60;return 10>e&&(e=0>=e?null:"0"+e),10>s&&(s="0"+s),10>n&&(n="0"+n),e&&a.push(e),a.push(s,n),a}function T(a){var e=k(a),s="";3===e.length?(s='<i class="icon icon-k302">'+e[0]+'</i><i class="icon icon-k302">'+e[1]+'</i></i><i class="icon icon-k302">'+e[2]+"</i>",t("#j-less-seconds").addClass("active").html(s)):(s='<i class="icon icon-k302">'+e[0]+'</i><i class="icon icon-k302">'+e[1]+"</i>",t("#j-less-seconds").removeClass("active").html(s))}function _(a){a=0>a?0:a,T(a);var e=~~((new Date).getTime()/1e3),n=t("#j-dq-qihao").html();w.nextTimer=e+a,w.runTimer=setInterval(function(){var t=~~((new Date).getTime()/1e3),a=w.nextTimer-t;a>0?T(a):(T(0),w.alertQihao!==n&&(s.showTips("您好，第 "+n+"期已截止，投注时请确认您选择的期号。"),w.alertQihao=n),v(),w.runTimer&&clearInterval(w.runTimer),y())},1e3)}function C(t){var e=null;e=t&&a.isNumber(t)&&t>0?1e3*t:1e4;setTimeout(function(){y()},e)}function N(t){if(""===t)return t;var a=parseInt(t,10);return isNaN(a)?a=1:(a=a>=1?a:1,a=a),a=a>9999?9999:a}function q(t,a){var e=parseInt(t,10);return 1==a?e++:e--,e=e>=1?e:1,e=e>9999?9999:e}function B(a){var e=t("#project_mutiple");w.beishu=a,e.val(a),w.updateBottomUi()}function x(e){var s="";s='<tr><td colspan="5">系统繁忙， 请稍候再试</td></tr>',t(".br-details thead .br-zhui-bei").val(1),t.ajax({url:"/lottery/issue/get-issue-list?lottery_id="+w.lotyId+"&issue_size="+e,type:"GET",dataType:"json"}).done(function(e){var n=e.retData;if(1e5==e.retCode){a.isArray(n)&&n.length&&(s="");for(var i=0;i<n.length;i++){var o=i+1,r=w.getBuyArrTotalMoney();s+="<tr><td>"+o+'</td><td><input type="checkbox" class="br-zhui-c" data-qihaoid="'+n[i][0]+'"data-qi="'+n[i][1]+'" checked="">'+n[i][1]+'期</td><td><input type="text" class="br-input br-zhui-bei" value="1">倍</td><td><span class="j-money">'+r+'</span>元</td><td><span class="ml15">'+n[i][2]+"</span></td></tr>"}}t("#track_issue_list").html(s),w.updateTrackList()}).fail(function(){t("#track_issue_list").html(s),w.updateTrackList()})}function z(t){var a=[];if(t&&t.length>0){var e=Number(t[0].slice(1)),s=Number(t[1].slice(1)),n=Number(t[2].slice(1)),i=[e,s,n];i.sort(function(t,a){return t-a}),t[0].slice(0,1)===t[1].slice(0,1)&&t[1].slice(0,1)===t[2].slice(0,1)?(a.push("同花"),i[0]+i[2]===2*i[1]&&i[0]+1===i[1]&&(a=[],a.push("同花顺"))):i[0]+i[2]===2*i[1]&&i[0]+1===i[1]&&a.push("顺子"),i[0]===i[1]&&i[1]===i[2]?a.push("豹子"):(i[0]===i[1]||i[1]===i[2]||i[0]==i[2])&&a.push("对子")}else a="";return a}t("#j-klpk-track").mCustomScrollbar({theme:"3d-thick",scrollButtons:{enable:!0}});var A={};A.a=function(t){try{return 1==t||2==t?t:t*A.a(t-1)}catch(a){alert(a)}},A.getACTotalNum=function(t,a,e){if(t==a)return 1;if(a>t)return 0;a=2*a>t?t-a:a;var s=A.a(t)/A.a(t-a);return"A"===e?s:"C"===e?s/A.a(a):0};var w=function(){var e={lotyCnName:a.escape(t("#j-lotyCnName").val()),qihaoId:a.escape(t("#qihaoId").val()),qihao:a.escape(t("#qihao").val()),lotyName:t("#j-lotyName").val(),lotyId:t("#j-track-lotyid").val(),playType:"b1",chooseMoney:0,chooseZhushu:0,buyArr:[],playName:{b0:"包选",b1:"同花",b2:"顺子",b3:"同花顺",b4:"豹子",b5:"对子",b6:"任选一",b7:"任选二",b8:"任选三",b9:"任选四",b10:"任选五",b11:"任选六"},buyCodesType:{b0:"BX",b1:"TH",b2:"SZ",b3:"THS",b4:"BZ",b5:"DZ",b6:"R1",b7:"R2",b8:"R3",b9:"R4",b10:"R5",b11:"R6"},beishu:1,trackData:[],buyType:1,runTimer:null,kjStatus:0,currentKjStatus:null,runWaitTimer:null,waitEndTime:0,waitStartTime:0,alertQihao:null,waitSell:!1,modifyId:null,modifyStatu:0,showStopControl:!0};return e}();w.updateYilou=function(){var e=this;t.ajax({url:"/statistics/issue/yilou",type:"get",dataType:"json",data:{lottery_id:e.lotyId,issue:e.qihao}}).done(function(s){if(1e5===s.retCode){var n={b1:8,b2:10,b3:11,b4:9,b5:7,b6:1,b7:2,b8:3,b9:4,b10:5,b11:6};if(s.retData[n[e.playType]])for(var i=s.retData[n[e.playType]].split("|"),o=a.max(i),r=null,l=0;l<i.length;l++)r=i[l]===o?'<span class="fc-3">'+i[l]+"</span>":i[l],t(".j-choose-"+e.playType+" .j-yilou-num").eq(l).html(r)}})},w.runYilou=function(){var t=this;setInterval(function(){t.updateYilou()},1e4)},w.updateYilou(),w.runYilou(),w.reset=function(){var t=this;t.cleanNumBtn(),t.cleanBuyList(),t.buyArr=[],t.chooseMoney=0,t.chooseZhushu=0,t.beishu=1},w.updateBottomUi=function(){var a=this,e=0;e=a.getBuyArrTotalMoney(),t("#buy_zhushu").html(e/2),t("#project_price").html(a.beishu*e),a.updateTrackList()},w.setNameStr=function(t,a){var e="";if(a)for(var s=0;s<t.length;s++)e+="<span>"+a[t[s]]+"</span>";else for(var s=0;s<t.length;s++)e+="<span>"+t[s]+"</span>";return e},w.createOneNote=function(e,s){var n=this;n.saveNumsObj(e);var i=null,o={title:n.playName[e.playType],nums:e.nums,money:e.money,zid:e.zid,num:""};switch(n.playType){case"b0":i={"01":"同花包选","02":"顺子包选","03":"同花顺包选","04":"豹子包选","05":"同花包选"};break;case"b1":i={"01":"黑桃","02":"红心","03":"梅花","04":"方块",BX:"同花包选"};break;case"b2":i={"01":"A23","02":"234","03":"345","04":"456","05":"567","06":"678","07":"789","08":"8910","09":"910J",10:"10JQ",11:"JQK",12:"QKA",BX:"顺子包选"};break;case"b3":i={"01":"黑桃顺子","02":"红心顺子","03":"梅花顺子","04":"方块顺子",BX:"同花顺包选"};break;case"b4":i={"01":"AAA","02":"222","03":"333","04":"444","05":"555","06":"666","07":"777","08":"888","09":"999",10:"101010",11:"JJJ",12:"QQQ",13:"KKK",BX:"豹子包选"};break;case"b5":i={"01":"AA","02":"22","03":"33","04":"44","05":"55","06":"66","07":"77","08":"88","09":"99",10:"1010",11:"JJ",12:"QQ",13:"KK",BX:"对子包选"};break;default:i={"01":"A","02":"2","03":"3","04":"4","05":"5","06":"6","07":"7","08":"8","09":"9",10:"10",11:"J",12:"Q",13:"K"}}o.num=n.setNameStr(o.nums,i);var r=null,l=null;1!==n.modifyStatu||s?(r=a.template('<div data-zid="<%= zid%>" class="br-zhu-item clearfix"><b>[<%= title%>]</b><div class="list"><%= num%></div><div class="pull-right"><b class="moneytext"><i class="money"><%= money%></i>元</b><a href="javascript:;" class="br-zhu-up">修改</a><a href="javascript:;" class="br-zhu-del">删除</a></div></div>'),l=r(o),t("#code_list").append(l)):(r=a.template('<b>[<%= title%>]</b><div class="list"><%= num%></div><div class="pull-right"><b class="moneytext"><i class="money"><%= money%></i>元</b><a href="javascript:;" class="br-zhu-up">修改</a><a href="javascript:;" class="br-zhu-del">删除</a></div>'),l=r(o),t("#code_list").find("[data-zid="+n.modifyId+"]").html(l)),n.updateBottomUi()},w.addManyItem=function(t){var e=this;if(a.isNumber(t)&&t>0){if(e.buyArr.length+t>100)return void s.showTips("您的投注号码多于100行，请返回重新选择");for(var n=0;t>n;n++)e.createOneItem()}},w.createOneItem=function(){var t=this,e=[],s=null,n=[],i=1,o={b0:["01","02","03","04","05"],b1:["01","02","03","04"],b2:["01","02","03","04","05","06","07","08","09","10","11","12"],b3:["01","02","03","04"],b4:["01","02","03","04","05","06","07","08","09","10","11","12","13"],b5:["01","02","03","04","05","06","07","08","09","10","11","12","13"],b6:["01","02","03","04","05","06","07","08","09","10","11","12","13"]};switch(t.playType){case"b7":i=2;break;case"b8":i=3;break;case"b9":i=4;break;case"b10":i=5;break;case"b11":i=6}n=o[t.playType]?a.sample(o[t.playType],i).sort(function(t,a){return t-a}):a.sample(o.b6,i).sort(function(t,a){return t-a}),a.isArray(n)?e=n:e.push(n),s={zid:a.uniqueId(),nums:e,money:2,playType:t.playType},t.createOneNote(s,!0)},w.getObj=function(){var e=this,s=t("#j-area-"+e.playType+" .j-num-btn.active"),n=[],i={zid:a.uniqueId(),nums:null,money:null,playType:e.playType};return s.each(function(a,e){n.push(t(this).attr("data-num"))}),i.nums=n,i.money=e.chooseMoney,i},w.updateBuyArr=function(){var t=this,e=t.getObj();a.remove(t.buyArr,function(a){return a.zid==t.modifyId}),e.zid=t.modifyId,t.createOneNote(e),t.cleanNumBtn(),t.modifyStatu=0,t.toggleChooseToBuyBtn()},w.getChooseToBuy=function(){var t=this,a=t.getObj();t.createOneNote(a),t.cleanNumBtn()},w.saveNumsObj=function(t){var e=this;a.isArray(e.buyArr)||(e.buyArr=[]),e.buyArr.push({zid:t.zid,nums:t.nums,money:t.money,playType:t.playType})},w.cleanBuyList=function(){var a=this;a.buyArr=[],t("#code_list").html(""),a.updateBottomUi()},w.updateChooseToBuyBtn=function(){var a=this,e="active";a.chooseMoney>0?t("#choose_to_buy").addClass(e).removeAttr("disabled"):t("#choose_to_buy").removeClass(e)},w.setChooseParams=function(){var a=this,e=t("#j-area-"+a.playType+" .j-num-btn.active").length,s=null;switch(a.playType){case"b7":s=A.getACTotalNum(e,2,"C"),a.chooseZhushu=s,a.chooseMoney=2*s;break;case"b8":s=A.getACTotalNum(e,3,"C"),a.chooseZhushu=s,a.chooseMoney=2*s;break;case"b9":s=A.getACTotalNum(e,4,"C"),a.chooseZhushu=s,a.chooseMoney=2*s;break;case"b10":s=A.getACTotalNum(e,5,"C"),a.chooseZhushu=s,a.chooseMoney=2*s;break;case"b11":s=A.getACTotalNum(e,6,"C"),a.chooseZhushu=s,a.chooseMoney=2*s;break;default:a.chooseZhushu=e,a.chooseMoney=2*e}},w.updateMidTotal=function(){var a=this;a.setChooseParams(),t("#choose_zhushu").html(a.chooseZhushu),t("#choose_money").html(a.chooseMoney),a.updateChooseToBuyBtn()},w.cleanNumBtn=function(){var a=this;a.chooseMoney=0,a.chooseZhushu=0,t("#j-area-"+a.playType+" .j-num-btn").removeClass("active"),a.updateMidTotal()},w.updateHzBallList=function(e){var s=this,n=[[0,1,2,3,4,5,6],[1,3,5,7,9,11,13],[0,2,4,6,8,10,12],[7,8,9,10,11,12,13]],i=null,o=t("#j-area-"+s.playType+" .j-num-btn"),r="active";switch(e.length){case 1:i=n[e];break;case 2:i=a.intersection(n[e[0]],n[e[1]])}if(i){s.cleanNumBtn();for(var l=0;l<i.length;l++)o.eq(i[l]).addClass(r);s.updateMidTotal()}},w.updateCardGroup=function(e){var s=this;s.cleanNumBtn(),s.modifyId=e,s.modifyStatu=1;for(var n=a.find(s.buyArr,function(t){return t.zid==s.modifyId}),i=0;i<n.nums.length;i++)t("#j-area-"+s.playType+" [data-num="+n.nums[i]+"]").addClass("active");s.updateMidTotal(),s.toggleChooseToBuyBtn()},w.toggleChooseToBuyBtn=function(){var a=this,e=t("#choose_to_buy_tip");0===a.modifyStatu&&e.html("添加到投注列表"),1===a.modifyStatu&&e.html("确认修改")},w.removeBuyList=function(t){var e=this;a.remove(e.buyArr,function(a){return a.zid==t}),e.updateBottomUi()},w.togglePlayTab=function(){var t=this;t.cleanNumBtn(),t.cleanBuyList(),t.modifyStatu=0,t.toggleChooseToBuyBtn(),w.updateYilou()},w.getBuyArrTotalMoney=function(){for(var t=this,a=0,e=0;e<t.buyArr.length;e++)a+=~~t.buyArr[e].money;return a},w.buySuccess=function(t,a,n){var i=this;1e5==t.retCode?(e.set("lotyName",i.lotyName),e.set("lotyCNName",i.lotyCnName),e.set("payMoney",n),e.set("projectNo",t.retData.projectNo),e.set("trackId",t.retData.trackId),window.location.href="/html/lottery/trade/success.html"):s.handRetCode(t.retCode,t.retMsg)},w.enoughMoneyCb=function(a,e,s){var n=this;t.ajax({url:a,type:"post",dataType:"json",data:e}).done(function(t){n.buySuccess(t,e,s)})},w.getCodes=function(){for(var t=this,a=[],e="",s=[],n=0;n<t.buyArr.length;n++)a.push(t.buyCodesType[t.playType]+"|"+t.buyArr[n].nums.join(",")),s=s.concat(t.buyArr[n].nums);if("b2"==t.playType){a=[];for(var n=0;n<s.length;n++)a.push(t.buyCodesType[t.playType]+"|"+s[n])}return e=a.join("$")},w.buyLoty=function(){var e=this,n="",i={},o=e.getBuyArrTotalMoney(),r=(e.playName[e.playType],""),l=0,u="buy-self",c=0;switch(i.zhushu=o/2,i.beishu=e.beishu,i.unikey=t.now(),i.codes=e.getCodes(),r+='<div class="frbox"><img src="http://static3.yuncai.com/front_images/fail.png" alt="success" class="icon"><div class="text">',e.buyType){case 1:i.qihaoId=e.qihaoId,i.qihao=e.qihao,l=o*i.beishu,r+="<p>"+e.lotyCnName+" 第<span>"+i.qihao+"</span>期</p>",r+="<p>共<span>"+i.zhushu+"</span>注, 投注<span>"+i.beishu+"</span>倍</p>",r+='<p>本次需支付<span class="fc-3">'+l+".00</span>元</p></div>";break;case 2:c=t("#is_end_zhongjiang")[0].checked?1:0,u="buy-track",i.zhuihaoqihao=[];for(var p=0,h=e.trackData.length;h>p;p++)i.zhuihaoqihao.push(e.trackData[p].tid+"|"+e.trackData[p].qi+"|"+e.trackData[p].bs);i.endminmoney=c,l=e.getTrackTotalMoney(e.getBuyArrTotalMoney()),r+="<p>追号<span>"+e.trackData.length+'</span>期</p><p>本次需支付<span class="fc-3">'+l+"</span>元</p></div>";break;case 3:i.qihaoId=e.qihaoId,i.qihao=e.qihao,i.title=a.escape(t("#title").val()),i.textarea=a.escape(t("#desc").val()),i.shareNum=Number(t("#share-num").val()),i.buyNum=Number(t("#part_buy").val()),i.aegisNum=Number(t("#part_aegis_num").val()),i.extraPercent=t("#commission_percent").val(),i.set=a.escape(t(".br-set-group .br-set.active").html()),l=o/i.shareNum*(i.buyNum+i.aegisNum),r+="<p>"+e.lotyCnName+" 第<span>"+i.qihao+'</span>期</p><p>方案总金额<span class="fc-3">'+o+"</span>元</p><p>您认购<span>"+i.buyNum+"</span>份",r+=i.aegisNum>0?", 保底<span>"+i.aegisNum+'</span>份</p><p>共需支付<span class="fc-3">'+l+"</span>元</p>":'</p><p>共需支付<span class="fc-3">'+l+"</span>元</p>"}n="/lottery/kuaipin/"+u+"/"+e.lotyName+"/"+e.buyCodesType[e.playType];var d="";2===e.buyType?d+='<p>追号<span class="fc-3 mlr5">'+i.zhuihaoqihao.length+"</span>期</p>":(d+="<p>"+e.lotyCnName+' 第<span class="fc-3 mlr5">'+e.qihao+"</span>期</p>",d+='<p>共<span class="fc-3 mlr5">'+i.zhushu+'</span>注, 投注<span class="fc-3 mlr5">'+i.beishu+"</span>倍</p>"),d+='<p>本次需支付：<span class="fc-3 mlr5">'+l+".00</span>元",s.checkLogin(l,{enoughMoney:function(){s.showTips({text:r,title:"投注确认",type:2,onConfirm:function(){e.enoughMoneyCb(n,i,l)}})},lessMoneyTips:d})},w.onToggleBuyType=function(a){var e=this;e.buyType=a,e.beishu=1,t("#project_mutiple").val(1),e.updateBottomUi()},w.updateTrackList=function(){var a=this;a.trackData=[];var e=null,s=null,n=null,i=0,o=a.getBuyArrTotalMoney();t("#track_issue_list").find(".br-zhui-c").each(function(i,r){var l=t(this);e=l.attr("data-qihaoid"),s=~~l.parents("tr").find(".br-zhui-bei").val(),n=l.attr("data-qi"),r.checked&&a.trackData.push({tid:e,bs:s,qi:n}),l.parents("tr").find(".j-money").html(o*s)}),i=a.getTrackTotalMoney(o),t("#track_issue_num").html(a.trackData.length),t("#track_money").html(i)},w.getTrackTotalMoney=function(t){for(var a=this,e=0,s=0;s<a.trackData.length;s++)e+=t*a.trackData[s].bs;return e},t(".br-details").on("change","tbody .br-zhui-c",function(t){t.preventDefault(),w.updateTrackList()}),t(".br-details").on("change","thead .br-zhui-c",function(a){a.preventDefault(),t(this)[0].checked?t("#track_issue_list .br-zhui-c").each(function(a,e){t(this)[0].checked=!0}):t("#track_issue_list .br-zhui-c").removeAttr("checked"),w.updateTrackList()}),t(".br-details").on("change","thead .br-zhui-bei",function(a){var e=parseInt(t(this).val())||1;e=n(e),t(this).val(e),t(".br-details tbody .br-zhui-bei").val(e),w.updateTrackList()}),t(".br-details tbody").on("change",".br-zhui-bei",function(a){var e=parseInt(t(this).val())||1;e=n(e),t(this).val(e),w.updateTrackList()}),t("#j-sub-agreed").on("click",function(a){a.preventDefault(),t(this).toggleClass("icon-cka icon-ckd")}),t("#buy-submit").on("click",function(a){return a.preventDefault(),t("#j-sub-agreed").hasClass("icon-cka")?void(2===w.buyType&&0===w.trackData.length?s.showTips("追号最少购买一期"):0===w.buyArr.length?s.showTips("请至少选择1注号码投注"):w.buyLoty()):void s.showTips("请先阅读并同意《委托投注规则》后才能继续")}),t("#issue_size").on("change",function(a){a.preventDefault();var e=~~t(this).val();x(e)}),t("#increase_mutiple").on("click",function(a){var e=t("#project_mutiple"),s=e.val(),n=q(s,1);B(n)}),t("#decrease_mutiple").on("click",function(a){var e=t("#project_mutiple"),s=e.val(),n=q(s,0);B(n)}),t("#project_mutiple").on("keyup change",function(a){var e=t(this),s=(e.attr("data-r"),N(e.val()));s=s||1,B(s)}),t("#j-box-left").on("click",".j-zhu-adds",function(a){a.preventDefault();var e=~~t(this).attr("data-zhu");w.addManyItem(e)}),t("#j-box-left").on("click",".br-zhu-up",function(a){a.preventDefault();var e=t(this).parents(".br-zhu-item"),s=Number(e.attr("data-zid"));w.updateCardGroup(s)}),t("#j-box-left").on("click",".br-zhu-del",function(a){a.preventDefault();var e=t(this).parents(".br-zhu-item"),s=Number(e.attr("data-zid"));w.removeBuyList(s),e.remove(),w.modifyStatu=0,w.toggleChooseToBuyBtn()}),t("#j-nav").on("click","li",function(a){a.preventDefault();var e=t(this),s=e.attr("data-playtype");t("#j-nav li").removeClass("active"),e.addClass("active"),t(".box-choose").removeClass("active"),t(".j-choose-"+s).addClass("active"),w.playType=s,w.togglePlayTab()}),t("#j-box-left").on("click",".j-num-btn",function(a){a.preventDefault(),t(this).toggleClass("active"),w.updateMidTotal()}),t("#choose_to_buy").on("click",function(a){return a.preventDefault(),w.buyArr.length>=100?void s.showTips("您的投注号码多于100行，请返回重新选择"):void(t(this).hasClass("active")&&(1===w.modifyStatu?w.updateBuyArr():w.getChooseToBuy()))}),t("#clean_buy_code").on("click",function(t){t.preventDefault(),w.cleanBuyList(),1===w.modifyStatu&&(w.modifyStatu=0,w.toggleChooseToBuyBtn())}),t("#buy_type").on("click",".j-tog-tab",function(a){a.preventDefault();var e=t(this);t("#buy_type li .icon").removeClass("icon-y2"),e.find(".icon").addClass("icon-y2");var s=e.find("a"),n=~~s.attr("data-buytype"),i=s.attr("href");switch(t("#buy_type").siblings(".tab-content").find(".tab-pane").removeClass("active"),t(i).addClass("active"),w.onToggleBuyType(n),n){case 1:t("#track_desc").addClass("hide"),t("#buy_mutiple_span").show();break;case 2:t("#buy_mutiple_span").hide(),t("#track_desc").removeClass("hide"),x(10);break;case 3:t("#track_desc").addClass("hide"),t("#buy_mutiple_span").show(),l()}}),t("#j-touzhu-tips").on("click",function(a){t("#j-touzhu-tipstext").toggle(),t(this).find(".icon").toggleClass("icon-bup").toggleClass("icon-bdown")}),t("#j-kj-box").on("click",".third-more",function(a){a.preventDefault(),c();var e=t("#j-todaynum-table").offset().top;t("html, body").animate({scrollTop:e+"px"},300)}),t("#j-award-more").on("click",function(a){a.preventDefault(),t("#j-todaynum-table").hasClass("hide")?c():p()}),t("#j-content").on("click",".j-random",function(e){e.preventDefault(),w.cleanNumBtn();var s=t("#j-area-"+w.playType+" .j-num-btn"),n=s.length,i=[],o=1,r=null;switch(w.playType){case"b7":o=2;break;case"b8":o=3;break;case"b9":o=4;break;case"b10":o=5;break;case"b11":o=6}for(var l=0;n>l;l++)i.push(l);if(r=a.sample(i,o),1===o)s.eq(r).addClass("active");else for(var l=0;l<r.length;l++)s.eq(r[l]).addClass("active");w.updateMidTotal()}),t("#j-content").on("click",".j-all",function(a){a.preventDefault(),t("#j-area-"+w.playType+" .j-num-btn").addClass("active"),w.updateMidTotal()}),t("#j-content").on("click",".j-clear",function(t){t.preventDefault(),w.cleanNumBtn()}),t("#share-num").on("change",function(t){l()}),t("#part_buy").on("change",function(t){l()}),t("#commission_percent").on("change",function(a){var e=parseInt(t(this).val())||0,s=Math.floor(t("#part_buy_percent").html());e>s&&(t("#part_buy").val(Math.ceil(t("#commission_percent").val()/100*(t("#share-num").val()||0))),l())}),t("#has_part_aegis").on("change",function(a){t(this)[0].checked?t("#part_aegis_num").removeAttr("disabled"):(t("#part_aegis_num").attr("disabled","disabled"),t("#part_aegis_num").val(0),t("#part_aegis_percent").html("0.00")),l()}),t("#part_aegis_num").on("change",function(t){l()}),t(".br-set-group").on("click","a",function(a){t(this).parents(".br-set-group").find("a").removeClass("active"),t(this).toggleClass("active")}),t(".j-input-place").on("focus",function(a){i(t(this))}),t(".j-input-place").on("blur",function(a){o(t(this))}),t(".j-input-place").on("keyup",function(a){r(t(this))}),t("#is_end_zhongjiang").on("change",function(a){t(this)[0].checked?t("#track_stop_money").removeAttr("disabled"):(t("#track_stop_money").attr("disabled","disabled"),t("#part_aegis_num").val(0))}),h()});