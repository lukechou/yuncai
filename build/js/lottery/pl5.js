require.config({paths:{jquery:"../lib/jquery",lodash:"../lib/lodash.compat.min",bootstrap:"../lib/bootstrap.min",store:"../lib/store.min",app:"../common/app",core:"../lib/core",PL5:"../lottery/pl5_core"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"}}}),require(["jquery","lodash","store","app","PL5","bootstrap","core"],function(e,t,a,s,i){"use strict";function n(){o.init(),r.init()}var o={lotyName:"",lotyCNName:"排列5",playName:"",codes:[],zhushu:0,mutiple:1,money:0,qihaoId:0,isManual:!1,qihao:0,partnerBuy:{projectTitle:"排列5合买方案",projectDescription:"排列5",shareNum:0,partBuyNum:0,partAegisNum:0,commissionPercent:0,unitPrice:0,shareLevel:1},rowIndex:0,buyType:1,trackData:{issueMutipleMap:{},trackStopMoney:0},proxyBuy:{betNum:2,mutiple:1,issueSize:10},init:function(){this.lotyName=e("#lotyName").val(),this.playName=e("#playName").val(),this.codes=[],this.zhushu=0,this.mutiple=1,this.money=0,this.isManual=!1,this.qihaoId=e("#qihaoId").val(),this.qihao=e("#qihao").val(),this.partnerBuy={projectTitle:"排列5合买方案",projectDescription:"排列5",shareNum:0,partBuyNum:0,partAegisNum:0,commissionPercent:0,unitPrice:0,shareLevel:1},this.rowIndex=0,this.proxyBuy={betNum:2,multiple:1,issueSize:10}}},r={codes:[],zhushu:0,money:0,init:function(){this.codes=[],this.zhushu=0,this.money=0}},u={codeKey:-1,codeObj:{}};e(document).ready(function(){function l(){switch(e("#buy_type").find(".icon-y2").removeClass("icon-y2"),e("#buy_type").find(".icon").each(function(t,a){e(this).parents('a[data-toggle="tab"]').attr("data-buytype")==o.buyType&&e(this).addClass("icon-y2")}),e("#buy_type").siblings(".tab-content").find(".tab-pane").each(function(t,a){t==o.buyType-1?e(this).addClass("active"):e(this).removeClass("active")}),o.trackData.issueMutipleMap={},e("#buy_mutiple_span").show(),o.partnerBuy={projectTitle:"排列5合买方案",projectDescription:"排列5"},o.mutiple=1,e("#project_mutiple").val(o.mutiple),o.buyType){case 1:e("#track_desc").addClass("hide"),m();break;case 2:e("#buy_mutiple_span").hide(),e("#track_desc").removeClass("hide"),f(10),m();break;case 3:m(),e("#track_desc").addClass("hide"),e("#share-num").val(o.money),h()}}function c(t,a,s){var n=e("#j-nav li.active a").attr("href");switch(i.navPageType=s,e(n).removeClass("active"),e(t).addClass("active"),a.addClass("active"),a.siblings(".active").removeClass("active"),e("#choose_to_buy").attr("data-add","1"),e("#j_normal_choose_code").find(".j-num-group a").removeClass("active"),e("#sd_number").val(""),o.init(),r.init(),b(),d(),m(),o.proxyBuy.betNum=e("#bet_num_proxy").val(),o.proxyBuy.multiple=e("#mutiple_proxy").val(),o.proxyBuy.issueSize=e("#qihao_num_proxy").val(),e("#buy-submit").attr("disabled","disabled"),s){case 0:o.buyType=1,e("li.j-jx-zhus").show(),e("#j-box-right").show(),e("#j-box-bottom").show(),k(!1),e("#choose_to_buy").attr("disabled","disabled"),e("#j-box-left").removeClass("multiphase-box");break;case 1:o.buyType=1,e("li.j-jx-zhus").hide(),e("#j-box-right").show(),e("#j-box-bottom").show(),k(!1),e("#choose_to_buy").attr("disabled","disabled"),e("#j-box-left").removeClass("multiphase-box");break;case 2:o.buyType=4,_(),e("li.j-jx-zhus").show(),e("#j-box-right").hide(),e("#j-box-bottom").hide(),e("#j-box-left").addClass("multiphase-box")}l()}function p(t,a,s,i,n,r,u){var l=u*a||0,c=(s+u)*a||0;0===t&&(a=0),o.partnerBuy.shareNum=t,o.partnerBuy.partBuyNum=s,o.partnerBuy.unitPrice=a,o.partnerBuy.commissionPercent=parseInt(e("#commission_percent").val()),o.partnerBuy.partAegisNum=u,e("#share-num").val(t),e(".j-unit-price").html(a),e("#part_buy").val(s),e("#part_buy_percent").html(n),e("#part_aegis_num").val(u),e("#part_aegis_percent").html(r),e("#buy_money_tips").html(s*a),e("#aegis_money_tips").html(l),e("#total_money_tips").html(c)}function h(){var t=o.money,a=e("#share-num").val()||t,s="",i="",n=e("#part_buy").val(),r="",u=1*e("#commission_percent").val()||0,l="",c="",h=parseInt(e("#part_aegis_num").val())||0,d=e("#has_part_aegis")[0].checked||!1;return a=Number(a.replace(/[^0-9]/g,"")),n=Number(n.replace(/[^0-9]/g,"")),o.hemaiTotalMoney!==t&&(o.hemaiTotalMoney=t,a=t),0>=t?void p(0,u,0,0,0,0,0):(t%a===0?s=t/a:(s=1,a=t),0>=n&&(n=1),n>a&&(n=a),u>n/a*100&&(n=Math.ceil(a*u*.01)),i=n*s,e("#has_part_aegis")[0]&&(d=e("#has_part_aegis")[0].checked),d?(e("#part_aegis_num")[0].disabled=!1,l=0===h?.8>n/a?Math.ceil(.2*a):a-n:a>h+n?.2>h/a?Math.ceil(.2*a)+n>a?a-n:Math.ceil(.2*a):h:a-n,c=(l/a*100).toFixed(2)):(e("#part_aegis_num")[0].disabled=!0,l=0,c="0.00"),r=0===t?0:(n/a*100).toFixed(2),void p(a,s,n,u,r,c,l))}function d(){r.zhushu=0,r.money=0;for(var t=0,a=r.codes.length;a>t;t++){var s=r.codes[t][0]||[],n=r.codes[t][1]||[],o=r.codes[t][2]||[],u=r.codes[t][3]||[],l=r.codes[t][4]||[];if(s.length>0&&n.length>0&&o.length>0&&u.length>0&&l.length>0){var c=i.getZhiXuanZhushu(s,n,o,u,l);r.zhushu+=c,r.money+=2*c}}r.zhushu>0?(k(!0),e("#choose_to_buy").removeAttr("disabled")):(k(!1),e("#choose_to_buy").attr("disabled","disabled")),e("#choose_zhushu").html(r.zhushu),e("#choose_money").html(r.money)}function m(){for(var t=0,a=o.codes.length-1;a>=0;a--)t+=i.getZhiXuanZhushu(o.codes[a].value[0],o.codes[a].value[1],o.codes[a].value[2],o.codes[a].value[3],o.codes[a].value[4]);if(o.zhushu=t,o.money=2*t*o.mutiple,e("#buy_zhushu").html(o.zhushu),e("#project_price").html(o.money),e("#track_issue_num").html(0),e("#track_money").html(0),Object.size(o.trackData.issueMutipleMap)>0){var s=0;o.money=0;for(var n in o.trackData.issueMutipleMap){s++;var r=2*t*o.trackData.issueMutipleMap[n].mutiple;o.money+=r,e(".br-details").find("tbody .br-zhui-c").each(function(t,a){return e(this).attr("data-qihaoid")==n?void e(this).parents("tr").find(".j-money").html(r):void 0})}e("#track_issue_num").html(s),e("#track_money").html(o.money)}o.money>0?e("#buy-submit").removeAttr("disabled"):e("#buy-submit").attr("disabled","disabled")}function y(t){var a=t,n="";if(o.codes.length+r.codes.length>i.maxBuyCodeLength)return void s.showTips("您的投注号码多于"+i.maxBuyCodeLength+"行，请返回重新选择");for(var u=0;u<a.length;u++){o.rowIndex++,n+='<div class="br-zhu-item clearfix" dataBit='+o.rowIndex+'><b>[常规投注]</b><div class="list">';for(var l=0;l<a[u].length;l++)n+='<span data-c="0">'+a[u][l].join("")+"</span>";var c=2*i.getZhiXuanZhushu(a[u][0],a[u][1],a[u][2],a[u][3],a[u][4]);if(c>i.maxOneBetMoney)return s.showTips("您好，单个投注的金额应小于"+i.maxOneBetMoney+"元，请返回重新选择"),!1;var p=o.isManual?"":'<a href="javascript:;" class="br-zhu-set">修改</a>';n+='</div><div class="pull-right"><b><i class="money" data-m="1">'+c+"</i>元</b>"+p+'<a href="javascript:;" class="br-zhu-del">删除</a></div></div>',o.codes.push({key:o.rowIndex,value:a[u]})}return e("#code_list").append(n),!0}function v(t){e("#j_normal_choose_code").find(".j-num-group a").removeClass("active");var a={};for(var s in o.codes)if(o.codes[s].key==t){a=o.codes[s].value.concat();break}r.init(),r.codes[0]=a;for(var i=e("#j_normal_choose_code").find(".j-row-code"),n=0;5>n;n++){var u=a[n],l=u.length;i.each(function(t,a){if(t==n)for(var s=0;l>s;s++)e(this).find(".j-num-group a").each(function(t){parseInt(e(this).html())==u[s]&&e(this).addClass("active")})})}d()}function b(){e(".br-zhu-l").html(""),e("#sd-list").html(""),o.init(),m(),h()}function f(t){var a="";e(".br-details thead .br-zhui-bei").val(1),e.ajax({url:"/lottery/digital/query-track-issue/"+o.lotyName+"?num="+t,type:"GET",dataType:"json"}).done(function(t){if(1e5==t.retCode)for(var s=0;s<t.retData.length;s++){var i=s+1,n=2*o.zhushu;o.trackData.issueMutipleMap[t.retData[s].id]={qihao:t.retData[s].qihao,mutiple:1},a+="<tr><td>"+i+'</td><td><input type="checkbox" class="br-zhui-c" data-qihaoid="'+t.retData[s].id+'"data-qi="'+t.retData[s].qihao+'" checked="">'+t.retData[s].qihao+'期</td><td><input type="text" class="br-input br-zhui-bei" value="1">倍</td><td><span class="j-money">'+n+"</span>元</td><td>"+t.retData[s].awardTime.slice(0,10)+'<span class="ml15">'+t.retData[s].awardTime.slice(10)+"</span></td></tr>"}else a='<tr><td colspan="5">系统繁忙， 请稍候再试</td></tr>';e("#track_issue_list").html(a),m()}).fail(function(){a='<tr><td colspan="5">系统繁忙， 请稍候再试</td></tr>',e("#track_issue_list").html(a)})}function _(){e("#buy_bet_num_proxy").html(o.proxyBuy.betNum),e("#buy_multiple_proxy").html(o.proxyBuy.multiple),e("#buy_issue_num_proxy").html(o.proxyBuy.issueSize),o.money=2*o.proxyBuy.betNum*o.proxyBuy.multiple*o.proxyBuy.issueSize,o.mutiple=o.proxyBuy.multiple,e("#buy_money_proxy").html(o.money),o.money>0?e("#buy_button_proxy").removeAttr("disabled"):e("#buy_button_proxy").attr("disabled","disabled")}function g(e,t,a,s,i,n,o,r,u,l,c){var p='<div class="frbox"><img src="'+staticHostURI+'/front_images/fail.png" alt="success" class="icon"><div class="text">';switch(e){case 1:p+="<p>"+t+" 第<span>"+a+"</span>期</p>            <p>共<span>"+s+"</span>注, 投注<span>"+i+'</span>倍</p>            <p>本次需支付<span class="fc-3">'+n.toFixed(2)+"</span>元</p>";break;case 2:p+="<p>追号<span>"+u+'</span>期</p>            <p>本次需支付<span class="fc-3">'+l+"</span>元</p>";case 4:break;case 3:p+=r>0?"<p>"+t+" 第<span>"+a+'</span>期</p>              <p>方案总金额<span class="fc-3">'+n.toFixed(2)+"</span>元</p>              <p>您认购<span>"+o+"</span>份, 保底<span>"+r+'</span>份</p>              <p>共需支付<span class="fc-3">'+c.toFixed(2)+"</span>元</p>":"<p>"+t+" 第<span>"+a+'</span>期</p>              <p>方案总金额<span class="fc-3">'+n.toFixed(2)+"</span>元</p>              <p>您认购<span>"+o+'</span>份</p>              <p>共需支付<span class="fc-3">'+c.toFixed(2)+"</span>元</p>"}return p+='<div class="btns"><button class="btn btn-danger" id="buyConfirm">确定</button><button class="btn btn-gray" data-dismiss="modal">取消</button></div></div></div>'}function x(e,t,i,n,o,r,u){1e5==e?(a.set("lotyName",r),a.set("lotyCNName",u),a.set("payMoney",o),a.set("projectNo",i),a.set("trackId",n),window.location.href="/html/lottery/trade/success.html"):s.handRetCode(e,t)}function j(e,t){a.set("lotyName",e),a.set("lotyCNName",t),window.location.href="/html/lottery/trade/fail.html"}function k(t){var a=e("#choose_to_buy");t?a.addClass("active"):a.removeClass("active")}n(),e("#j-touzhu-tips").on("click",function(t){e(this).toggleClass("active"),e("#j-touzhu-tipstext").toggle()}),1==e("#saleStatus").val()&&(s.showStopSellModal("排列五"),e("#buy-submit,#buy_button_proxy").html("暂停销售").removeClass("btn-red").addClass("btn-stop").attr("id","")),e(".j-num-group").on("click","a",function(a){a.preventDefault();var s=parseInt(e(this).parents(".j-row-code").attr("data-bit")),i=null,n=e(this).html();"undefined"==typeof r.codes[0]&&(r.codes[0]=[]),"undefined"==typeof r.codes[0][s]&&(r.codes[0][s]=[]),i=r.codes[0][s].concat(),e(this).hasClass("active")?t.remove(i,function(e){return e==n}):i.push(n),r.codes[0][s]=i,r.codes[0][s].sort(),e(this).toggleClass("active"),d()}),e(".j-quick-method").on("click","span",function(t){t.preventDefault();var a=e(this);a.hasClass("active")?(a.removeClass("active"),a.siblings("span").removeClass("active")):(a.addClass("active"),a.siblings("span").removeClass("active"));var s=parseInt(e(this).parents(".j-row-code").attr("data-bit"));switch("undefined"==typeof r.codes[0]&&(r.codes[0]=[]),r.codes[0][s]=[],e(this).attr("data-type")){case"odd":e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).removeClass("active"),a.hasClass("active")?t%2!=0&&(e(this).addClass("active"),r.codes[0][s].push(parseInt(e(this).html()))):e(this).removeClass("active")});break;case"even":e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).removeClass("active"),a.hasClass("active")?t%2==0&&(e(this).addClass("active"),r.codes[0][s].push(parseInt(e(this).html()))):e(this).removeClass("active")});break;case"big":e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).removeClass("active"),a.hasClass("active")?t>=5&&(e(this).addClass("active"),r.codes[0][s].push(parseInt(e(this).html()))):e(this).removeClass("active")});break;case"small":e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).removeClass("active"),a.hasClass("active")?4>=t&&(e(this).addClass("active"),r.codes[0][s].push(parseInt(e(this).html()))):e(this).removeClass("active")});break;case"all":e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){a.hasClass("active")?(e(this).addClass("active"),r.codes[0][s].push(parseInt(e(this).html()))):e(this).removeClass("active")});break;case"clean":r.codes[0][s].length=0,e(this).parents(".j-row-code").find(".j-num-group a").each(function(t){e(this).removeClass("active")})}d(),console.log(r.codes[0][0])}),e("#choose_to_buy").on("click",function(a){if(e(this).hasClass("active")){var n=!1;switch(parseInt(e("#choose_to_buy").attr("data-add"))){case 0:var l=r.codes[0][0]||[],c=r.codes[0][1]||[],p=r.codes[0][2]||[],d=r.codes[0][3]||[],v=r.codes[0][4]||[];if(!(l.length>0&&c.length>0&&p.length>0&&d.length>0&&v.length>0))return;if(r.money>i.maxOneBetMoney)return s.showTips("您好，单个投注的金额应小于"+i.maxOneBetMoney+"元，请返回重新选择"),!1;for(var b in o.codes)o.codes[b].key==u.codeKey&&(o.codes[b].value=r.codes[0]);var f='<div class="br-zhu-item clearfix" databit="'+u.codeKey+'"><b>[常规投注]</b><div class="list"><span data-c="0">'+r.codes[0][0].join("")+'</span><span data-c="0">'+r.codes[0][1].join("")+'</span><span data-c="0">'+r.codes[0][2].join("")+'</span><span data-c="0">'+r.codes[0][3].join("")+'</span><span data-c="0">'+r.codes[0][4].join("")+'</span></div><div class="pull-right"><b><i class="money" data-m="1">'+r.money+'</i>元</b><a href="javascript:;" class="br-zhu-set">修改</a><a href="javascript:;" class="br-zhu-del">删除</a></div></div>';u.codeObj.replaceWith(f),n=!0;break;case 1:if(1===i.navPageType){var _=t.compact(e("#sd_number").val().replace(/，/gi,",").split("\n"));if(_.length>i.maxBuyCodeLength)return void s.showTips("您的投注号码多于"+i.maxBuyCodeLength+"行，请返回重新选择");r.init();for(var g=0;g<_.length;g++){var x=i.isIllegalCode(_[g],function(e,t){r.codes.push(e),r.zhushu+=t,r.money+=2*t});if(!x)return void s.showTips(i.getLastErrorMsg())}}for(var g=r.codes.length-1;g>=0;g--)if(!(r.codes[g][0].length>0&&r.codes[g][1].length>0&&r.codes[g][2].length>0&&r.codes[g][3].length>0&&r.codes[g][4].length>0))return;n=y(r.codes)}n&&(m(),h(),e("#choose_zhushu").html(0),e("#choose_money").html(0),e("#sd_number").val(""),e("#j_normal_choose_code").find(".j-num-group a").removeClass("active"),r.init(),e("#choose_to_buy_tip").html("添加到投注列表"),e("#choose_to_buy").attr("data-add",1),k(!1),e("#choose_to_buy").attr("disabled","disabled"))}}),e(".j-zhu-adds").on("click",function(t){t.preventDefault();var a=parseInt(e(this).attr("data-zhu"));if(o.codes.length+a>i.maxBuyCodeLength)return void s.showTips("您的投注号码多于"+i.maxBuyCodeLength+"行，请返回重新选择");for(var n=a-1;n>=0;n--)i.produceCode(function(e){r.zhushu=1,r.money=2,y([e])});m(),d(),h()}),e(".br-zhu-l").on("click",".br-zhu-item",function(t){t.preventDefault(),o.isManual||"A"!=t.target.tagName&&(v(e(this).attr("databit")),k(!0))}),e(".br-zhu-l").on("click",".br-zhu-del",function(a){e(this).parents(".br-zhu-item")[0]==u.codeObj[0]&&(e("#choose_to_buy").attr("data-add",1),e("#choose_to_buy_tip").html("添加到投注列表"));var s=e(this).parents(".br-zhu-item").attr("dataBit");t.remove(o.codes,function(e){return e.key==s}),e(this).parents(".br-zhu-item").remove(),m(),h()}),e(".br-zhu-l").on("click",".br-zhu-set",function(t){var a=e(this).parents(".br-zhu-item").attr("databit");v(a),k(!0),e("#choose_to_buy").attr("data-add",0),e("#choose_to_buy_tip").html("修改投注号码"),u={codeKey:a,codeObj:e(this).parents(".br-zhu-item")}}),e("#clean_buy_code").on("click",function(a){var s=o.buyType;e("#code_list").html(""),o.init(),m(),o.mutiple=Number(t.escape(e("#project_mutiple").val()))||1,o.buyType=s,h()}),e("#decrease_mutiple").on("click",function(t){t.preventDefault();var a=e("#project_mutiple"),s=parseInt(a.val());s--,o.mutiple=s<i.minMultiple?i.minMultiple:s>i.maxMultiple?i.maxMultiple:s,a.val(o.mutiple),m(),h()}),e("#project_mutiple").on("change",function(t){t.preventDefault();var a=parseInt(e(this).val())||0;o.mutiple=a<i.minMultiple?i.minMultiple:a>i.maxMultiple?i.maxMultiple:a,e(this).val(o.mutiple),m(),h()}),e("#increase_mutiple").on("click",function(t){t.preventDefault();var a=e("#project_mutiple"),s=parseInt(a.val());s++,o.mutiple=s<i.minMultiple?i.minMultiple:s>i.maxMultiple?i.maxMultiple:s,a.val(o.mutiple),m(),h()}),e("#buy-submit").on("click",function(t){return t.preventDefault(),e(this).parents(".br-tou").find(".j-sub-agreed")[0].checked===!1?void s.showTips("请先阅读并同意《委托投注规则》后才能继续"):void N()}),e("#buy_button_proxy").on("click",function(t){return t.preventDefault(),e(this).parents(".br-tou").find(".j-sub-agreed")[0].checked===!1?void s.showTips("请先阅读并同意《委托投注规则》后才能继续"):void N()}),e("#buy_type").on("click","a",function(t){t.preventDefault(),o.buyType=parseInt(e(this).attr("data-buytype")),l()}),e("#issue_size").on("change",function(t){t.preventDefault(),o.trackData.issueMutipleMap={},f(e(this).val())}),e(".br-details thead .br-zhui-c").on("change",function(t){var a=e(this)[0].checked;e(this).parents(".br-details").find("tbody .br-zhui-c").each(function(e,t){t.checked=a}),o.trackData.issueMutipleMap={},e(this).parents(".br-details").find("tbody .br-zhui-c").each(function(t,a){a.checked&&(o.trackData.issueMutipleMap[e(this).attr("data-qihaoid")]={qihao:e(this).attr("data-qi"),mutiple:e(this).parents("tr").find(".br-zhui-bei").val()})}),m()}),e(".br-details").on("change","tbody .br-zhui-c",function(t){t.preventDefault(),o.trackData.issueMutipleMap={},e(this).parents(".br-details").find("tbody .br-zhui-c").each(function(t,a){a.checked&&(o.trackData.issueMutipleMap[e(this).attr("data-qihaoid")]={qihao:e(this).attr("data-qi"),mutiple:e(this).parents("tr").find(".br-zhui-bei").val()})}),m()}),e(".br-details thead .br-zhui-bei").on("change",function(t){var a=parseInt(e(this).val())||1;isNaN(a)||1>a?a=1:(a=Math.ceil(a),a>9999&&(a=9999)),e(this).val(a);var s=e(this).parents(".br-details");s.find("tbody .br-zhui-bei").val(a),s.find("tbody .br-zhui-c").each(function(t,a){a.checked="checked",o.trackData.issueMutipleMap[e(this).attr("data-qihaoid")]={qihao:e(this).attr("data-qi"),mutiple:e(this).parents("tr").find(".br-zhui-bei").val()}}),m()}),e(".br-details tbody").on("change",".br-zhui-bei",function(t){var a=parseInt(e(this).val())||1;isNaN(a)||1>a?a=1:(a=Math.ceil(a),a>9999&&(a=9999)),e(this).val(a);var s=e(this).parents("tr"),i=s.find(".br-zhui-c");i.attr("checked","checked"),o.trackData.issueMutipleMap[i.attr("data-qihaoid")]={qihao:i.attr("data-qi"),mutiple:s.find(".br-zhui-bei").val()},m()}),e("#share-num").on("change",function(e){e.preventDefault(),h()}),e("#part_buy").on("change",function(e){e.preventDefault(),h()}),e("#commission_percent").on("change",function(t){t.preventDefault();var a=parseInt(e(this).val())||0,s=Math.floor(e("#part_buy_percent").html());a>s&&(e("#part_buy").val(Math.ceil(e("#commission_percent").val()/100*(e("#share-num").val()||0))),h()),o.partnerBuy.commissionPercent=a}),e("#has_part_aegis").on("change",function(e){e.preventDefault(),h()}),e("#part_aegis_num").on("change",function(e){e.preventDefault(),h()}),e(".br-set-group").on("click","a",function(t){switch(t.preventDefault(),e(this).parents(".br-set-group").find("a").removeClass("active"),e(this).toggleClass("active"),e(this).html()){case"截止后公开":o.partnerBuy.shareLevel=1;break;case"立即公开":o.partnerBuy.shareLevel=0;break;case"截止前对跟单人公开":o.partnerBuy.shareLevel=2}}),e("#title").on("change",function(t){t.preventDefault();var a=e(this).val(),s=a.length;o.partnerBuy.projectTitle=a;var i=20;s>=i&&(projectDescLength=i,o.partnerBuy.projectTitle=a.substring(0,i),e(this).val(o.partnerBuy.projectTitle)),e("#title_font_size").html(s)}),e("#title").on("keyup",function(t){t.preventDefault();var a=e(this).val(),s=a.length;o.partnerBuy.projectTitle=a;var i=20;s>=i&&(projectDescLength=i,o.partnerBuy.projectTitle=a.substring(0,i),e(this).val(o.partnerBuy.projectTitle)),e("#title_font_size").html(s)}),e("#desc").on("change",function(t){t.preventDefault();var a=e(this).val(),s=a.length;o.partnerBuy.projectDescription=a;var i=200;s>=i&&(s=i,o.partnerBuy.projectDescription=a.substring(0,i),e(this).val(o.partnerBuy.projectDescription)),e("#desc_font_size").html(s)}),e("#desc").on("keyup",function(t){t.preventDefault();var a=e(this).val(),s=a.length;o.partnerBuy.projectDescription=a;var i=200;s>=i&&(s=i,o.partnerBuy.projectDescription=a.substring(0,i),e(this).val(o.partnerBuy.projectDescription)),e("#desc_font_size").html(s)}),e("#is_end_zhongjiang").on("change",function(t){t.preventDefault(),e(this)[0].checked?e("#track_stop_money").removeAttr("disabled"):(e("#track_stop_money").attr("disabled","disabled"),e("#part_aegis_num").val(0))}),e("#track_stop_money").on("change",function(){event.preventDefault();var t=parseInt(e(this).val())||3e3;e(this).val(t)}),e("#j-textarea-mask").on("click",function(t){e(this).hide(),e("#sd_number")[0].focus(),e("#sd_number").addClass("focus")}),e("#sd_number").on("blur",function(t){t.preventDefault();var a=e.trim(e(this).val());""===a&&e("#j-textarea-mask").show()}),e("#sd_number").on("keyup blur",function(a){var s=t.compact(e(this).val().replace(/，/gi,",").split("\n"));e("#choose_zhushu").html(s.length),e("#choose_money").html(2*s.length),s.length?(k(!0),e("#choose_to_buy").removeAttr("disabled"),o.isManual=!0):(k(!1),e("#choose_to_buy").attr("disabled","disabled"))}),e("#j-nav").on("click","a",function(t){t.preventDefault();var a=e(this),i=Number(a.attr("data-pagetype")),n=e(this).attr("href"),r=a.parents("li");o.codes.length>=1?s.showTips({title:"友情提示",text:"切换玩法将会清空您的号码",type:2,onConfirm:function(){e("#myModal").modal("hide"),e(".br-details").find("tbody .br-zhui-c").each(function(e,t){a.parents("tr").find(".j-money").html(0)}),c(n,r,i),e("#choose_to_buy_tip").html("添加到投注列表"),e("#choose_to_buy").attr("data-add",1)}}):c(n,r,i)}),e("#decrease_bet_num_proxy").on("click",function(t){t.preventDefault();var a=e("#bet_num_proxy"),s=parseInt(a.val());s--,o.proxyBuy.betNum=s<i.minBetNum?i.minBetNum:s>i.maxBetNum?i.maxBetNum:s,a.val(o.proxyBuy.betNum),_()}),e("#bet_num_proxy").on("change",function(){var t=parseInt(e(this).val())||0;o.proxyBuy.betNum=t<i.minBetNum?i.minBetNum:t>i.maxBetNum?i.maxBetNum:t,e(this).val(o.proxyBuy.betNum),_()}),e("#increase_bet_num_proxy").on("click",function(t){t.preventDefault();var a=e("#bet_num_proxy"),s=parseInt(a.val());s++,o.proxyBuy.betNum=s<i.minBetNum?i.minBetNum:s>i.maxBetNum?i.maxBetNum:s,a.val(o.proxyBuy.betNum),_()}),e("#decrease_mutiple_proxy").on("click",function(t){t.preventDefault();var a=e("#mutiple_proxy"),s=parseInt(a.val());s--,o.proxyBuy.multiple=s<i.minMultiple?i.minMultiple:s>i.maxMultiple?i.maxMultiple:s,a.val(o.proxyBuy.multiple),_()}),e("#mutiple_proxy").on("change",function(){var t=parseInt(e(this).val())||0;o.proxyBuy.multiple=t<i.minMultiple?i.minMultiple:t>i.maxMultiple?i.maxMultiple:t,e(this).val(o.proxyBuy.multiple),_()}),e("#increase_mutiple_proxy").on("click",function(t){t.preventDefault();var a=e("#mutiple_proxy"),s=parseInt(a.val());s++,o.proxyBuy.multiple=s<i.minMultiple?i.minMultiple:s>i.maxMultiple?i.maxMultiple:s,a.val(o.proxyBuy.multiple),_()}),e("#decrease_qihao_num_proxy").on("click",function(t){t.preventDefault();var a=e("#qihao_num_proxy"),s=parseInt(a.val());s--,o.proxyBuy.issueSize=s<i.minIssueNum?i.minIssueNum:s>i.maxIssueNum?i.maxIssueNum:s,a.val(o.proxyBuy.issueSize),_()}),e("#qihao_num_proxy").on("change",function(){var t=parseInt(e(this).val())||0;o.proxyBuy.issueSize=t<i.minIssueNum?i.minIssueNum:t>i.maxIssueNum?i.maxIssueNum:t,e(this).val(o.proxyBuy.issueSize),_()}),e("#increase_qihao_num_proxy").on("click",function(t){t.preventDefault();var a=e("#qihao_num_proxy"),s=parseInt(a.val());s++,o.proxyBuy.issueSize=s<i.minIssueNum?i.minIssueNum:s>i.maxIssueNum?i.maxIssueNum:s,a.val(o.proxyBuy.issueSize),_()}),o.hemaiTotalMoney=0;var N=function(){for(var t="",a=[],i=0;i<o.codes.length;i++){for(var n=[],r=0;r<o.codes[i].value.length;r++)n.push(o.codes[i].value[r].join(""));a.push(n.join(","))}var u={zhushu:o.zhushu,beishu:o.mutiple,codes:a.join("$"),unikey:(new Date).valueOf()},l="",c=0;switch(o.buyType){case 1:t="/lottery/digital/buy-self/"+o.lotyName+"/"+o.playName,u.qihaoId=o.qihaoId,u.qihao=o.qihao,l=g(1,o.lotyCNName,u.qihao,o.zhushu,o.mutiple,o.money,0,0,0,0),c=o.money;break;case 2:t="/lottery/digital/buy-track/"+o.lotyName+"/"+o.playName;var p=[];for(var h in o.trackData.issueMutipleMap)p.push(h+"|"+o.trackData.issueMutipleMap[h].qihao+"|"+o.trackData.issueMutipleMap[h].mutiple);if(p.length<1)return void s.showTips("追号最少购买一期");e("#is_end_zhongjiang")[0].checked&&(o.trackData.trackStopMoney=e("#track_stop_money").val()),u.endminmoney=o.trackData.trackStopMoney,u.zhuihaoqihao=p,l=g(2,o.lotyCNName,0,0,0,0,0,0,p.length,o.money),c=o.money;break;case 3:if(t="/lottery/digital/buy-together/"+o.lotyName+"/"+o.playName,u.qihaoId=o.qihaoId,u.qihao=o.qihao,u.title=o.partnerBuy.projectTitle,u.textarea=o.partnerBuy.projectDescription,u.shareNum=o.partnerBuy.shareNum,u.buyNum=o.partnerBuy.partBuyNum,u.aegisNum=o.partnerBuy.partAegisNum,u.extraPercent=o.partnerBuy.commissionPercent,u.set="undefined"==typeof o.partnerBuy.shareLevel?1:o.partnerBuy.shareLevel,u.rengouMoney<1)return void s.showTips("合买至少认购一元");var d=o.partnerBuy.unitPrice*u.buyNum,m=o.partnerBuy.unitPrice*u.aegisNum;c=d+m,l=g(3,o.lotyCNName,u.qihao,u.zhushu,u.beishu,o.money,u.buyNum,u.aegisNum,0,0,c);break;case 4:t="/lottery/digital/buy-rank/"+o.lotyName+"/"+o.playName,u.zhushu=o.proxyBuy.betNum,u.beishu=o.proxyBuy.multiple,u.qishu=o.proxyBuy.issueSize,l=g(2,o.lotyCNName,0,0,0,0,0,0,u.qishu,o.money),c=o.money}var y="";switch(o.buyType){case 1:y+="<p>"+o.lotyCNName+' 第<span class="fc-3 mlr5">'+u.qihao+"</span>期</p>",y+='<p>共<span class="fc-3 mlr5">'+u.zhushu+'</span>注, 投注<span class="fc-3 mlr5">'+u.beishu+"</span>倍</p>";break;case 2:y+='<p>追号<span class="fc-3 mlr5">'+p.length+"</span>期</p>";break;case 3:y+="<p>"+o.lotyCNName+' 第<span class="fc-3 mlr5">'+u.qihao+"</span>期</p>",y+='<p>方案总金额<span class="fc-3 mlr5">'+o.money+".00</span>元</p>",y+='<p>您认购<span class="fc-3 mlr5">'+u.buyNum+'</span>份, 保底<span class="fc-3 mlr5">'+u.aegisNum+"</span>份</p>";break;case 4:y+='<p>多期投注：共<span class="fc-3 mlr5">'+u.zhushu+'</span>注，<span class="fc-3 mlr5">'+u.beishu+'</span>倍，<span class="fc-3 mlr5">'+u.qishu+"</span>期</p>"}y+='<p>本次需支付：<span class="fc-3 mlr5">'+c+".00</span>元",s.checkLogin(c,{enoughMoney:function(){s.showTips({html:l,title:"投注确认"}),e("#buyConfirm").one("click",function(a){e.ajax({url:t,type:"POST",dataType:"json",data:u}).done(function(e){return 1e5!==e.retCode?void s.showTips(e.retMsg):void x(e.retCode,e.retMsg,e.retData.projectNo,e.retData.trackId,c,o.lotyName,o.lotyCNName)}).fail(function(){j(o.lotyName,o.lotyCNName)})})},lessMoneyTips:y})}})});