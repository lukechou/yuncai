require.config({paths:{jquery:"../lib/jquery",lodash:"../lib/lodash.compat.min",bootstrap:"../lib/bootstrap.min",store:"../lib/store.min",app:"../common/app",scroll:"../lib/jquery.mCustomScrollbar.concat.min",tipsy:"../lib/jquery.tipsy",core:"../lib/core",betting:"betting",hemai:"hemai",scrollUp:"scrollUp"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"},scroll:{deps:["jquery"],exports:"jquery"},tipsy:{deps:["jquery"],exports:"jquery"},scrollUp:{deps:["jquery"],exports:"jquery"}}}),require(["jquery","lodash","betting","app","store","hemai","bootstrap","scroll","tipsy","core","scrollUp"],function(t,a,s,e,o,i){"use strict";function l(){if(1==serverTime?(e.showStopSellModal(Config.lotyCNName),t("#j-ljtzBtn,#j-fqhmBtn").addClass("btn-stop").html("暂停销售"),t("#j-ljtzBtn").attr("id",""),t("#j-fqhmBtn").remove(),t("#j-data-body .data-loadbox").html(Config.lotyCNName+" 暂停销售")):(u(),v.init(),y.init()),t(".icon").tipsy({gravity:"nw",html:!0,opacity:1}),t("#poolStep1 .scrollMoni").mCustomScrollbar({theme:"light-3",mouseWheelPixels:200}),t("#j-ball-table").mCustomScrollbar({theme:"light-3",mouseWheelPixels:200}),t("#j-show-option").hover(function(){t(this).addClass("hovered"),t("#gameSeleList").show()},function(){t(this).removeClass("hovered"),t("#gameSeleList").hide()}),t("#gameSeleList").on("click","li",function(e){var o=t(this),i=a.escape(t.trim(o.text())),l="active";o.hasClass(l)?(a.remove(s.collect,function(t){return t===i}),o.removeClass(l),n(!0)):(s.collect.push(i),o.addClass(l),n(!1))}),t("#j-match-collect").on("click",function(a){var s=[];t("#gameSeleList .icon").hasClass("icon-cgou")?(t("#gameSeleList li.active").each(function(a,e){s.push(t.trim(t(this).text()))}),t("#gameSeleList").hide(),b(s),o.set("startArr",s)):o.clear("startArr")}),t("#gameSeleList").on("click",".icon",function(a){var s=t(this);s.toggleClass("icon-cbox").toggleClass("icon-cgou")}),t("#j-changeTime").hover(function(){t(this).addClass("hovered"),t(this).find(".optionList").show()},function(){t(this).removeClass("hovered"),t(this).find(".optionList").hide()}),t("#j-changeTime .optionList").on("click","a",function(a){var s=t(this).attr("data-timeType");t("#j-changeTime .optionList a").removeClass("active"),t(this).addClass("active"),t("#j-changeTimeText").html(t(this).html()),t(".dataBody dd").each(function(a,e){var o=t(this).attr(s);t(this).find(".co3 .jtip").html(o)})}),t(".j-bd-mid").on("click",function(e){e.preventDefault();var o=t(this),i=Number(o.attr("data-ac")),l=a.escape(o.attr("data-method"));i?(o.removeClass("icon-bd2").addClass("icon-bd"),o.attr("data-ac",0),j[l+"Show"]=!1,"stop"===l&&(j[s.tab+"StopStatus"]=!1)):(o.removeClass("icon-bd").addClass("icon-bd2"),o.attr("data-ac",1),j[l+"Show"]=!0,"stop"===l&&(j[s.tab+"StopStatus"]=!0)),r(),c(),"spf"===s.tab?j.rqspfShow&&j.stopShow&&j.spfShow?(t("#j-toggle-allmatch").attr("data-status",0),t("#j-toggle-allmatch").text("隐藏全部场次")):(t("#j-toggle-allmatch").attr("data-status",1),t("#j-toggle-allmatch").text("显示全部场次")):j.stopShow?(t("#j-toggle-allmatch").attr("data-status",0),t("#j-toggle-allmatch").text("隐藏全部场次")):(t("#j-toggle-allmatch").attr("data-status",1),t("#j-toggle-allmatch").text("显示全部场次"))}),t("#j-toggle-allmatch").on("click",function(a){a.preventDefault();var e=t(this),o=Number(e.attr("data-status")),i=t(".j-bd-mid"),l=["显示全部场次","隐藏全部场次"],n=["icon-bd2","icon-bd"],d=o?0:1;"spf"===s.tab?(j.rqspfShow=o,j.spfShow=o):o?t(".j-data-dd").show():t(".j-data-dd").hide(),j.stopShow=o,r(),i.attr("data-ac",o),e.attr("data-status",d),e.text(l[o]),i.removeClass(n[o]).addClass(n[d]),c()}),"bjdc"===Config.lotyName){var i=jczqData;s.allMatch=0,s.expiredMatch=0,s.rqMatch=0,s.norqMatch=0,s.hideMatch=0;for(var l in i)if(i.hasOwnProperty(l)){s.allMatch+=i[l].length;for(var d=i[l].length-1;d>=0;d--)1==i[l][d].is_expired&&s.expiredMatch++,0===Number(i[l][d].rqspf_rangqiu_num)?s.norqMatch++:s.rqMatch++}s.hideMatch=s.expiredMatch,c(),t("#j-gg-tab").on("click","li",function(a){var e=t(this),o=Number(e.attr("data-bunch")),i=["请选择至少一场比赛进行投注","请选择至少两场比赛进行投注"];e.hasClass("active")||(s.bunch=[],s.setAllTotal()),t("#j-gg-tab li").removeClass("active"),e.addClass("active"),t(".j-unselect-tips").html(i[o]),o?(s.bjdcPassWay=!1,s.setBjdcBox()):(s.bjdcPassWay=!0,s.setSecondBox())})}}function n(o){var i=s.collect,l=t("#j-game-select"),n=t("#j-collect-body"),c=[],r=[];o&&n.find(".j-data-dd").each(function(a,s){var e=t(this).attr("matchcode"),o=t(this).html();t("#j-game-select .j-data-dd[matchcode="+e+"]").html(o)}),t("#j-collect-body dl").remove(),i.length>0?n.show():n.hide(),t("#j-game-select .j-data-dd").each(function(e,o){{var n=t(this),r=(n.hasClass("j-bf-box"),n.attr("matchcode"));n.parents("#j-collect-body").length}if(a.indexOf(i,n.attr("leaguename"))<0){if(l.find(".j-data-dd[matchcode="+r+"]").show(),l.find(".j-bf-box[matchcode="+r+"]").show(),("hhtz"===s.tab||"bf"===s.tab)&&n.find(".j-sp-btn.active").length>0){var r=n.attr("matchcode"),d=t("#j-data-body .j-data-dd[matchcode="+r+"]");d.find(".j-show-hhtz,.j-show-bf").addClass("has"),d.find(".row1-1").removeClass("on")}}else{if(c.push(n.clone()),n.hide(),"bf"===s.tab){var h=t("#j-data-body .j-bf-box[matchcode="+r+"]");h.length>0&&(c.push(h.clone()),h.hide())}if("hhtz"===s.tab){var p=t("#j-data-body .hhtz-box[matchcode="+r+"]");p.length>0&&(c.push(p.clone()),p.hide())}}}),r=a.groupBy(c,function(t){return t.attr("data-time")});var d="",h="12:00",p="",m=0;"bjdc"===Config.lotyName&&(h="10:00");for(var u in r)if(r.hasOwnProperty(u)){p=e.dateFormat(new Date(1e3*u),"%Y-%M-%d",!0)+" "+r[u][0].attr("matchnumcn").replace("d/g",""),d+="<dl><dt>"+p+"("+h+" -- 次日"+h+')<span class="matchSize">'+r[u].length+'</span>场比赛可投注<span class="cuspText fc-84 j-dataBody-toggle pull-right" data-show="1"><span class="j-nav-text">隐藏</span><i class="icon show-icon"></i></span></dt>';for(var f=0;f<r[u].length;f++)d+=r[u][f][0].outerHTML;d+="</dl>",m+=r[u].length}n.append(d),n.find(".j-data-dd").show(),t("#j-data-body dl").each(function(a,s){var e=0;t(this).find(".j-data-dd").each(function(a,s){t(this).is(":hidden")||e++}),e?(t(this).find("dt").show(),t(this).find(".j-match-size").html(e)):t(this).find("dt").hide()}),t("#j-match-total").html(m)}function c(){var a=0;t(".j-data-dd").each(function(s,e){t(this).is(":hidden")&&a++}),t("#j-bjdc-all").html(a),t("#j-bjdc-stop").html(s.expiredMatch),t("#j-bjdc-rq").html(s.rqMatch),t("#j-bjdc-norq").html(s.norqMatch)}function r(){if("spf"===s.tab&&(j.spfShow?s.box.find(".isRqspfShow").show():s.box.find(".isRqspfShow").hide(),j.rqspfShow?s.box.find(".isSpfShow").show():s.box.find(".isSpfShow").hide()),j.stopShow?s.box.removeClass("bjdc"):s.box.addClass("bjdc"),"bjdc"===Config.lotyName&&s.collect)for(var a=0;a<s.collect.length;a++)t("#j-data-body .j-data-dd[leaguename="+s.collect[a]+"]").hide()}function d(t,a){for(var e=[],o=[],i="",l=null,n=s.tab,c="",r=0,d=t.length;d>r;r++){if(l=t[r],c=1==l[n]?'<button class="btn j-show-bf"></button>':'<b class="no-support">本场对阵不支持该玩法</b>',o=h(l,a),e=e.concat(o),"bf"===n?e.push('<span class="row1 row1-1">'+c+"</span></dd>"):i=s.craeteDateBtn(l[n],l[n+"_gg_sp"]),"rqspf"===n){var p="";p=Number(l.rqspf_rangqiu_num),p>0&&(p='<b class="fc-7">'+l.rqspf_rangqiu_num+"</b>"),0>p&&(p='<b class="fc-3">'+l.rqspf_rangqiu_num+"</b>"),e.push('<span class="co6-1 btnBox towLine "><div class="line1 "><em class="rq">'+p+"</em>"+i+"</div></span></dd>")}if("spf"===n){var m=0;"bjdc"===Config.lotyName&&(m=Number(l.rqspf_rangqiu_num),m>0&&(m='<b class="fc-7">'+l.rqspf_rangqiu_num+"</b>"),0>m&&(m='<b class="fc-3">'+l.rqspf_rangqiu_num+"</b>")),e.push('<span class="co6-1 btnBox towLine "><div class="line1 "><em class="rq">'+m+"</em>"+i+"</div></span></dd>")}"bqc"===n&&e.push('<span class="row2 row2-1">'+i+"</span></dd>"),"zjq"===n&&e.push('<span class="row3 row3-1">'+i+"</span></dd>"),"sxds"===n&&e.push('<span class="row5">'+i+"</span></dd>")}return e.join("")}function h(t,a){var s="";"bjdc"===Config.lotyName&&1==t.is_expired&&(s="bjdc-expired");var e=[],o="isSpfShow";return 0!==Number(t.rqspf_rangqiu_num)&&(o="isRqspfShow"),e.push('<dd data-time="'+a+'" isstop="0" matchcode="'+t.match_key+'" matchnumcn="'+t.week+t.game_order+'" starttime="'+t.game_start_time+'" endtime="'+t.end_time+'" isdg="0,1,0,0,0" hostname="'+t.home_short+'" guestname="'+t.away_short+'" leaguename="'+t.league+'" class="j-data-dd '+s+" "+o+'">'),e.push('<span class="co1"><i class="jtip" inf="'+t.week+t.game_order+'">'+t.game_order+"</i></span>"),e.push('<span class="co2" style="background:'+t.league_color+';">'+t.league+"</span>"),e.push('<span class="co3 gameTime"><i class="jtip">'+t.end_time+"</i></span>"),e.push('<span class="co4"><em class="hostTeam" title="'+t.home_short+'"><b>'+t.home_short+'</b></em><em class="guestTeam" title="'+t.away_short+'"><b>'+t.away_short+"</b></em></span>"),e}function p(t){var a="",e="",o=t.spf_gg_sp.split("|"),i=["胜","平","负"],l=t.rqspf_gg_sp.split("|"),n=["让球胜","让球平","让球负"],c="本场对阵不支持该玩法";return a=Number(t.rqspf_rangqiu_num),a>0&&(a='<b class="fc-7">'+t.rqspf_rangqiu_num+"</b>"),0>a&&(a='<b class="fc-3">'+t.rqspf_rangqiu_num+"</b>"),e+='<span class="row4-1"><em class="rq">0</em>',e+=1==t.spf?s.getSpBtn(t.spf,i,o,"spf"):c,e+="</span>",e+='<span class="row4-1"><em class="rq">'+a+"</em>",e+=1==t.rqspf?s.getSpBtn(t.rqspf,n,l,"rqspf",3):c,e+="</span>",e+='<em class="tg-data j-show-hhtz">展开'+s.hhtzIconHtml+"</em></dd>"}function m(t,a){if(!t)return"";for(var s=[],e=[],o=null,i=0,l=t.length;l>i;i++)o=t[i],e=h(o,a),s=s.concat(e),s.push(p(o));return s.join("")}function u(){var a="";for(var s in jczqData)jczqData.hasOwnProperty(s)&&(a+=f(jczqData[s],s));0==serverTime?t("#j-data-body").html(a):t("#j-data-body .data-loadbox").html(Config.lotyCNName+" 暂停销售")}function f(t,a){var o=e.dateFormat(new Date(1e3*a),"%Y-%M-%d",!0)+" "+t[0].week,i=t.length,l="",n="12:00";return"bjdc"===Config.lotyName&&(n="10:00"),l+="<dl><dt>"+o+"("+n+" -- 次日"+n+')<span class="j-match-size matchSize">'+i+'</span>场比赛可投注<span class="cuspText fc-84 j-dataBody-toggle pull-right" data-show="1"><span class="j-nav-text">隐藏</span><i class="icon show-icon"></i></span></dt>',l+="hhtz"===s.tab?m(t,a):d(t,a),l+="</dl>"}function b(a){var s=t(".j-dataBody-toggle");0==a.length?s.html("展开").attr("data-show",0):s.html("隐藏").attr("data-show",1)}function g(t,a,s){var o="";o+="<p>"+Config.lotyCNName+"</p>",s?(o+='<p>方案总金额<span class="fc-3 mlr5">'+a.zhushu*a.beishu*2+".00</span>元</p>",o+='<p>您认购<span class="fc-3 mlr5">'+a.buyNum+'</span>份, 保底<span class="fc-3 mlr5">'+a.aegisNum+"</span>份</p>"):o+='<p>共<span class="fc-3 mlr5">'+a.zhushu+'</span>注，<span class="fc-3 mlr5">'+a.beishu+"</span>倍",o+='<p>本次需支付：<span class="fc-3 mlr5">'+Config.payMoney+".00</span>元",e.checkLogin(Config.payMoney,{enoughMoney:t,lessMoneyTips:o})}var j={spfShow:!0,rqspfShow:!0,stopShow:!1},v=function(){var a={el:t("#scrollUp"),init:function(){t.scrollUp({scrollText:'<div class="scroll-icon"><i class="icon icon-link-top"></i></div><div class="scroll-text">返回顶部</div>'}),this.el.hover(function(){t(this).addClass("active")},function(){t(this).removeClass("active")})}};return a}(),y=function(){var a={el:t(".j-navbar-wrapper"),top:300,init:function(a){var s=this;if(a)for(var e in a)a.hasOwnProperty(e)&&(s[e]=a[e]);t(window).scrollTop(0),t(window).scroll(function(a){var e=t(this).scrollTop();e>s.top?s.isMoreTop(e):s.isLessTop()})},isLessTop:function(){{var a=this,s=a.el.eq(1);t("body").height(),s.height(),t(".ft").height()}a.el.css({position:"relative",top:0}),a.el.eq(0).removeClass("active")},isMoreTop:function(a){var s=this,e=0,o=t("#bettingBox").height()+s.top,i=s.el.eq(0),l=s.el.eq(1),n=50,c=l.height(),r=t("body").height(),d=t(window).height(),h=t(".ft").height();o>a?(i.addClass("active"),s.el.css({position:"fixed",top:e}),c>d?l.css({position:"relative",top:0}):a+c+h+n>r&&l.css({position:"absolute",top:r-h-c-40})):(i.removeClass("active"),s.isLessTop())}};return a}();l(),t("#j-vote-nav").on("click","a",function(a){var e=t(this).attr("data-type"),o=(t(this).attr("data-game"),"bettingBox clearfix "+e);if("bjdc"===Config.lotyName&&(o="bettingBox bjdc clearfix "+e),t("#j-vote-nav .active").removeClass("active"),t(this).parents("li").addClass("active"),s.tab=t(this).attr("data-game"),s.box.removeClass().addClass(o),s.clearBetData(),"bjdc"===Config.lotyName&&"spf"===s.tab?t(".j-bd-spf").show():t(".j-bd-spf").hide(),u(),"bjdc"===Config.lotyName){var i=j[s.tab+"StopStatus"],l=t(".j-bd-mid").eq(2);j.stopShow=i,r(),i?(l.attr("data-ac",1),l.removeClass("icon-bd").addClass("icon-bd2"),t("#j-toggle-allmatch").attr("data-status",0),t("#j-toggle-allmatch").text("隐藏全部场次")):(l.attr("data-ac",0),l.removeClass("icon-bd2").addClass("icon-bd"),t("#j-toggle-allmatch").attr("data-status",1),t("#j-toggle-allmatch").text("显示全部场次")),c()}t("#j-collect-body .j-data-dd").remove(),n()});var w=function(i,l,n){var c="jingcai",r="";"bjdc"===n?(c="bjdc",i.qihaoId=a.escape(t.trim(t("#j-qihao-id").val())),i.qihao=a.escape(t.trim(t("#j-qihao").val()))):r="_gg",i.unikey=t.now(),t.ajax({url:"/lottery/"+c+"/"+l+"/"+n+"/"+s.tab+r,type:"POST",dataType:"json",data:i}).done(function(t){1e5==t.retCode?(o.set("lotyName",Config.lotyName),o.set("payMoney",Config.payMoney),o.set("projectNo",t.retData.projectNo),o.set("lotyCNName",Config.lotyCNName),window.location.href="/html/lottery/trade/success.html"):e.handRetCode(t.retCode,t.retMsg)}).fail(function(){e.onServiceFail()})},q=function(){var a=t("#j-game-method"),s=a[0].offsetTop,e=t("#tipMark");t("#j-no-method").show(),e.css({display:"block",width:a.width(),height:a.height(),top:s});var o=0,i=function(){e.fadeToggle("fast",function(){}),o>5&&clearInterval(l),o++},l=setInterval(i,100)},C=function(){var t=a.uniq(s.match,"matchcode").length;return t>15?(e.showTips("您好，投注场次不得超过15场哦"),!1):s.isAgreen?2>t&&"jczq"===Config.lotyName?(e.showTips("请在左侧至少选择2场比赛"),!1):s.zhushu>1e4?(e.showTips('方案注数已超过<span class="fc-3 mlr-8">10000</span>注<br/><p class="fs-12">理性购彩,可适当减少投注</p>'),!1):s.bunch.length?!0:(q(),!1):(e.showTips("请先阅读并同意《委托投注规则》后才能继续"),!1)};t("#j-fqhmBtn").on("click",function(a){var e=s.getSubmitParams(),o=null,l="",n=e.bunch.replace(/\_/g,"串");n=n.replace("1串1","单关");var c=t("#selectGamePool tbody tr"),r="";t(".j-share-num").val(2*e.zhushu*e.beishu),c.each(function(t,a){var s=c.eq(t);r+=t%2==0?"<tr><td>"+s.find(".t1").html()+"</td><td>"+s.find(".t2").html()+"</td>":"<td>"+s.find(".betList").html()+"</td></tr>"}),Config.payMoney=1,o=C(),o&&g(function(){l='<p><b>投注金额：</b>总计<span id="j-total-money" class="fc-3 mlr-8">'+2*e.zhushu*e.beishu+'</span>元,共<span id="j-total-zhu">'+e.zhushu+'</span>注,投注<span id="j-total-bei">'+e.beishu+'</span>倍</p><p><b>过关方式：</b><span id="j-total-bunch">'+n+'</span>,理论最高奖金<span id="j-lilu-award" class="fc-3 mlr-8">'+s.maxBonus+"</span>元</p>",t("#j-tips-table").html(r),t("#j-modal-text").html(l),i.setHeMaiTotal(),t("#ballModal").modal("show")},e)}),t("#j-hemai").on("click",function(a){var e=s.getSubmitParams(),o="buy-together";e.shareNum=t("#ballModal .j-share-num").val(),e.buyNum=Number(t("#ballModal .j-rengou").val()),e.aegisNum=Number(t("#ballModal .j-baodi-text").val()),e.tichengPercent=t("#ipt_extraPercent").val(),e.shareLevel=t("#ballModal .br-set.active").attr("data-set"),e.projectTitle=t("#ballModal .j-project-title").val(),e.projectText=t("#ballModal .br-textarea").val(),Config.payMoney=2*e.zhushu*e.beishu/e.shareNum*(e.buyNum+e.aegisNum),g(function(){t("#myModal").modal("hide"),w(e,o,Config.lotyName)},e,!0)}),t("#j-ljtzBtn").on("click",function(a){var o=s.getSubmitParams(),i={},l=null,n="buy-self",c=t("#selectGamePool tbody tr"),r="",d=o.bunch.replace(/\_/g,"串");d=d.replace("1串1","单关"),c.each(function(t,a){var s=c.eq(t);r+=t%2==0?"<tr><td>"+s.find(".t1").html()+"</td><td>"+s.find(".t2").html()+"</td>":"<td>"+s.find(".betList").html()+"</td></tr>"}),Config.payMoney=2*s.zhushu*s.beishu,i.title="投注信息确认",i.confirmHtml='<div class="ljtz-box"><div class="text"><p>投注金额：总计<span class="fc-3">'+Config.payMoney+"</span>元，共"+o.zhushu+"注，投注"+o.beishu+'倍</p><div class="ljtz-main" id="j-ljtz-box"><table class="table table-bordered"><thead><tr><th>场次</th><th class="gameTeam">主队 VS 客队</th><th style="width:150px;">投注内容</th></tr></thead><tbody>'+r+"</tbody></table></div><p>过关方式："+d+', 理论最高奖金：<span class="fc-3">'+s.maxBonus+'</span>元</p><div class="btns"><button class="btn btn-danger" id="buyConfirm">确定</button><button class="btn btn-gray" data-dismiss="modal">取消</button></div></div></div>',l=C(),l&&g(function(){e.showTips({html:i.confirmHtml,title:i.title}),t("#j-ljtz-box").mCustomScrollbar({theme:"light-3",mouseWheelPixels:200}),t("#buyConfirm").one("click",function(t){w(o,n,Config.lotyName)})},o)})});