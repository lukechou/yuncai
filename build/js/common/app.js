define(["jquery","bootstrap"],function(e){"use strict";var t=function(){function t(e){return this instanceof t?void 0:new t(e)}return t.prototype={checkBuyMoney:null,lessMoneyTips:null,cb:null,userMoney:null},t.prototype.showLoginBox=function(t){var o=this,a=null,n=null,s=null;if(!e("#user-login")[0]){var l='<div id="j-login-modal" class="modal bs-example-modal-sm login-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true"><div class="modal-dialog modal-sm"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><i class="icon icon-close"></i></button>登录</div><div class="modal-body"><div class="login-form"><label for="user">用户名：</label><input type="text" id="login-username"/><a href="/account/register">注册新用户</a></div><div class="login-form"><label for="pwd">登录密码：</label><input type="password" id="login-password"/><a href="/html/user/find_psw.html">找回密码</a></div><button class="btn btn-danger" id="user-login">立即登录</button></div></div></div></div>';e("body").append(l)}a=e("#j-login-modal"),a.on("show.bs.modal",o.centerModal),a.modal("show"),e("#user-login").unbind(),e("#user-login").on("click",function(l){return n=o.filterStr(e("#login-username").val()),s=o.filterStr(e("#login-password").val()),n&&s?void e.ajax({url:"/account/userinfo/user/dologin",type:"post",dataType:"json",data:{username:n,password:s}}).done(function(e){return 1e5==e.retCode?(a.modal("hide"),o.updateHeadUserInfo(),void(o.checkBuyMoney?o.checkLogin(o.checkBuyMoney,{enoughMoney:function(){t&&t()},lessMoneyTips:o.lessMoneyTips}):t&&t())):void o.showTips(e.retMsg)}).fail(function(){o.onServiceFail()}):void o.showTips({text:"帐号密码不能为空"})})},t.prototype.handRetCode=function(e,t,o){var a=this;switch(e){case 120002:a.showLoginBox(o);break;case 120001:a.lessMoneyTips&&a.onLessMoney(a.lessMoneyTips);break;default:a.showTips({text:t})}},t.prototype.onLessMoney=function(t){var o=this,a="";a+='<div class="lessbox"><img src="'+staticHostURI+'/front_images/fail.png" alt="success" class="icon"><div class="tipbox" id="j-modal-tipbox"><div class="less-text">',a+="<h4>您的余额不足，请先充值</h4>"+t,a+='<p>账&nbsp;户&nbsp;&nbsp;余&nbsp;额：<span class="fc-3 mlr5">'+Number(o.userMoney).toFixed(2)+"</span>元</p>",a+='</div><div class="m-one-btn ml30"><a id="j-less-money" href="/account/top-up" class="btn btn-danger" target="_blank">立即充值</a></div></div></div>',o.showTips({html:a}),e("body").on("click","#j-less-money",function(t){var o='<h3>请在新打开的充值页面完成充值操作</h3><div class="m-btns"><button class="btn btn-danger" id="j-pay-success">已完成充值，继续投注</button><a href="/html/help/help.html?page=6&ps=pay" class="btn btn-gray fc-3d" target="_blank">付款遇到问题</a></div>';e("#j-modal-tipbox").html(o)}),e("body").on("click","#j-pay-success",function(t){t.preventDefault(),e.ajax({url:"/account/islogin",type:"get",dataType:"json"}).done(function(t){var a=Number(t.retData.money.replace(/,/g,""));o.userMoney=a,o.checkBuyMoney<=o.userMoney?o.cb&&o.cb():(e("#myModal").modal("hide"),o.showTips({text:"付款失败，账户余额不足，请及时充值！"}))})})},t.prototype.checkLogin=function(t,o,a){var n=this;t=Number(t),n.checkBuyMoney=t,n.lessMoneyTips=o.lessMoneyTips?o.lessMoneyTips:"",n.cb=o.enoughMoney?o.enoughMoney:null,"number"==typeof t&&e.ajax({url:"/account/islogin",type:"get",dataType:"json"}).done(function(e){if(1e5===e.retCode){var s=Number(e.retData.money.replace(/,/g,""));n.userMoney=s,0!=s&&s>=t?o.enoughMoney&&o.enoughMoney():n.lessMoneyTips&&n.onLessMoney(n.lessMoneyTips),o.always&&o.always(s)}else a?n.handRetCode(e.retCode,e.retMsg,o.always):n.handRetCode(e.retCode,e.retMsg,o.enoughMoney)})},t.prototype.createShowTipsHTML=function(t){var o="",a=Number(t.type);if(""===t.html)switch(o='<div class="tipbox"><p>'+t.text+"</p></div>",a){case 1:o+='<div class="m-onebtn"><button class="btn modal-sure-btn" id="j-modal-confirm">'+t.ensuretext+"</button></div>";break;case 2:o+='<div class="m-btns"><button class="btn btn-danger" id="j-modal-confirm">'+t.ensuretext+'</button><button class="btn btn-gray ml15" data-dismiss="modal">'+t.canceltext+"</button></div>";break;default:o+='<div class="m-one-btn"><button class="btn" data-dismiss="modal">'+t.ensuretext+"</button></div>"}else o=t.html;if(t.className||(t.className=null),e("#myModal")[0])t.className?e("#myModal").addClass(t.className):e("#myModal").removeClass().addClass("friend-modal modal"),e(".j-apptips-title").html(t.title),e("#apptips-content").html(o);else{var n='<div class="friend-modal modal '+t.className+'" id="myModal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><i class="icon icon-close"></i></button><h4 class="modal-title j-apptips-title" id="myModalLabel">'+t.title+'</h4></div><div class="modal-body text-center fc-84" id="apptips-content">'+o+"</div></div></div>";e("body").append(n)}e("#j-modal-confirm").unbind("click"),t.onConfirm&&e("#j-modal-confirm").on("click",function(e){e.preventDefault(),t.onConfirm()}),t.callback&&t.callback()},t.prototype.showTips=function(t){var o=this,a={title:"友情提示",html:"",type:0,text:"",ensuretext:"确定",canceltext:"取消",onConfirm:null,className:null,callback:null};if("object"==typeof t&&null!==t)for(var n in t)t.hasOwnProperty(n)&&""!=t[n]&&(a[n]=t[n]);else a.text=t;o.createShowTipsHTML(a),e("#myModal").on("show.bs.modal",o.centerModal),e("#myModal").modal("show")},t.prototype.checkUserLoginStatus=function(){var t=e("#myname");return t.length?!0:!1},t.prototype.centerModal=function(){e(this).css("display","block");var t=e(this).find(".modal-dialog"),o=(e(window).height()-t.height())/2,a=(e(window).width()-t.width())/2;t.css({"margin-top":o,"margin-left":a})},t.prototype.onServiceFail=function(){this.showTips({text:"服务器繁忙,请稍后再试!"})},t.prototype.bindInputPlace=function(){e(".j-input-place").on("focus",function(t){var o=e(this),a=o.attr("data-place");a==o.val()&&e(this).val("").addClass("active")}),e(".j-input-place").on("blur",function(t){var o=e(this),a=o.attr("data-place");""==o.val()&&e(this).val(a).removeClass("active")})},t.prototype.bindInputOnlyInt=function(t){return"string"!=typeof t?void console.log("error"):void e(t).on("keyup paste",function(t){t.preventDefault(),e(this).val(e(this).val().replace(/\D|^0/g,""))})},t.prototype.init=function(){var t=this;e("#j-header-login-btn").on("click",function(e){e.preventDefault();var t=location.href.replace(location.origin,"");t=t.replace(/#/,""),location.href="/account/login?ret_url="+encodeURIComponent(t)});var o={el:e("#choseCai"),init:function(e){var t=this;for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.bindEvent()},bindEvent:function(){var e=this;e.el.hover(function(){e.el.addClass("on"),e.el.find(".j-white-tri").removeClass("icon-hdown").addClass("icon-hup")},function(){e.el.removeClass("on"),e.el.find(".j-white-tri").removeClass("icon-hup").addClass("icon-hdown")})}};o.init({el:e("#choseCai")});var a={el:e("#j-hemai-nav"),bindEvent:function(){var e=this;e.el.hover(function(){e.el.addClass("on")},function(){e.el.removeClass("on")})}};a.bindEvent();var n={bindEvent:function(e){var t=e;t.el.hover(function(){t.target.addClass("behover")},function(){t.target.removeClass("behover")})}};n.bindEvent({el:e(".j-num-li"),target:e(".j-num-nav")}),n.bindEvent({el:e(".j-heighp-li"),target:e(".j-heighp-nav")}),t.initLrkf(),e(".modal").on("show.bs.modal",t.centerModal)},t.prototype.initLrkf=function(){var t=["2726429522"],o='<div id="j-side" class="side"><a class="icon-text" target="_blank" href="http://wpa.qq.com/msgrd?v=3&amp;uin='+t[0]+'&amp;site=qq&amp;menu=yes" ></a></div>',a=null;e("body").append(o),a=e("#j-side .icon-text"),e("#j-side").hover(function(){a.animate({left:"-64px",opacity:"1"},200)},function(){a.animate({left:"-70px",opacity:"0"},200)})},t.prototype.updateUserMoney=function(){e.ajax({url:"/account/islogin",type:"get",dataType:"json"}).done(function(t){1e5===t.retCode&&e("#userMoney").html(t.retData.money)})},t.prototype.updateHeadUserInfo=function(){var t="";e.ajax({url:"/account/islogin",type:"get",dataType:"json"}).done(function(o){1e5===o.retCode&&(t='<span>欢迎来到彩胜网&nbsp;!&nbsp;&nbsp;&nbsp;&nbsp;<i class="icon icon-bor"></i></span>'+o.retData.username+'       账户余额:<span id="userMoney">'+o.retData.money+'</span>元<a href="/account/top-up" class="active">充值</a><i class="icon icon-bor"></i><a href="/account/logout">退出</a><i class="icon icon-bor"></i><a href="/account/index" class="last">我的账户</a>',e("#j-hd-top").html(t))})},t.prototype.showStopSellModal=function(t){var o="";o+='<p>选择其它彩种投注 或 <a href="/">返回首页</a></p><ul>',o='<li><img class="logo" src="'+staticHostURI+'/front_images/lottery/dlt_home_logo.png" alt="大乐透"/><a href="/lottery/buy/dlt">大乐透</a></li>\r\n      <li class="text-right"><img class="logo" src="'+staticHostURI+'/front_images/lottery/qxc_home_logo.png" alt="七星彩"/><a href="/lottery/buy/qxc">七星彩</a></li>\r\n      <li><img class="logo" src="'+staticHostURI+'/front_images/lottery/pl3_home_logo.png" alt="排列3"/><a href="/lottery/buy/pl3">排列3</a></li>\r\n      <li class="text-right"><img class="logo" src="'+staticHostURI+'/front_images/lottery/pl5_home_logo.png" alt="排列5"/><a href="/lottery/buy/pl5">排列5</a></li>',o+="</ul></div>",o="";var a='<img src="'+staticHostURI+'/front_images/stopsell.png" class="stopsell-img" alt="mask-main" alt="暂停销售"/><div class="stopsell-box"><h4>'+t+" 暂停销售</h4>"+o,n='<div class="m-mask m-stopsell-mask" id="j-stopsell-mask"><div class="m-mask-bg"></div><div class="m-mask-main"><div class="modal-header"><button type="button" class="close" id="j-stopsellmask-close"><i class="icon icon-close"></i></button><h4 class="modal-title">暂停销售</h4></div><div class="stopsell-body">'+a+"</div></div></div>";e("body").append(n),e("#j-stopsell-mask").show(),e("#j-stopsellmask-close").on("click",function(t){e("#j-stopsell-mask").remove()})},t.prototype.isDecimal=function(e){return parseInt(e)==e?!1:!0},t.prototype.parseQueryString=function(e){var t=/[\?&]([^\?&=]+)=([^&]+)/g,o=null,a={};for(e=e||window.location.search;null!=(o=t.exec(e));)a[o[1]]=decodeURIComponent(o[2]);return a},t.prototype.filterStr=function(e){return e=e||"",e=decodeURIComponent(e),e=e.replace(/<.*>/g,""),e=e.replace(/(java|vb|action)script/gi,""),e=e.replace(/[\"\'][\s ]*([^=\"\'\s ]+[\s ]*=[\s ]*[\"\']?[^\"\']+[\"\']?)+/gi,""),e=e.replace(/[\s ]/g,"&nbsp;")},t.prototype.dateFormat=function(e,t,o){var a=e.getFullYear(),n=e.getMonth()+1,s=e.getDate(),l=e.getHours(),i=e.getMinutes(),r=e.getSeconds(),c=e.getDay(),d=["日","一","二","三","四","五","六"];return c=d[c],o&&(n=10>n?"0"+n:n,s=10>s?"0"+s:s,l=10>l?"0"+l:l,i=10>i?"0"+i:i,r=10>r?"0"+r:r,c=c),t=t||"%Y-%M-%d %h:%m:%s",t=t.replace("%Y",a),t=t.replace("%M",n),t=t.replace("%d",s),t=t.replace("%h",l),t=t.replace("%m",i),t=t.replace("%s",r),t=t.replace("%w",c)},t}(),o=new t;return o.init(),o});