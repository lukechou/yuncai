require.config({paths:{jquery:"../lib/jquery",lodash:"../lib/lodash.compat.min",store:"../lib/store.min",bootstrap:"../lib/bootstrap.min",tipsy:"../lib/jquery.tipsy",app:"../common/app",model:"model",chart:"chart",highcharts:"highcharts"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"},tipsy:{deps:["jquery"],exports:"jquery"}}}),require(["jquery","lodash","store","chart","app","model","bootstrap","tipsy"],function(a,t,e,s,r,i){"use strict";function l(){var e,s="";for(e in v)e=t.escape(a.trim(e)),v[e]&&(s+='<li><a href="javascrip:;" class="j-save-name save-name show" data-name="'+e+'" title="'+e+'">'+e+'</a> <a href="javascript:;" class="j-save-del i-close-gray" data-id="'+v[e].search_id+'"></a></li>');a("#j-save-wrap").html(s),a("#j-load-tips").remove()}function o(){var e={};e.search_name=t.escape(a.trim(a(".j-save-input").val())),e.sort_type=t.escape(a.trim(a(".j-pxfs").val())),e.special=t.escape(a.trim(a(".j-tssx").val())),e.HI1=t.escape(a.trim(a(".j-mzzs-1").val())),e.HI2=t.escape(a.trim(a(".j-mzzs-2").val())),e.GI1=t.escape(a.trim(a(".j-cszs-1").val())),e.GI2=t.escape(a.trim(a(".j-cszs-2").val())),e.TI1=t.escape(a.trim(a(".j-qszs-1").val())),e.TI2=t.escape(a.trim(a(".j-qszs-2").val())),e.AR1=t.escape(a.trim(a(".j-pjhb-1").val())),e.AR2=t.escape(a.trim(a(".j-pjhb-2").val())),e.lastOD1=t.escape(a.trim(a(".j-slyl-1").val())),e.lastOD2=t.escape(a.trim(a(".j-slyl-2").val())),e.thisOD1=t.escape(a.trim(a(".j-dqyl-1").val())),e.thisOD2=t.escape(a.trim(a(".j-dqyl-2").val()));var s=t.keys(v);return t.indexOf(s,e.search_name)>=0&&v[e.search_name]?void r.showTips("您已经保存过条件为备注名："+e.search_name):void(""==e.search_name?r.showTips({text:"请输入长度为1~15个字符的备注名"}):n(e))}function n(t){t.t=a.now(),a.ajax({url:"/lottery/model/add-search",type:"post",dataType:"json",data:t}).done(function(e){1e5===e.retCode?(v[t.search_name]={qszs:[t.TI1,t.TI2],cszs:[t.GI1,t.GI2],mzzs:[t.HI1,t.HI2],pjhb:[t.AR1,t.AR2],slyl:[t.lastOD1,t.lastOD2],dqyl:[t.thisOD1,t.thisOD2],pxfs:t.sort_type,tssx:t.special,search_id:e.retData.search_id},r.showTips({text:e.retMsg}),a("#j-save-wrap").prepend('<li class="clearfix"><a href="javascrip:;" class="j-save-name save-name show" data-name="'+t.search_name+'" title="'+t.search_name+'">'+t.search_name+'</a> <a href="javascrip:;" class="j-save-del i-close-gray" data-id="'+e.retData.search_id+'"></a></li>')):r.handRetCode(e.retCode,e.retMsg)}).fail(function(){r.onServiceFail()})}function c(){var t=r.parseQueryString(),e=a(".result-table thead th .icon"),s=1,i=t.order||!1,l=t.type||"",o="",n=null;i&&a(".result-table thead th a").each(function(t,e){var r=a(this).attr("href");r.indexOf(i)>=0&&(o=l&&"desc"===l?"asc":"desc",n=r.replace(l,o),s=t,a(this).attr("href",n))}),e.eq(s).removeClass("icon-m4"),e.eq(s).addClass("desc"===l?"icon-m5":"icon-m6")}function d(){r.bindInputPlace(),i.init({modal:a("#collect"),starList:a(".td-star-level a"),starLevel:null,modelId:null,starComment:"",modelComment:""}),i.bindCollectEvent(),a(".data-tip").tipsy({fade:!0,gravity:"s",html:!0,opacity:1})}function h(){var t=a("#j-load-page").val(),e=a("#j-load-tip").val(),s=a("#j-load-issue").val();1==t&&1==e&&r.showTips({title:"温馨提示",text:"预计今天10：30左右公布"+s+"期的彩票模型数据。"})}function p(){d(),c(),h()}var v={},m=!1;a(".j-less").on("keyup paste",function(t){t.preventDefault(),a(this).val(a(this).val().replace(/[^0-9.]/g,""))}),a(".j-bao").on("keyup paste",function(t){t.preventDefault();var e=a(this);e.val(e.val().replace(/[^0-9.]/g,""));var s=e.val();2>s&&""!=s&&e.val(2),s>5&&""!=s&&e.val(5)}),a("#detail-form").submit(function(){var t=a("#j-input-id"),e=t.val(),s=t.attr("data-place");return""==e||s==e?(r.showTips("请输入模型编号再查询"),!1):void 0}),a("#j-loginbox-show").on("click",function(a){r.showLoginBox()}),a(".j-save-btn").on("click",function(a){r.checkUserLoginStatus()?o():r.showLoginBox()}),a("body").on("click",function(t){a(".j-sort-btn").hasClass("on")&&(a(".j-sort-btn").removeClass("on"),a(".j-sort-box").addClass("hide"))}),a("#j-save-wrap").on("click",".j-save-name",function(t){var e=a(this);a("#j-save-wrap li").removeClass("cur"),e.parents("li").addClass("cur");var s=a.trim(a(this).attr("data-name")),i=v[s];a(".j-qszs-1").val(i.qszs[0]),a(".j-qszs-2").val(i.qszs[1]),a(".j-cszs-1").val(i.cszs[0]),a(".j-cszs-2").val(i.cszs[1]),a(".j-mzzs-1").val(i.mzzs[0]),a(".j-mzzs-2").val(i.mzzs[1]),a(".j-pjhb-1").val(i.pjhb[0]),a(".j-pjhb-2").val(i.pjhb[1]),a(".j-slyl-1").val(i.slyl[0]),a(".j-slyl-2").val(i.slyl[1]),a(".j-dqyl-1").val(i.dqyl[0]),a(".j-dqyl-2").val(i.dqyl[1]),a(".j-save-input").val(s);for(var l=a(".j-tssx"),o=l.find("option"),n=0;n<o.length;n++)o.eq(n).attr(i.tssx==o.eq(n).val()?{selected:!0}:{selected:!1});for(var c=a(".j-pxfs"),d=c.find("option"),n=0;n<d.length;n++)d.eq(n).attr(i.pxfs==d.eq(n).val()?{selected:!0}:{selected:!1});r.showTips({text:"【"+s+"】筛选条件已成功载入<br />您可以单击“按参数筛选”按钮查看筛选结果"})}),a("#j-save-wrap").on("click",".j-save-del",function(t){var e=a(this),s=a(this).attr("data-id"),i="确定删除此筛选条件？";r.showTips({title:"删除确认",text:i,type:2,onConfirm:function(){a.ajax({url:"/lottery/model/cancel-search",type:"post",dataType:"json",data:{search_id:s}}).done(function(a){if(1e5===a.retCode){e.parents("li").remove();for(var t in v)v.hasOwnProperty(t)&&v[t]&&v[t].search_id==s&&(v[t]=null);r.showTips({text:"恭喜你成功删除该筛选条件"})}else r.handRetCode(a.retCode,a.retMsg)}).fail(function(){r.onServiceFail()})}})}),a(".j-sort-box").on("click",function(a){a.stopPropagation()}),a(".j-sort-btn").on("click",function(t){t.stopPropagation(),a(".j-sort-box").toggleClass("hide"),a(this).toggleClass("on"),!m&&r.checkUserLoginStatus()?a.ajax({url:"/lottery/model/get-my-search",type:"get",dataType:"json",data:{t:a.now()}}).done(function(a){1e5===a.retCode?(m=!0,a.retData[0]&&(v=a.retData[0]),l()):r.handRetCode(a.retCode,a.retMsg)}).fail(function(){r.onServiceFail()}):l()}),a("#track_detail_list").on("click",".j-show-chart",function(t){if("A"!==t.target.tagName){var e="active",r=a(this).attr("data-modelId"),i=a(this).find("td").length,l='<div class="chart-box"><a href="/lottery/model/history-data?day=30&type=0&model_id='+r+'" class="his-link" title="查看历史数据">查看历史数据</a><div class="chart-loading" id="j-chart-loder"><img src="'+Config.staticHostURI+'/front_images/loader.gif" alt="Logding.."/></div><div class="chart" id="chart"></div></div>',o='<tr id="chart-tr"><td colspan="'+i+'" style="padding:0;">'+l+"</td></tr>";if(!r)return;a(this).hasClass(e)?(a(this).removeClass("active"),a("#chart-tr").remove()):(a(".j-show-chart").removeClass(e),a(this).addClass(e),a("#chart-tr").remove(),a(this).after(o),s.init({chartEl:a("#chart")}),s.getChartData(r))}}),p()});