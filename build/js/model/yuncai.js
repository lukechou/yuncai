define(["jquery"],function($){"use strict";var Yuncai={},Do=null;return Do="undefined"==typeof Do?function(a){setTimeout(a,0)}:Do,Yuncai.chart=function(option){$.get(option.url,function(data){var WIDTH=option.width||980,data=eval("("+data+")"),arr=[],hiArr=[],wrtrendObj=data.wrtrend,trendObj=data.trend,hiObj=data.hi,hitObj=data.hit,min=data.mintrend,max=data.maxtrend,minHi=data.minHI,avg=data.avg,maxh=data.maxh,minh=data.minh,maxw=data.maxw,minw=data.minw,mintrend=data.min,maxtrend=data.max,yMin=data.miny,yMax=data.maxy,nameRange={"趋势指数":"(历史范围："+minw+" - "+maxw+")","命中指数":"(历史范围："+Number(100*minh).toFixed(2)+" - "+Number(100*maxh).toFixed(2)+")"},betResult={0:'<span style="color:#cccccc">未中</span>',1:'<span style="color:yellow">命中</span>',2:'<span style="color:#ff0033">取消</span>'},markerColor={0:"#000000",1:"#0066cc",2:"#ff0033"},markerColor1={0:"#000000",1:"yellow",2:"#ff0033"},markerRadius={0:"0",1:"3",2:"3"},markerSymbol={0:null,1:"circle",2:"circle"},markerSymbol1={0:null,1:"diamond",2:"diamond"},xLine=[],cateArr=[],second=12911616e5,labelObj={},resultObj={},qszsObj={},mzzsObj={},yLabel=maxw-minw>maxh-minh?maxw-minw:maxh-minh;for(var k in trendObj){var _obj={},_hiObj={},kVal=hitObj[k];_obj.x=second+=1e3,_obj.y=Number(trendObj[k]),0==kVal?_obj.marker=null:(_obj.marker={},_obj.marker.enabled=!0,_obj.marker.fillColor=markerColor[kVal],_obj.marker.radius=markerRadius[kVal],_obj.marker.symbol=markerSymbol[kVal],_obj.marker.states={},_obj.marker.states.hover={},_obj.marker.states.hover.fillColor=markerColor[kVal]),arr.push(_obj),_hiObj.x=second,_hiObj.y=Number(hiObj[k]),0==kVal?_hiObj.marker=null:(_hiObj.marker={},_hiObj.marker.enabled=!0,_hiObj.marker.fillColor=markerColor1[kVal],_hiObj.marker.radius=markerRadius[kVal],_hiObj.marker.symbol=markerSymbol[kVal],_hiObj.marker.states={},_hiObj.marker.states.hover={},_hiObj.marker.states.hover.fillColor=markerColor1[kVal]),hiArr.push(_hiObj);var _xObj={};_xObj.value=_obj.x,_xObj.width=.7,_xObj.color=markerColor[kVal],_xObj.dashStyle="solid",_xObj.zIndex=1,xLine.push(_xObj),labelObj[second+""]=k.replace(/\-/g,"").substring(2),resultObj[second+""]=betResult[kVal],qszsObj[second+""]=wrtrendObj[k],mzzsObj[second+""]=100*hiObj[k]}$(".j-avg").html(parseFloat(avg).toFixed(2)),window.chart=new Highcharts.StockChart({chart:{renderTo:option.id,width:WIDTH,zoomType:"x"},colors:["#ff0033","yellow"],credits:{enabled:!1},rangeSelector:{selected:3,inputEnabled:!1,labelStyle:{visibility:"hidden",fontSize:0},buttons:[{type:"second",count:90,text:"90"},{type:"second",count:180,text:"180"},{type:"second",count:360,text:"360"},{type:"all",text:"All"}]},title:{align:"right",margin:-28,text:"平均值博（"+parseFloat(avg).toFixed(2)+"）",style:{fontSize:"12px",color:"yellow"}},navigator:{enabled:!1,height:16,xAxis:{labels:{formatter:function(){return labelObj[this.value]}}}},plotOptions:{line:{lineWidth:1},series:{states:{hover:{enabled:!0,lineWidth:1}},turboThreshold:2e3},zIndex:1},tooltip:{crosshairs:[!0,!0],formatter:function(){var a="<b>期　　号：</b>"+labelObj[this.x]+" ["+resultObj[this.x]+"]";return a+='<br/><b>趋势指数：</b><span style="color:#ff0033;">'+Number(qszsObj[this.x]).toFixed(2)+"</span> "+nameRange["趋势指数"],a+='<br/><b>命中指数：</b><span style="color:yellow;">'+Number(mzzsObj[this.x]).toFixed(2)+"</span> "+nameRange["命中指数"]}},xAxis:{tickmarkPlacement:"on",dateTimeLabelFormats:{second:"%Y-%m-%d<br/>%H:%M:%S",minute:"%Y-%m-%d<br/>%H:%M",hour:"%Y-%m-%d<br/>%H:%M",day:"%Y<br/>%m-%d",week:"%Y<br/>%m-%d",month:"%Y-%m",year:"%Y"},labels:{formatter:function(){return labelObj[this.value]}},plotLines:xLine},yAxis:{plotLines:[{value:avg,width:.7,color:"yellow",dashStyle:"solid",zIndex:2,label:{}}],labels:{align:"right",y:5,x:-5},showLastLabel:!0,tickPositions:[(Number(yMin)-.05).toFixed(2),(Number(yMin)+(yMax-yMin)/3).toFixed(2),(Number(yMin)+(yMax-yMin)/3*2).toFixed(2),(Number(yMax)+.05).toFixed(2)]},series:[{name:"趋势指数",data:arr,shadow:!1,tooltip:{valueDecimals:2}},{name:"命中指数",data:hiArr,shadow:!1,tooltip:{valueDecimals:2}}]})})},Yuncai.historyChart=function(option,data){var data=eval("("+data+")");if(data){var followtrend=data[0],followbounty=data[0],followinfo=data[0],second=12911616e5,labelObj={},followtrendT={},followtrendJ={},resultObj=[],data1=[],yMin=parseFloat(data[2]),yMax=parseFloat(data[1]),chartTable=$(".chart-table"),tds1=chartTable.find(".first td"),tds2=chartTable.find(".last td");tds1.eq(1).text(followinfo.day_top),tds1.eq(2).text(followinfo.all),tds1.eq(3).text(followinfo.real_all);for(var name in followtrend){var item1={};second+=1e3,item1.x=second,item1.y=parseFloat(followtrend[name]),data1.push(item1),labelObj[second+""]=name,followtrendT[second+""]=followtrend[name],followtrendJ[second+""]=followbounty[name],resultObj[second+""]=followtrend[name]}var chart=new Highcharts.StockChart({chart:{renderTo:"chart_box",plotBackgroundColor:"#fff",backgroundColor:"#feeecc",borderRadius:0,spacingLeft:0,spacingRight:6,spacingBottom:10,spacingTop:6,plotBackgroundImage:"http://static.360mao.com/website/images/client/trade/bg_chart_history.png"},scrollbar:{enabled:!1},rangeSelector:{enabled:!1},navigator:{enabled:!1},colors:["#0158a7","#ffa200"],title:{align:"right",margin:5,text:"历史最高盈利额："+fmoney(yMax,2)+"元，  历史最低盈利额："+fmoney(yMin,2)+"元（负数表示亏损）",style:{fontSize:"12px",color:"#ff0000"}},xAxis:{tickmarkPlacement:"on",dateTimeLabelFormats:{second:"%Y-%m-%d<br/>%H:%M:%S",minute:"%Y-%m-%d<br/>%H:%M",hour:"%Y-%m-%d<br/>%H:%M",day:"%Y<br/>%m-%d",week:"%Y<br/>%m-%d",month:"%Y-%m",year:"%Y"},lineWidth:1,lineColor:"#afafaf",labels:{formatter:function(){return labelObj[this.value+""]?labelObj[this.value]:""}}},tooltip:{borderColor:"#BCBCBC",borderWidth:1,shadow:!1,crosshairs:[!0,!0],formatter:function(){if(labelObj[this.x]){var a="<b>期　　号：</b>"+labelObj[this.x]+" <br/><b>盈亏额：</b>"+fmoney(resultObj[this.x],2)+"元";return a}return!1}},yAxis:{gridLineWidth:0,minPadding:0,maxPadding:0,labels:{align:"right",y:6,x:-9,formatter:function(){return-1e3>yMin&&yMin>=-1e4||yMax>1e3&&1e4>=yMax?this.value/1e3+"k":-1e4>yMin||yMax>1e4?this.value/1e4+"w":this.value}},lineColor:"#afafaf",lineWidth:1,showLastLabel:!0,showFirstLabel:!0,min:yMin,max:yMax},credits:{enabled:!1},series:[{data:data1,lineWidth:1,shadow:!1,states:{hover:{enabled:!0,lineWidth:1}}}]});$(".chart-top h3").css("margin-left",624-chart.plotWidth+6+"px").css("visibility","visible")}},Yuncai.historyChartbf=function(option,data){var WIDTH=option.width||980,data=eval("("+data+")"),arr=[],hiArr=[],wrtrendObj=data[0],trendObj=data[0],min=parseFloat(data[2]),max=parseFloat(data[1]),avg=Number((parseFloat(data[1])+parseFloat(data[2]))/2).toFixed(2),mintrend=parseFloat(data[2]),maxtrend=parseFloat(data[1]),yMin=parseFloat(data[2]),yMax=parseFloat(data[1]),nameRange={"余额":"(历史范围："+min+" - "+max+")"},betResult={0:'<span style="color:#cccccc">未中</span>',1:'<span style="color:yellow">命中</span>',2:'<span style="color:#ff0033">取消</span>'},markerColor={0:"#000000",1:"#0066cc",2:"#ff0033"},markerColor1={0:"#000000",1:"yellow",2:"#ff0033"},markerRadius={0:"0",1:"3",2:"3"},markerSymbol={0:null,1:"circle",2:"circle"},markerSymbol1={0:null,1:"diamond",2:"diamond"},xLine=[],cateArr=[],second=12911616e5,labelObj={},resultObj={},qszsObj={},yLabel=max-min;for(var k in trendObj){var _obj={},_hiObj={},kVal=k;_obj.x=second+=1e3,_obj.y=Number(trendObj[k]),_obj.marker=null,arr.push(_obj);var _xObj={};_xObj.value=_obj.x,_xObj.width=.7,_xObj.color=markerColor[kVal],_xObj.dashStyle="solid",_xObj.zIndex=1,xLine.push(_xObj),labelObj[second+""]=k,resultObj[second+""]=trendObj[k],qszsObj[second+""]=wrtrendObj[k]}$(".j-avg").html(parseFloat(avg).toFixed(2)),window.chart=new Highcharts.StockChart({chart:{renderTo:option.id,width:WIDTH,zoomType:"x"},colors:["#ff0033","yellow"],credits:{enabled:!1},rangeSelector:{selected:3,inputEnabled:!1,labelStyle:{visibility:"hidden",fontSize:0},buttons:[]},title:{align:"right",margin:-28,text:"历史最大余额："+max+"  历史最小余额："+min,style:{fontSize:"12px",color:"yellow"}},navigator:{enabled:!1,height:10,xAxis:{labels:{formatter:function(){return labelObj[this.value]}}}},plotOptions:{line:{lineWidth:1},series:{states:{hover:{enabled:!0,lineWidth:1}}},zIndex:1},tooltip:{crosshairs:[!0,!0],formatter:function(){var a="<b>期号：</b>"+labelObj[this.x]+" <br/>余额："+fmoney(resultObj[this.x],3);return a}},xAxis:{tickmarkPlacement:"on",dateTimeLabelFormats:{second:"%Y-%m-%d<br/>%H:%M:%S",minute:"%Y-%m-%d<br/>%H:%M",hour:"%Y-%m-%d<br/>%H:%M",day:"%Y<br/>%m-%d",week:"%Y<br/>%m-%d",month:"%Y-%m",year:"%Y"},labels:{formatter:function(){return labelObj[this.value]}},plotLines:xLine},yAxis:{labels:{align:"right",y:5,x:-5},minTickInterval:1,showLastLabel:!0,max:max,min:min},series:[{name:"趋势指数",data:arr,shadow:!1,tooltip:{valueDecimals:2}}]})},Yuncai.followChart=function(a){$.get(a.url,function(a){if(a.error)return void Yuncai.showTip(a.error);var e=a.followtrend,t=a.followbounty,r=a.followinfo,o=a.myinfo,l=a.mytrend,i=a.mybounty,n=12911616e5,s={},d={},b={},m={},c={},h=[],f=[],x=parseFloat(a.min),u=parseFloat(a.max),p=$(".chart-table"),y=p.find(".first td"),j=p.find(".last td");y.eq(1).text(r.day_top),y.eq(2).text(r.all),y.eq(3).text(r.real_all),y.eq(4).html(-1!==r.profit.indexOf("-")?'<span class="green">'+r.profit+"</span>":'<span class="red">'+r.profit+"</span>"),y.eq(5).html(-1!==r.real_profit.indexOf("-")?'<span class="green">'+r.real_profit+"</span>":'<span class="red">'+r.real_profit+"</span>"),j.eq(1).text(o.day_top),j.eq(2).text(o.all),j.eq(3).text(o.real_all),j.eq(4).html(-1!==o.profit.indexOf("-")?'<span class="green">'+o.profit+"</span>":'<span class="red">'+o.profit+"</span>"),j.eq(5).html(-1!==o.real_profit.indexOf("-")?'<span class="green">'+o.real_profit+"</span>":'<span class="red">'+o.real_profit+"</span>");for(var k in e){var g={},w={};n+=1e3,g.x=n,g.y=parseFloat(e[k]),w.x=n,w.y=parseFloat(l[k]),h.push(g),f.push(w),s[n+""]=k.replace(/\-/g,"").substring(2),d[n+""]=l[k],b[n+""]=i[k],m[n+""]=e[k],c[n+""]=t[k]}var O=new Highcharts.StockChart({chart:{renderTo:"chart_box",plotBackgroundColor:"#fff",backgroundColor:"#feeecc",borderRadius:0,spacingLeft:0,spacingRight:6,spacingBottom:0,spacingTop:6,plotBackgroundImage:"http://static.360mao.com/website/images/client/trade/bg_chart.png"},scrollbar:{enabled:!1},rangeSelector:{enabled:!1},navigator:{enabled:!1},colors:["#0158a7","#ffa200"],xAxis:{tickmarkPlacement:"on",dateTimeLabelFormats:{second:"%Y-%m-%d<br/>%H:%M:%S",minute:"%Y-%m-%d<br/>%H:%M",hour:"%Y-%m-%d<br/>%H:%M",day:"%Y<br/>%m-%d",week:"%Y<br/>%m-%d",month:"%Y-%m",year:"%Y"},lineWidth:2,lineColor:"#afafaf",labels:{formatter:function(){return s[this.value+""]?s[this.value]:""}}},tooltip:{borderColor:"#BCBCBC",borderWidth:1,shadow:!1,crosshairs:[!0,!0],formatter:function(){if(s[this.x]){var a="<b>期号：</b>"+s[this.x];return a+='<br/><strong style="font-weight:bold;color:#0158a7;">被跟买人实盘：</strong><span style="color:#0158a7;">投注 '+m[this.x]+' 元</span>（奖金 <span style="color:red;">'+c[this.x]+"</span> 元）",a+='<br/><strong style="font-weight:bold;color:#ffa200;">假如我跟买：</strong><span style="color:#ffa200;">投注 '+d[this.x]+' 元</span>（奖金 <span style="color:red;">'+b[this.x]+"</span> 元）"}return!1}},yAxis:{gridLineWidth:0,minPadding:0,maxPadding:0,labels:{align:"right",y:6,x:-9,formatter:function(){return this.value}},lineColor:"#afafaf",lineWidth:1,showLastLabel:!0,showFirstLabel:!1,tickPositions:[0,x,Math.ceil((u-x)/3)+x,Math.ceil((u-x)/3*2)+x,u]},credits:{enabled:!1},series:[{data:h,lineWidth:1,shadow:!1,states:{hover:{enabled:!0,lineWidth:1}}},{data:f,lineWidth:2,shadow:!1,states:{hover:{enabled:!0,lineWidth:2}}}]});$(".chart-top h3").css("margin-left",624-O.plotWidth+6+"px").css("visibility","visible")},"json")},Yuncai});