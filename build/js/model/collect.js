require.config({paths:{jquery:"../lib/jquery",lodash:"../lib/lodash.compat.min",store:"../lib/store.min",bootstrap:"../lib/bootstrap.min",app:"../common/app",model:"model",chart:"chart",highcharts:"highcharts"},shim:{bootstrap:{deps:["jquery"],exports:"jquery"}}}),require(["jquery","lodash","store","chart","app","model","bootstrap"],function(t,e,a,l,o,i){"use strict";function s(){i.init({modal:t("#collect"),starList:t(".td-star-level a"),starLevel:null,modelId:null,starComment:"",modelComment:"",isCollectPage:!0}),i.bindCollectEvent(),t("#j-star-select, #j-time-select").on("change",function(e){e.preventDefault();var a=Number(t("#j-star-select").val()),l=t("#j-time-select").val(),o=1;t("#track_detail_list tr").each(function(e,i){var s=1*t(this).attr("data-star"),c=1e3*t(this).attr("data-time"),r=t.now(),n=25*l*60*60*1e3,d="",h=a==s?!0:!1,m=new Date(c).getDate(),u=(new Date).getDate();return d=n>=r-c?1==l?m===u?!0:!1:!0:!1,0==a&&(h=!0),0==l&&(d=!0),d&&h?(t(this).show(),t(this).find(".index").html(o),void o++):void t(this).hide()})})}function c(){var e=[];return t("#j-collect-table tbody ."+d).each(function(a,l){e.push(t(this).attr("data-modelId"))}),e}function r(e){e.length?t("#j-del-manycollect").show(300):t("#j-del-manycollect").hide()}function n(){t("#j-collect-table tbody .index").each(function(e,a){t(this).html(e+1)})}var d="icon-y2",h="icon-y";s(),t("#j-collect-table").on("click","thead .icon",function(e){var a,l=t(this);t(this).toggleClass(h+" "+d),l.hasClass(d)?t("#j-collect-table .icon").removeClass(h).addClass(d):t("#j-collect-table .icon").removeClass(d).addClass(h),a=c(),r(a)}),t("#j-collect-table").on("click","tbody .icon",function(e){var a=(t(this),"");t(this).toggleClass(h+" "+d),a=c(),r(a),0==a&&t("#j-collect-table thead ."+d).removeClass(d).addClass(h)}),t("#j-del-manycollect").on("click",".btn-del-collect",function(e){e.preventDefault(),o.showTips({text:"是否删除该收藏？",type:2,onConfirm:function(){var e=c(),a={model_id:e.join(","),rnd:t.now()};t.ajax({url:"/lottery/trade/model-batch-cancel-collect",type:"get",dataType:"json",data:a}).done(function(a){if(1e5===a.retCode){for(var l=e.length-1;l>=0;l--)t("#track_detail_list tr[data-modelid="+e[l]+"]").remove(),t("#j-del-manycollect").slideDown();n(),o.showTips({text:"恭喜您，批量取消收藏成功！",type:1,onConfirm:function(){window.location.reload()}})}else o.handRetCode(a.retCode,a.retMsg)}).fail(function(){o.onServiceFail()})}})}),t("#track_detail_list").on("click",".j-show-chart",function(e){if("TD"===e.target.tagName){var a="active",o=t(this).attr("data-modelId"),i=t(this).find("td").length,s='<div class="chart-box"><a href="/lottery/model/history-data" class="his-link" title="查看历史数据">查看历史数据</a><div class="chart-loading" id="j-chart-loder"><img src="'+Config.staticHostURI+'/front_images/loader.gif" alt="Logding.."/></div><div class="chart" id="chart"></div></div>',c='<tr id="chart-tr"><td colspan="'+i+'" style="padding:0;">'+s+"</td></tr>";if(!o)return;t(this).hasClass(a)?(t(this).removeClass("active"),t("#chart-tr").remove()):(t(".j-show-chart").removeClass(a),t(this).addClass(a),t("#chart-tr").remove(),t(this).after(c),l.init({chartEl:t("#chart")}),l.getChartData(o))}})});